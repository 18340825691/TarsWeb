webpackJsonp([1],{"/4MF":function(e,t){},"/w7L":function(e,t,a){"use strict";var r=a("S1cf");e.exports=r.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),a=document.createElement("a");function o(e){var r=e;return t&&(a.setAttribute("href",r),r=a.href),a.setAttribute("href",r),{href:a.href,protocol:a.protocol?a.protocol.replace(/:$/,""):"",host:a.host,search:a.search?a.search.replace(/^\?/,""):"",hash:a.hash?a.hash.replace(/^#/,""):"",hostname:a.hostname,port:a.port,pathname:"/"===a.pathname.charAt(0)?a.pathname:"/"+a.pathname}}return e=o(window.location.href),function(t){var a=r.isString(t)?o(t):t;return a.protocol===e.protocol&&a.host===e.host}}():function(){return!0}},"0ri5":function(e,t){},"1Ggf":function(e,t){},"21mA":function(e,t){},"3NoR":function(e,t,a){"use strict";var r=a("Dd8w"),o=a.n(r),s=a("pFYg"),l=a.n(s),i=a("7+uW"),n=a("QpGM"),c=a.n(n),d=(a("XSxf"),a("K/Lq")),u=a.n(d),m=(a("s2Rr"),{name:"Icon",props:{name:{type:String,required:!0}}}),p={render:function(){var e=this.$createElement,t=this._self._c||e;return t("svg",{staticClass:"icon"},[t("use",{attrs:{"xlink:href":"#"+this.name}})])},staticRenderFns:[]};var f=a("VU/8")(m,p,!1,function(e){a("JIJe")},null,null).exports,h={name:"TarsFormItem",props:{label:String}},v={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("let-form-item",{staticClass:"tars-form-item"},[a("label",{staticClass:"let-form-item__label let-label__position_top clickable",on:{click:function(t){return e.$emit("onLabelClick")}}},[e._v(e._s(e.label))]),e._v(" "),e._t("default")],2)},staticRenderFns:[]};var g=a("VU/8")(h,v,!1,function(e){a("O444")},null,null).exports,_=a("Z/F5"),b=a.n(_),$=a("aqzs"),M=a.n($);i.default.use(c.a,{locale:{en:M.a,cn:b.a}[u.a.get("locale")||"cn"]||b.a}),i.default.component(f.name,f),i.default.component(g.name,g);var y=i.default.prototype.$Loading;function w(e){this.el=e,this.loading=null}w.prototype.show=function(e,t){"object"===(void 0===e?"undefined":l()(e))&&(t=e,e=null),this.loading&&this.hide();var a=this.el,r=y(o()({fullScreen:!a,target:a&&e?a.querySelector(e):a,boxClass:"loading-inner",background:"rgba(0,0,0,0)",color:"#fff",size:24},t));return r.show(),this.loading=r,this},w.prototype.hide=function(){return this.loading&&(this.loading.hide(),this.loading=null),this},w.show=function(){var e;return w._loading||(w._loading=new w),(e=w._loading).show.apply(e,arguments)},w.hide=function(){return w._loading||(w._loading=new w),w._loading.hide()},y.show=w.show,y.hide=w.hide,Object.defineProperty(i.default.prototype,"$loading",{get:function(){return this._loading||(this._loading=new w(this.$el)),this._loading}}),Object.defineProperty(i.default.prototype,"$tip",{get:function(){return this.$Notice}})},"3T6I":function(e,t){},"3bIi":function(e,t,a){"use strict";var r=a("YdsM");e.exports=function(e,t,a,o,s){var l=new Error(e);return r(l,t,a,o,s)}},"4TWv":function(e,t){},"52cW":function(e,t){},"6uR2":function(e,t){},"7/2Y":function(e,t,a){"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},"7x6k":function(e,t,a){"use strict";var r=a("mvHQ"),o=a.n(r),s=a("pFYg"),l=a.n(s),i={name:"InterfaceDebuger",components:{wrapper:a("mxK3").a},data:function(){return{serverData:{level:5,application:"",server_name:"",set_name:"",set_area:"",set_group:""},tarsFileList:[],uploadModal:{show:!1,model:{}},showDebug:!1,contextData:[],debuger_panel:!1,inParam:"",outParam:"",selectedFileName:"",selectedMethods:[],objName:"",objList:[],selectedId:""}},methods:{getFileList:function(){var e=this,t=this.$Loading.show();this.$ajax.getJSON("/server/api/get_file_list",{application:this.serverData.application,server_name:this.serverData.server_name}).then(function(a){t.hide(),e.tarsFileList=a}).catch(function(a){t.hide(),e.$tip.error(e.$t("common.error")+": "+(a.message||a.err_msg))})},openTarsUploadFileModal:function(){this.uploadModal.show=!0,this.uploadModal.model={application:this.serverData.application,server_name:this.serverData.server_name,set_name:this.serverData.set_name,file:null}},uploadFile:function(e){this.uploadModal.model.file=e},uploadTarsFile:function(){var e=this;if(this.$refs.uploadForm.validate()){var t=this.$Loading.show(),a=new FormData;a.append("application",this.uploadModal.model.application),a.append("server_name",this.uploadModal.model.server_name),a.append("set_name",this.uploadModal.model.set_name),a.append("suse",this.uploadModal.model.file),this.$ajax.postForm("/server/api/upload_tars_file",a).then(function(){t.hide(),e.getFileList(),e.uploadModal.show=!1,e.uploadModal.model=null}).catch(function(a){t.hide(),e.$tip.error(e.$t("common.error")+": "+(a.message||a.err_msg))})}},closeUploadModal:function(){this.uploadModal.show=!1},showDebuger:function(e){this.showDebug=!0,this.selectedFileName=e.file_name,this.inParam=null,this.outParam=null,this.selectedId=e.f_id,this.objName=null,this.getContextData(e.f_id),this.getObjList()},deleteTarsFile:function(e){var t=this;this.$confirm(this.$t("inf.dlg.deleteMsg"),this.$t("common.alert")).then(function(){var a=t.$Loading.show();t.$ajax.getJSON("/server/api/delete_tars_file",{id:e}).then(function(e){a.hide(),t.getFileList()}).catch(function(e){a.hide(),t.$tip.error(t.$t("common.error")+": "+(e.message||e.err_msg))})}).catch(function(){})},getObjList:function(){var e=this;this.$ajax.getJSON("/server/api/all_adapter_conf_list",{application:this.serverData.application,server_name:this.serverData.server_name}).then(function(t){t.length&&(e.objList=t,e.objName=t[0].servant)}).catch(function(t){e.$tip.error(e.$t("common.error")+": "+(t.message||t.err_msg))})},getContextData:function(e){var t=this;this.$ajax.getJSON("/server/api/get_contexts",{id:e,application:this.serverData.application,server_name:this.serverData.server_name,type:"all"}).then(function(e){t.contextData=e}).catch(function(e){t.$tip.error(t.$t("common.error")+": "+(e.message||e.err_msg))})},parseFields:function(e){var t={};for(var a in e){var r=e[a].defaultValue;r||("string"===e[a].type?r="":"long"!==e[a].type&&"int"!==e[a].type||(r=0)),t[a]=r}return t},getParams:function(e){var t=this;if(this.selectedMethods=e,3==e.length){var a=this.$Loading.show();this.$ajax.getJSON("/server/api/get_params",{application:this.serverData.application,server_name:this.serverData.server_name,id:this.selectedId,module_name:e[0],interface_name:e[1],function_name:e[2]}).then(function(r){a.hide();var s={};t.$ajax.getJSON("/server/api/get_structs",{id:t.selectedId,module_name:e[0]}).then(function(e){r.forEach(function(a){if(!a.out)if("string"===a.type)s[a.name]="";else if("array"===a.type)s[a.name]=[];else if("object"===l()(a.type))if(a.type.vector)s[a.name]=[];else if(a.type.isEnum){s[a.name]={}}else a.type.isStruct&&(s[a.name]=t.parseFields(e.structs[a.type.name].fields));else s[a.name]=""}),t.inParam=o()(s)})}).catch(function(e){a.hide(),t.$tip.error(t.$t("common.error")+": "+(e.message||e.err_msg))})}},doDebug:function(){var e=this,t=this.$Loading.show();this.$ajax.postJSON("/server/api/interface_test",{id:this.selectedId,application:this.serverData.application,server_name:this.serverData.server_name,file_name:this.selectedFileName,module_name:this.selectedMethods[0],interface_name:this.selectedMethods[1],function_name:this.selectedMethods[2],params:this.inParam,objName:this.objName}).then(function(a){t.hide(),e.outParam=a}).catch(function(a){t.hide(),e.$tip.error(e.$t("common.error")+": "+(a.message||a.err_msg))})}},created:function(){this.serverData=this.$parent.getServerData()},mounted:function(){this.getFileList()}},n={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page_server_debuger"},[e.showDebug?e._e():a("wrapper",{ref:"tarsFileListLoading"},[a("let-button",{staticClass:"add-btn",attrs:{size:"small",theme:"primary"},on:{click:e.openTarsUploadFileModal}},[e._v(e._s(e.$t("operate.add")))]),e._v(" "),a("let-table",{attrs:{data:e.tarsFileList,title:e.$t("inf.title.listTitle"),"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{title:e.$t("deployService.form.app"),prop:"application"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.service"),prop:"server_name"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("cfg.btn.fileName"),prop:"file_name"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("cfg.btn.lastUpdate"),prop:"posttime"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("operate.operates"),width:"260px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-table-operation",{on:{click:function(a){return e.showDebuger(t.row)}}},[e._v(e._s(e.$t("inf.list.debug")))]),e._v(" "),a("let-table-operation",{on:{click:function(a){return e.deleteTarsFile(t.row.f_id)}}},[e._v(e._s(e.$t("operate.delete")))])]}}],null,!1,2386188281)})],1)],1),e._v(" "),e.showDebug?a("div",[a("let-form",{staticClass:"left_align",attrs:{itemWidth:"530px"}},[a("let-form-item",{attrs:{label:e.$t("inf.dlg.selectLabel")}},[a("let-cascader",{attrs:{data:e.contextData,required:"",size:"small"},on:{change:e.getParams}})],1),e._v(" "),e.objList.length?a("let-form-item",{attrs:{label:e.$t("inf.dlg.objName")}},[a("let-select",{model:{value:e.objName,callback:function(t){e.objName=t},expression:"objName"}},e._l(e.objList,function(e){return a("let-option",{key:e.servant,attrs:{value:e.servant}})}),1)],1):e._e(),e._v(" "),a("let-form-item",[a("let-button",{attrs:{theme:"primary"},on:{click:e.doDebug}},[e._v(e._s(e.$t("inf.list.debug")))])],1)],1),e._v(" "),a("let-row",[a("div",{staticClass:"params_container"},[a("let-col",{attrs:{span:12,itemWidth:"100%"}},[a("let-form",{attrs:{itemWidth:"100%"}},[a("let-input",{staticClass:"param_area div_line",attrs:{type:"textarea",rows:20,placeholder:e.$t("inf.dlg.inParam")},model:{value:e.inParam,callback:function(t){e.inParam=t},expression:"inParam"}})],1)],1),e._v(" "),a("let-col",{attrs:{span:12}},[a("let-form",{attrs:{itemWidth:"100%"}},[a("let-input",{staticClass:"param_area",attrs:{type:"textarea",rows:20,placeholder:e.$t("inf.dlg.outParam")},model:{value:e.outParam,callback:function(t){e.outParam=t},expression:"outParam"}})],1)],1)],1)]),e._v(" "),a("div",{staticClass:"mt10"},[a("let-button",{attrs:{theme:"primary",size:"small"},on:{click:function(t){e.showDebug=!1}}},[e._v(e._s(e.$t("operate.goback")))])],1)],1):e._e(),e._v(" "),a("let-modal",{attrs:{title:e.$t("inf.title.dlgTitle"),width:"880px",footShow:!1},on:{"on-cancel":e.closeUploadModal},model:{value:e.uploadModal.show,callback:function(t){e.$set(e.uploadModal,"show",t)},expression:"uploadModal.show"}},[e.uploadModal.model?a("let-form",{ref:"uploadForm",attrs:{itemWidth:"100%"},nativeOn:{submit:function(t){return t.preventDefault(),e.uploadTarsFile(t)}}},[a("let-form-item",{attrs:{itemWidth:"400px"}},[a("let-uploader",{attrs:{placeholder:e.$t("pub.dlg.defaultValue"),require:""},on:{upload:e.uploadFile}},[e._v("\n                "+e._s(e.$t("common.submit")))]),e._v(" "),e.uploadModal.model.file?a("span",[e._v(e._s(e.uploadModal.model.file.name))]):e._e()],1),e._v(" "),a("let-button",{attrs:{type:"submit",theme:"primary"}},[e._v(e._s(e.$t("serverList.servant.upload")))])],1):e._e()],1)],1)},staticRenderFns:[]};var c=a("VU/8")(i,n,!1,function(e){a("VnDC")},null,null);t.a=c.exports},"86n0":function(e,t,a){"use strict";var r=a("mvHQ"),o=a.n(r),s=a("//Fk"),l=a.n(s),i=a("Zrlr"),n=a.n(i),c=a("wxAW"),d=a.n(c),u=a("fZjL"),m=a.n(u),p=a("woOf"),f=a.n(p),h=a("pFYg"),v=a.n(h),g=function(e){return"string"==typeof e},_=Array.isArray,b=function(e){return"object"===(void 0===e?"undefined":v()(e))&&null!==e},$=function(e){return"function"==typeof e},M=f.a;function y(e){return String(e).replace(/(?:[\0- "-&\+-\}\x7F-\xA8\xAA-\xAD\xAF-\u2121\u2123-\u23E8\u23F0-\u23F2\u23F4-\u23F7\u23FB-\u24C1\u24C3-\u25B5\u25B7-\u25FF\u27C0-\u2933\u2936-\u2B04\u2B08-\u2B1A\u2B1D-\u2B4F\u2B51-\u2B54\u2B56-\u302F\u3031-\u303C\u303E-\u3296\u3298\u329A-\uD7FF\uE000-\uFFFF]|[\uD800-\uD83B\uD83F-\uDBFF][\uDC00-\uDFFF]|\uD83C[\uDC00-\uDC03\uDC05-\uDCCE\uDCD0-\uDD6F\uDD72-\uDD7D\uDD80-\uDD8D\uDD8F\uDD90\uDE52-\uDEFF]|\uD83D[\uDE50-\uDE7F\uDF00-\uDFFF]|\uD83E[\uDC00-\uDCFF\uDE00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])/g,encodeURIComponent).replace(/ /g,"+").replace(/[!'()~*]/g,function(e){return"%"+e.charCodeAt().toString(16).slice(-2).toUpperCase()})}function w(e){if(!e)return"";var t=[];return m()(e).forEach(function(a){var r=e[a];null!==r&&void 0!==r||(r=""),t.push(y(a)+"="+y(r))}),t.join("&").replace(/%20/g,"+")}function k(e){return w(m()(e).reduce(function(t,a){return function e(t,a,r){return _(r)||b(r)?(m()(r).forEach(function(o){e(t,a+"["+o+"]",r[o])}),t):(t[a]=r,t)}(t,a,e[a])},{}))}var x=function(){function e(t){n()(this,e),this.defaults=t}return d()(e,[{key:"get",value:function(e){return M({},this.defaults,e)}},{key:"set",value:function(e,t){var a=this;if(e){if(g(e)){var r=e.split(".");r.reduce(function(e,a,o){return o===r.length-1&&(e[a]=t),e[a]},this.defaults)}b(e)&&m()(e).forEach(function(t){a.set(t,e[t])}),_(e)&&e.forEach(function(e){return a.set(e,t)})}}},{key:"remove",value:function(e){var t=this;if(e){if(g(e)){var a=e.split(".");a.reduce(function(e,t,r){return r===a.length-1&&delete e[t],e[t]},this.defaults)}_(e)&&e.forEach(function(e){return t.remove(e)})}}}]),e}(),C=function(){function e(t){n()(this,e),this.handler=t}return d()(e,[{key:"set",value:function(e){$(e)&&(this.handler=e)}},{key:"exec",value:function(){$(this.handler)&&this.handler.apply(null,arguments)}}]),e}(),S=new(function(){function e(t){n()(this,e),this.base=t||""}return d()(e,[{key:"set",value:function(e){g(e)&&(this.base=e)}},{key:"get",value:function(e){return this.base+(e||"")}}]),e}()),L=new x({credentials:"same-origin",timeout:5e3}),D=new x({"X-Requested-With":"XMLHttpRequest"}),N=new x({}),A=new C,F=new C(function(){return!0});function T(e,t){var a=w(N.get(t));return a&&(a=-1===e.indexOf("?")?"?"+a:"&"+a),e+a}function q(e){var t=e.status;if(t>=200&&t<300||304===t)return e;throw A.exec(t,e),new Error(e.statusText)}function P(e){return e.json().then(null,function(t){return A.exec(500,e),l.a.reject(t)})}function R(e){return F.handler(e)?e:l.a.reject(e)}function O(e){return l.a.reject(e)}t.a={ServerUrl:S,Options:L,Headers:D,Body:N,StatusHandler:A,ResultHandler:F,get:function(e,t){var a=L.get({headers:D.get()});return fetch(S.get(T(e,t)),a).then(q).then(P).catch(O)},getJSON:function(e,t){var a=L.get({headers:D.get()});return fetch(S.get(T(e,t)),a).then(q).then(P).then(R).catch(O)},post:function(e,t){var a=L.get({method:"POST",headers:D.get({"Content-Type":"application/x-www-form-urlencoded"}),body:k(N.get(t))});return fetch(S.get(e),a).then(q).then(P).then(R).catch(O)},postForm:function(e,t){var a=L.get({method:"POST",headers:D.get(),body:t}),r=N.get({});return m()(r).forEach(function(e){t.append(e,r[e])}),fetch(S.get(e),a).then(q).then(P).then(R).catch(O)},postJSON:function(e,t){var a=L.get({method:"POST",headers:D.get({Accept:"application/json","Content-Type":"application/json"}),body:o()(N.get(t))});return fetch(S.get(e),a).then(q).then(P).then(R).catch(O)},put:function(e,t){var a=L.get({method:"PUT",headers:D.get({"Content-Type":"application/x-www-form-urlencoded"}),body:k(N.get(t))});return fetch(S.get(e),a).then(q).then(P).then(R).catch(O)},remove:function(e,t){var a=L.get({method:"DELETE",headers:D.get()});return fetch(S.get(T(e,t)),a).then(q).then(P).then(R).catch(O)},download:function(e,t){window.open(S.get(T(e,t)))}}},"8bu2":function(e,t){},"9VOc":function(e,t){},"9eSX":function(e,t){},AuvU:function(e,t){},BMUR:function(e,t){},BXyq:function(e,t,a){"use strict";(function(t){var r=a("S1cf"),o=a("M8l6"),s={"Content-Type":"application/x-www-form-urlencoded"};function l(e,t){!r.isUndefined(e)&&r.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var i,n={adapter:("undefined"!=typeof XMLHttpRequest?i=a("KRuG"):void 0!==t&&(i=a("KRuG")),i),transformRequest:[function(e,t){return o(t,"Content-Type"),r.isFormData(e)||r.isArrayBuffer(e)||r.isBuffer(e)||r.isStream(e)||r.isFile(e)||r.isBlob(e)?e:r.isArrayBufferView(e)?e.buffer:r.isURLSearchParams(e)?(l(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):r.isObject(e)?(l(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&e<300}};n.headers={common:{Accept:"application/json, text/plain, */*"}},r.forEach(["delete","get","head"],function(e){n.headers[e]={}}),r.forEach(["post","put","patch"],function(e){n.headers[e]=r.merge(s)}),e.exports=n}).call(t,a("W2nU"))},"C+K7":function(e,t){},CH5c:function(e,t){},CPgP:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAZAAAABxCAYAAAD70PVfAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAADfhJREFUeNrsnT92G8kRh3v1lG1g7gkEnUDgCTQMtKmoxIkDgolTkScAcQKSoZ0Qes8O7MRUvAGHJyB0AkE3gANtyu0SCyKk5S7RNd0z0z3f9948yl4MMNNdXb+q/vvD7e2tAwAACOUJRQAAAAgIAAAgIAAAgIAAAAACAgAAgIAAAAACAgAACAgAACAgAACAgAAAACAgAACAgAAAAAICAAAICAAAFM/Txz7w88mvfdnvfanXJtf6d+Wvhfz3X2Y/LodcoX/9299H/o9clf5fL/y1s/GR8Xf/OzX1f//9zz2a2qBt8mrDHrGXjHjsuI+nGb3L2jFu8jujfDX9/MUIVVCuvaBcFtwwd7QMXqowVJg8APQmA8mUSq8jLyiSnYiIzErJTrxwTPyf1/7ax4QBAAFJh0Tp4nAnXkxESI5zFBLNNo789da12wUFAPAgQxtEl4j9oxeSU39l44Q14/joryniAQAISLdIJH/jRWTc96xDByAvEA4AQED6w0hFZNJT8Rhr1lFhpgCAgPSTC+nS6qF4XJF1AAAC0n9kttYF4gEAgIBYmHTdnYV4AEBOpJjGO/fXu4TPvF5J/UL/PYr43dKdtepi8aFO0409WF67u9X7n9zDK/nbYEUzA0BAtuWTd8B1wmf+5ru9wxcBqVy8hXUiIosO1opcqCA2QZ753N1tB7HAvAEgNwFpFXX0kvXMVUxkrcSkwVeuM4HW9uPx2cd+Q/GTMph50Zhj0gDQFkWNgYiY+OvQ/3PXNeuuqbwYHbUkHmvBsiKisYt4AAACEkdIFioidYOvmWpGk5pTZx/3OPTCIRfjDACAgEQUERkMl24o61iAOPVp4uxDBGpivP2YrAMAEJC0NBGRSeIsxCpQl148zjBfAOiS4nfjlUzEi4CMi9w0cPKHPco+limeBwC6RdeBVe7ufB/xD9ZZmQv1E9cabC4RkGYisvAiMjNG/JKFpDhLxJp9HDPmAVCMaKyPm3jr4q1pG+slMztP/W+IoMjavHls3zGklejS5WMtvEkiowlF1ndc0uwA8hcOf524uw1TT13cBdEPCYr8xkf5TfU/ZCCBWYh0ZZ0bI/8Df51EfByrIJ0PIIXvahuXZcpUv0fRbswjDFYJFqyKY62sN/vnqTOoh/0WROPBslX/d+Cf4TBGWQ1GQDayEMuJfiM5O0SnB8fgwOjgSs8+pFFVHTbsb5yju598ca3/XvRZZDb60J+5+y1/Up55Iw4o9oLb9X5wMerwS7vRS+rzQ9f16J9PbPyoY1MR4bryzyKLjxsFxoMSEM1CLo0ZwIGzz+baNKCRsVGfO2g7WluLWbVRf8n6kxtEs+ttfNiE82FnuY709zfKbakC+K6NrGVjwfB+j8pm6p/rmawls37BEHfjtTriWJGx1YAY++gHm/3JnUWScsyxv6T//H8aECEe4cIy0Uj8ox4bnVI8rnomHmvEjsw7YQxOQLQbypK+jiOdo27pvlqU3j+faYYiM1yuYg5KbuGMKhWOC9d+H3rJYnKhdZmiTE9d2q7EzkRkqOeBWFPWccPGb+2Tfk8b7y2VRrHJRUT7z68QjqR1eRMzG9EsdZLBu08s7z1UAXnfwMCaYBWgmrbda8au2YaYjwYeEh277gdfh5JZXsQQEZ3UcJrRu5+GZmBDFRDrYPiLCBFOMDlMTQS3n6IffaP/vKKIW+VCJyg0csg5imfIDU+HaBmyqlxOHnThA49Nuylekn0UjURwl7FmZ22Ix5ii7UxETOOPGkxYRV9+z3QwnK6hWc/KGxl+W8bYqm2D1qcDNo6FoYKbRoEj43NCPhGcNNx5LEFCPDqvT6mDN4Z73xrukcBj1mSjVHX8ch3r+MvUEPhOtw1chywg1x10C1gE5NNQKsQb/14Xv6v9viN3v/DudQPH/TaGgEQYfF2oE7hWx7TIZA+1uqkdbKxkl78v9K+190C6JschmYCOfYwN9fUm5mxLESL/LLVmsSHvL1nIaJtnGbKAmBrTq+nnynLme4PtGchA0gvX0t1P7Zb1NicqKqcufO7+WLqemjjrBoOvK+36mA952vdG90u9Uab7Ku6Wdij3HQZ+PgSpq70UAi/C5999zyAi8g7Hj33oyYD9Ri6OeemgE1Hxl3RdzAy3N+12soiHOEs52viENUMP1uelZjbHhttDg4hQkXqTMjvU7OlNind4gmm1RmWsfJxBt47nxCDi1mzTOvgqGccetrJVfZ4ZRGRn2xlZG92hIXW3aOG9JcCYh2bSCEj8DKTNLSM496MftLmNTOhu0fMmexkNWERC2/848ufWzFp89fPY7zxYAZGNFY23tjkrhvGPfhC68NQyXXvdTx8SvS6drUsGwp3ptnUa4h/qNrNGzXRCfAoC0iOeUQTZRqx1Sz8Vuk/ajNMpzXU6D8zwUwSO1x28eogt04XVI0YUQdYkjRS17zxksHapThB64kwN2eeyg3f+f8wvQ0AA+tHYQ2f6zKiSxnwIFPlxZjaVHAQEID6WiRah4yacD9OcRQv1WjQICMB2hPRXWyLVkAxkwdhHFChDBASjg7wx7FLA+TBkIL3gKUWQ3Og2I9iK4uudM96WlLPoxi3ZIGwgWZy3l9B6itl1eJDQXv+IlzG/DAGBHAVCrhfufvPD3CPDUHFaYglFMCEDyZRI55unhq283dcFdrJGYr/QVwyq5za2vgBAQNI452WL9w26z1WnTV4gpAD9hEH0QOQ0wzaFJ/SM4oLEQ9L7m4GIRxXwWbIPQEAya7RrmszAsgrP4ARExeOC5hndBgEQkEj8xXCPOfprsGlaNaRK0fEOxAMAAek1lq6RptFfbbjnxYDEYwfxAEBAcsAS2X9o+JuWDGZIA8hyEh+LtQAQkP7yavrZ6pSbDmBaBGiUYBO3PmYfI1fAvHiAITHUabyV8b6mAlI3eN7SZ9+8bXCvrA6+1jJapjikxwvciQs/LbBPtguAgETiteGeZYMpvF8Qx+YdkXzHKPBWWUR3VnidWBYJiiAfchY4ZMrcX596/HyPBryDE5BX088jYxRXR3oEiZaPAu+RA+7Hpa5A1i66UFEt6SzwOsQmZbIBu/EWwbsWT7s08Z9//eNP//sQx0AmxvtiHT9p3Un1bcF1Eiro4jyHfBY4K/OhFwxRQA6M90XZhVMjjqVF+ApelR46VXleWAQeGpwgIICAtM2r6WfJPixOePHL7MeYDssqRtNCqya0Tko7DyM0oHjpoIS6rHJ/2cEIiO6+a3XA55Efx/p9kw7OD2iDoLUffe83tgQogZ+vHPSVkEHxZ7m/7JAykKmz7ysV9fxpnTVk/c4LXbFdEoPuktHJESEZ7k6hgUQJhNRj9scTDEJAfPYhFXVkvH0eufuqaRYiInhKOy2O0IDigCLLPpvc0Y1DEZAei8f6TAkrs0RRZ+3sU4OlKwsRKYv3BhsYUWy9yyZD23TW45pFC4iKx5Wz769UN108mFCcjnR1dAkENboSHad3PJKBhGa6Uwe52/Mo52CwWAHx4iFdVjeu2eZ8SReqabQyb/AVU298JY6JPEZV6HuFdmNNdPt76BfvDMHgBAHph3BU/pKso6mqnyXOPtYcu2bbxIvh3WQ+qBo6C6nURZWWjPRiCJttZhgIrAz1eJpbMFiMgMhAuQrHVYQIdekSjX08kIWsImQ6I3lvb3xXmUakobsUy9YuR64wdHZeHXjbjtZ9qVlZjvW4crZZlkcaDGaTjWS7F5ZkGu5u+udLFYyYyn2YaObVHxncpTeaM2efKbZGyqHy37U24A8a3S96vnJbnjV0osOp7gl1Upj/kYz0xigicwl82FyyN9nkvsEvjdbZiAYTHzp6/vk2dvTD7e3tn37g55Nfbw3Re0oDHru0hw4de/HoZOdbySBc2v791HXzECJexwnffakC9D7lAsPQ7dz9s/zQ4LdETJtEoRI0vNOyr13HBNZt7Z95r8VnC/Fvs5CApUdHAFjYE9t5TB9SZCAjZ1+w1zXzrsRDeePuuuBS9Wn3uW7OjQIy0sxNBiJTimSb5XZsjF43g6yxOjH5s3JpzpPZKjgYKiI2vvxfu4IXyj6lmr8Rj8OODW7lDW4vsYj0tbFJN14dIQPLOYDZtIN1MBGDHcf2J10GhU1ng/aWJ9RvP8Rj03lI+ujinT+SE0Sz93ZQUx5F1ONS23ORICB3A+aHPTO6lfYDzwbW2KSb5RCT/Foe0p06pySwawSkf0il7nrxmPfY8E40elkOqLFJfZw5WJfHIZlIMXa965qt+UJAesCX0+y8cIh4LDIwPJmV8lyzkdVAGtsxmcjvMpG9odR/4ZnIrkszoQEBaUE4xAk/73imVZNs5LlGo8sBNLZ1xFbjer6OiTwnO8u+Hpf+2nXNd6BAQFpC1gjIOMdP/jppc4FgAuOTsZEzzUh21ZksCm5sCx0LOkRIvta/OJ6fNBhaOsg5q8y+Z6G0abwLbVSyelN20q0LNsDFWjx0/5zK3U39lfPFi5q2qdnIXHfhlfURKXYfyEpI/B/JSE+0TCotk5Fjum529ai7UIhdv87NrrcRkL7NBPpeFFY5jGW0YIiX7oH9d3SjvU2DHLdsoMuI77nUrOts4/2+d5jVwOpeymTuvput9V2977g064q2rVtZFX/dtr1sSYh/qxO23691qHU3ct2uBduqHh7dygQAAOAhWAcCAAAICAAAICAAAICAAAAAAgIAAICAAAAAAgIAAAgIAAAgIAAAgIAAAAAgIAAAgIAAAAACAgAACAgAACAgAAAACAgAACAgAACAgAAAAAICAACD4TcBBgC/bsWJPWqUBgAAAABJRU5ErkJggg=="},CZtL:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAWgAAADkCAMAAACCPk7wAAAB71BMVEUAAACLq/OXr+BOgv+ZsuGasuGas+FHgvibteSgtOSaseFGgPZFgPZFgPZFgPZFgPWasuFGgPZIgPZIgPhGgPaasuFGgPVGgPZGgPWasuGas+FFgPdFgPaZsuGZsuGasuDX4vbE0/Lt8vyZseBFf/VJzI9PaZ5QZ5ZMcLpUX3VMb7ZNba1Oa6ZVXW5ObKpQaJlLc8RLcsFPaqJSZIlRZY1RZpJSYoNUYHpVXGlPaJtUXnJJdtBRZZBKdcxLcb1WW2dVXGtNbrBSY4ZTYX1Jdc5NbrJVXnBKdMlTYoBJd9VRZItJdtJFfvBFf/RIeNpGfe1TYHxHeuFFjeJIed1SY4VJyJVIuKpGkN9Id9dKdMpGlNlKc8ZLcb9OaqRGn8tJypJGfOhGnc5Ho8ZQZpRHe+ZOa6hHsLRIvKVIvqJFi+VKc8dIxphGktxHrblItq1GfOpFiehGoclHq7xIwJ9IxJtFgfJHeuNHpcNNbrRNba9HsrJUX3dFhuxHtK9Iwp1TYX9IuqdPaaBTX3hFg/BMb7hHqb5Hr7dMcLxGl9ZGmdNHp8BGmNVFfvJFhe5Ied9FiOpHm9FGmtFHpsGiuOTc7vFRzpTT3/S8ze2swOi0xurL2fK75tqo4s+J2rl4169i0p98nNxmjNlWgNem4c3j6vmllDHDAAAAIHRSTlMACvcT5WpKNy8b0MSvlvftknJQI9yz0InnpIJg3cS8tkiDxQgAAAvDSURBVHja3JhPTxpRFMXnsxBTa0ErVgcU7dTyr5VOiykLCJCQgBs27giGhdGYsCF85t77PHjf5b3ppptXfplP8MvJuedN9K8kSVImvhCHRKPRuLi4OGAWz8/PpVKp3a5Wq4/fiDiOO53OV+ITcXNzSlwSZ8R4vM98JM7Pz98ZTpjhcFgoFO6OmPxRPp9/eLi+vq7X6/P5B+Ll5T2z/EwMioNi8Zjp96fTZrPZ610RtVqtUqm0Wq3vTLfb/Un8ZtbrW2Y2m00mk9FkNBrd3/9ifhhW6Srdi0JBRB8y5JmB6BJEk+lH9mxUv3mmz5g2nsfwTKJh+unpVXSBuTOq8wyLZtOkWUyz58GgSNiir8g0axbT3VfRUA3RMM2iiY3p1WqVpmkUCgkD0aT5sAHPlug2Es2WY5VoiCYQaDvR4lkizZ450nVibkRbiVaim1MT6N5WorsMNLNoo5o8E7bnIEWX/dWxWBjT7U2iYbqz8UxYnlV1ZCYagSa4Oua+6ih6qqOiTEui19BMbKoD3RFodSTwbERLokmzMQ3PsUFMnxp0R4tnEa08wzQC/WZ6iUDDdH8K0T14VqKlOWAazcGo6kjTwEQj0hJomEaiJdDeRKM6RLTujoI5hnZ1sGhCHcPlVqL7TXQHiTamW45odQyJ4BNdTuB5e3UsStLRiLR0NGnG7DhzV4ckemhXR97u6Ll0tCQ6a3XIMWSs6ljjFhJ2oJHosDo6gWhJNDraOoZVSTRWB0xfMuTZO++MaTvSMI2OlupYqmMI0YQSjXmn9t2tAfPOFo1ruBdUogmdaJl34hnzDjtajQ7GP+8YdLQ+hjI6VKLdeceiK2p2wLN0h5NomXeBdbQkers6EGlV0rqjsxMN0d7qqG+tjmXW6mDRrFlE6+pAoifW6vg/HizujtbH8G87mnF39Ak862OoOxqmiwxKGp4p0jXC6xkdnX0M03QVVEeXk4yX4cLtaC5peGZePZtE74/FM6oD1xAPFivSujsgGi/DY3mwsGq1OvwdPbu1qoMItzrYs+roAyRaNYeIVoEmVEcTkmiIlo5mvPPOfYKbdaeqQzzrfbfpaCboji4z8CzH0LwMIVre4HEs1ZE17wgEGreQ8FWHMZ21oxFoHEPPjkai1/JgCX1HI9JyC90drf/eYd6dqgdL5jH0rzupDnd14GkI0Ui0rg79906vjmBfhmW5hg363hJ94Oxo/fcOpv3zjpEHi2vaOYZ6R+Ov0pW8wdWDRUyv1Y6+V4kO66dSbseJQiG340ShkNtxolDI7ThRKOR2nCgUcjvOH3boHYWBIAaCqI5iGnRjTTS/YC9qDLYxXoVa6BV6WaUlLJCcsEBywgLJCQskJyyQnLBAcsICyQkLJCcskJywQHLCAj4ba7e21zDEeLxd3fcabVO/5md1jQ4f3Zv+aB0vNTp89KF/DgA1Onx015OOGh0+2pqeNKvR4aOnOmaNjh5t6rIaHTx6qGvU6ODRS12rRgeP3uraNfrJ3p3kKAwDURiuhG7opgd6HoWAFDdGQGAH4qDsEBZIiSO/gMvvP8K3AOclkgNDz89DzwlN6Dih+dNxiH+GJqB5vDuKDywGoPkIfhxHJQPQnEmdOPwbgOarLCe+nDUAzc8NnPgBjYEPaMwk11JhPLmWCuNJ+L6nTSqMJ4CeCH2aIHokdDvQ2QOhW4GWzhehW4GWzkdi0GvF9CIVvf8kBb1QTJ9SWW+QEPRYMfUzqSH9nAz0bqaQbu6lTm/JQIOc8zup138i0KVCyrtSt9ckoJeK6RY6e0yiq1RMf36zh3nolWL69Z09jEMvFdMw8549TEOjnPtZg9nDMjTyAO0/e9iFbvcAXT17WIUGOWtXmtUb2IQu1Ql9gA40e8R3n+FG3cDLaKjZI7r7DFHOI/HJf/aI7T7DrTqhD3bhZo/I7jPc5geayx/svGaPyO4z3LN3pj1NBVEAfYi7VK1LjMaYNq8qIFGrKIiKcQVEUErqAm4ssliK7BikUENYCrInCn7yAz/U2zD0to/y+p52JjNv5vyEk5vb09smk/DMRdjZOXuI9Z7hHx3hIexsnD2Ees8wyTMnYWf97CHSe4a0guMMi397CPSeIS3Pp7VskXt2Z9HivGdoCDval9Fsnz2Eec+Q37CzdvYQ5T3DKlqeTcIuq2cPQd4zrDYEB+WfvCmcPQR5z5DvsLNy9hDjPcNkzzyGnYWzhxDvGfIfdimcEvUPNB6dDudyNDq4xBS9oSfB0WXUhDwRRW/w9JO35bOHgKLX0A1vl1Gzs4dwotf1JHi7jJqdPQQTzcN/Rv+Jo7pQ/PJSwqVRJeekLhRej5cSvrwcjR4HDuoisfrbQ0+071CuRov9u3WRWP3poSnad+K4Roe9u3SRWAPPFEUDR/ZpNNijC8U6WKYqGjh8jLiROTc89EUDbg2QOzdYiAYg8yTPDUaiIfMkzw1WoiHz5M4NZqIh86TODXaiIfNkzg2GoiHzJM4NFqIRt7y5wUQ04pI2N1iJxsyTNDeYicbMkzM32InGzJMyNxiKxsyTMTdYisbMkzA3WIpG3PLlhplo+O/rk4JvJQ8rbz64XnznxsUrty5ce/fp8qX7Xwvzy99ebay4+6i66nXtQt1Q65fnz2oyi0Zc0uWGmeh7pZuix0H0UyK6qAhEPy7Mn/YnRNfXDX20LBozT7LcMBUNE11GJhpEtyQmGkSXo+gFW6Ix8+TKDXPRONHFONFJq+M2mWg7qwMzT6rcyLQ6yow7eku0399Y8SY+0fVkdfywKhozT6bcyDjRBSUvUDTuaPwwtD/RmHkS5YaV6hhPVx1+XB12dzTilic3rFRHJVbH9y3R0zDRn7cmutXmRCMuaXIj8+owTHTRtolesLejjZknSW7Yrg7jF5Za2zvamHly5EZG0VgdLTjR2fgwxMyTIjdMPwxL46sjdUfjN8P//jDEzJMhN1gdlcwzT4Lc4EE0ZJ7zc4MP0T6X43ODE9GQeQ7PDV5EQ+Y5Oze4EQ2Z5+jc4Ec0ZJ6Tc4Mj0ZB5Ds4NnkRj5tnCIxJeSmg2UaKVaCXaIxLEixJtQIlWopVoJZoHiBcl2oASrUQr0Uo0DxAvSrQBJVqJVqKVaB4gXpRoA0q0Eq1EK9E8QLw4S/R5wgcgGAyGQqGBgbGxsf7+/o6Ojvb29mj0JdDd3R2JjIyMtLVNTU2Fw+G+vsnJydmVleHh4ebm5t7e90ATsLwcm5ubm5lpaGjo6up6BQQCgc7Ozp6excXF0dH5+YmJwcHBGp8SDZ6BFNFR4jkCnoG46D4ARM8mRPduil5ajsVi4Hm7aDA9iqJr5BYdTDPRUSBpoono8KZnGGkU3QQsxU2nTHQgSbSaaKPogTSrI5IQHTaZ6J1XB+wONdFoOrR9R5OJxtVBTBt2tOXVMaEm+m87drTSQAxEYfgdBS14Z29aKYpUpSBbEYqwVmTtPrHJOpI2szG52Kyx/ecRPoaTOQlv9O1BdIiz22gHbaUjG7058Y2OXR1r7+pYWue27YkOMjoWHeIs0HN9dbjH0GW0fgw7Z73RnHfiHMzoC++8u1HQ1tltNOddakaLdHyj28DVwUZHoRfpd7Ta6Ngd3XB1qGYYuDrE2RUWldG7Hc0wdaMFOn5Hb/syWp13XB0JFdxldCA6dAUPFpaGZuii45cKrqHljk4tLA3N0EnvR4fc0e4t9JqhvqN7o+OMv46CR1yA9gZooIEGuoQRF6C9ARpooE8P+vvLf/HwfD+f2bK9fjI/zsvXdjW1JeTzrTbVY2JKx11VbR4DRQPoROhzDb1d2WJ9Zb6Xa4FugM4EPe02+v3yB/oD6KGgZ2qj96AroDNHBxk90kaT0cNv9MtBRnfQNdEx5HmnoeW8IzoGhdbR0UpGS3RcEx0ZH0MHPWGjcz6G3NEjFZZuo+sa6OzNkAqeLTo47/4kOsjoMaCNMxWcj3+ggf5HIy5AewM00EADXcKIC9DeAA000ECXMOICtDdAAw000CWMuADtDdBAAw10CSMuQHsDNNBAA13CiAvQ3hwt9BeZfObQe9dnUAAAAABJRU5ErkJggg=="},CeRa:function(e,t,a){"use strict";var r=a("7+uW"),o=(a("miEh"),a("wQkr"),a("MqDE")),s=a.n(o);r.default.component(s.a.name,s.a);var l=a("Wc9H"),i=a.n(l),n=a("IaZV"),c=a.n(n),d=new i.a({id:"zoom-in",use:"zoom-in-usage",viewBox:"0 0 1024 1024",content:'<symbol class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" id="zoom-in"><defs><style></style></defs><path d="M426.65984 42.65984q78.00832 0 149.17632 30.49472t122.49088 81.83808 81.83808 122.49088 30.49472 149.17632q0 66.99008-21.83168 128.32768t-62.1568 111.32928l242.33984 241.99168q12.32896 12.32896 12.32896 30.33088 0 18.3296-12.16512 30.49472t-30.49472 12.16512q-18.00192 0-30.33088-12.32896l-241.99168-242.33984q-49.99168 40.32512-111.32928 62.1568t-128.32768 21.83168q-78.00832 0-149.17632-30.49472t-122.49088-81.83808-81.83808-122.49088-30.49472-149.17632 30.49472-149.17632 81.83808-122.49088 122.49088-81.83808 149.17632-30.49472zM426.65984 128q-60.66176 0-115.99872 23.67488t-95.3344 63.67232-63.67232 95.3344-23.67488 115.99872 23.67488 115.99872 63.67232 95.3344 95.3344 63.67232 115.99872 23.67488 115.99872-23.67488 95.3344-63.67232 63.67232-95.3344 23.67488-115.99872-23.67488-115.99872-63.67232-95.3344-95.3344-63.67232-115.99872-23.67488zM426.65984 256q17.67424 0 30.16704 12.4928t12.4928 30.16704l0 85.34016 85.34016 0q17.67424 0 30.16704 12.4928t12.4928 30.16704-12.4928 30.16704-30.16704 12.4928l-85.34016 0 0 85.34016q0 17.67424-12.4928 30.16704t-30.16704 12.4928-30.16704-12.4928-12.4928-30.16704l0-85.34016-85.34016 0q-17.67424 0-30.16704-12.4928t-12.4928-30.16704 12.4928-30.16704 30.16704-12.4928l85.34016 0 0-85.34016q0-17.67424 12.4928-30.16704t30.16704-12.4928z" /></symbol>'}),u=(c.a.add(d),{props:{title:String,timeColumn:String,dataColumns:Array,data:Array},data:function(){return{enlarge:!1}},computed:{chartOptions:function(){var e={},t=[this.timeColumn];return this.dataColumns.forEach(function(a){var r=a.name,o=a.label;e[r]=o,t.push(r)}),{title:{show:!0,text:this.title},grid:{bottom:40,top:50},legend:{top:5},colors:["#f56c77","#6accab"],settings:{labelMap:e,scale:[!0,!1],lineStyle:{width:1}},data:{columns:t,rows:this.data}}},largeChartOptions:function(){var e={},t=[this.timeColumn];return this.dataColumns.forEach(function(a){var r=a.name,o=a.label;e[r]=o,t.push(r)}),{title:{show:!0,text:this.title},grid:{bottom:40,top:50},legend:{top:5},colors:["#f56c77","#6accab"],settings:{labelMap:e,scale:[!0,!1],lineStyle:{width:1}},data:{columns:t,rows:this.data},dataZoom:[{type:"inside",minValueSpan:12,zoomOnMouseWheel:"alt"},{minValueSpan:12}]}}}}),m={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"compare-chart"},[a("ve-line",e._b({},"ve-line",e.chartOptions,!1)),e._v(" "),a("a",{staticClass:"compare-chart-zoom-in",attrs:{href:"javascript:"},on:{click:function(t){e.enlarge=!0}}},[a("icon",{attrs:{name:"zoom-in"}})],1),e._v(" "),a("let-modal",{attrs:{width:"80%"},on:{close:function(t){e.enlarge=!1}},model:{value:e.enlarge,callback:function(t){e.enlarge=t},expression:"enlarge"}},[e.enlarge?a("ve-line",e._b({},"ve-line",e.largeChartOptions,!1)):e._e(),e._v(" "),a("div",{attrs:{slot:"foot"},slot:"foot"})],1)],1)},staticRenderFns:[]};var p=a("VU/8")(u,m,!1,function(e){a("KtFB")},null,null);t.a=p.exports},Cp0g:function(e,t,a){"use strict";a.d(t,"a",function(){return d}),a.d(t,"c",function(){return u}),t.b=function(){return new o.a(function(e,t){c.a.getJSON("/server/api/get_locale").then(function(t){var a=n.a.get("locale");if("[object Object]"==Object.prototype.toString.call(t)){for(var r in t)d.setLocaleMessage(r,t[r]),u.push({localeCode:r,localeName:t[r].localeName,localeMessages:t});a=t[a]?a:"cn",u=t}d.locale=a,e()}).catch(function(e){t(e)})})};var r=a("//Fk"),o=a.n(r),s=a("7+uW"),l=a("TXmL"),i=a("K/Lq"),n=a.n(i),c=a("86n0");s.default.use(l.a),s.default.use(n.a);var d=new l.a({}),u=[]},DQfC:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("7+uW"),o=(a("3NoR"),a("sVYP")),s=a("m6R6"),l=a.n(s),i=a("v/hR"),n=a.n(i),c=a("Cp0g"),d={data:function(){return{serverIcon:l.a,opaIcon:n.a,locale:this.$cookie.get("locale")||"cn",uid:"--",userOptOpen:!1,enableLogin:!1,localeMessages:c.c}},methods:{clickTab:function(e){this.$router.replace(e)},getLoginUid:function(){var e=this;this.$ajax.getJSON("/server/api/get_login_uid").then(function(t){t&&t.uid?e.uid=t.uid:e.uid="***"}).catch(function(t){e.$tip.error("获取用户登录信息: "+(t.err_msg||t.message))})},changeLocale:function(){this.$cookie.set("locale",this.locale,{expires:"1Y"}),location.reload()},checkEnableLogin:function(){var e=this;this.$ajax.getJSON("/server/api/is_enable_login").then(function(t){e.enableLogin=t.enableLogin||!1}).catch(function(e){})}},mounted:function(){this.getLoginUid(),this.checkEnableLogin()}},u={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app_index__header"},[a("div",{staticClass:"main-width"},[a("h1",{staticClass:"hidden"},[e._v("TARS")]),e._v(" "),e._m(0),e._v(" "),a("let-tabs",{staticClass:"tabs",attrs:{center:!0,activekey:e.$route.matched[0]?e.$route.matched[0].path:"/server"},on:{click:e.clickTab}},[a("let-tab-pane",{attrs:{tab:e.$t("header.tab.tab1"),tabkey:"/server",icon:e.serverIcon}}),e._v(" "),a("let-tab-pane",{attrs:{tab:e.$t("header.tab.tab2"),tabkey:"/operation",icon:e.opaIcon}}),e._v(" "),a("let-tab-pane",{attrs:{tab:e.$t("header.tab.tab3"),tabkey:"/releasePackage",icon:e.opaIcon}}),e._v(" "),a("let-tab-pane",{attrs:{tab:e.$t("header.tab.tab4"),tabkey:"/config",icon:e.opaIcon}}),e._v(" "),a("let-tab-pane",{attrs:{tab:e.$t("header.tab.tab5"),tabkey:"/operationManage",icon:e.opaIcon}})],1),e._v(" "),a("div",{staticClass:"language-wrap"},[a("let-select",{attrs:{clearable:!1},on:{change:e.changeLocale},model:{value:e.locale,callback:function(t){e.locale=t},expression:"locale"}},[e._l(e.localeMessages,function(t){return[a("let-option",{attrs:{value:t.localeCode}},[e._v(e._s(t.localeName))])]})],2)],1),e._v(" "),a("div",{staticClass:"user-wrap"},[a("p",{staticClass:"user-info",on:{click:function(t){e.userOptOpen=!e.userOptOpen}}},[a("span",{staticClass:"name toe"},[e._v(e._s(e.uid)+" ")]),e._v(" "),a("i",{directives:[{name:"show",rawName:"v-show",value:e.enableLogin,expression:"enableLogin"}],staticClass:"let-icon let-icon-caret-down",class:{up:e.userOptOpen}}),e._v(" "),a("transition",{attrs:{name:"fade"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.enableLogin&&e.userOptOpen,expression:"enableLogin && userOptOpen"}],staticClass:"user-pop-wrap"},[a("a",{attrs:{href:"/logout"}},[e._v(e._s(e.$t("header.logout")))])])])],1)])],1)])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"logo-wrap"},[t("a",{attrs:{href:"/"}},[t("img",{staticClass:"logo",attrs:{src:a("dLd/")}})]),this._v(" "),t("a",{staticClass:"active",attrs:{href:"/dcache.html"}},[t("img",{staticClass:"logo",attrs:{alt:"dcache",src:a("CPgP")}})])])}]};var m={name:"App",components:{AppDcacheHeader:a("VU/8")(d,u,!1,function(e){a("kiiE")},null,null).exports,AppFooter:a("m8r6").a}},p={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("app-dcache-header"),this._v(" "),t("keep-alive",[t("router-view",{staticClass:"main-width"})],1),this._v(" "),t("app-footer",{staticClass:"app_index__footer"})],1)},staticRenderFns:[]};var f=a("VU/8")(m,p,!1,function(e){a("hVKt")},null,null).exports,h=a("/ocq"),v=a("woOf"),g=a.n(v),_={name:"Server",data:function(){return{treeErrMsg:"加载失败",treeData:null,enableAuth:!1,serverData:{level:5,application:"",server_name:"",set_name:"",set_area:"",set_group:"",module_name:""}}},computed:{base:function(){return"/server/"+this.$route.params.treeid},serverType:function(){return this.$route.params.serverType}},watch:{"$route.params.treeid":function(e){console.log("$route.params.treeid$route.params.treeid"),this.serverData=this.getServerData()},$route:function(e,t){"/server"===e.path&&this.getTreeData()}},methods:{selectTree:function(e,t){if(console.log(t),t.children&&t.children.length)this.$set(t,"expand",!t.expand),t.moduleName&&this.$router.push("/server/6"+t.moduleName+"/cache");else{var a=t.serverType;!a&&(a="tars"),this.$router.push("/server/"+e+"/manage/"+a)}},handleData:function(e,t){var a=this;e&&e.length&&e.forEach(function(e){e.label=e.name,e.nodeKey=e.id,t&&(e.iconClass="tree-icon",e.expand=!0),e.children&&e.children.length&&a.handleData(e.children)})},getTreeData:function(){var e=this;this.treeData=null,this.$nextTick(function(){var t=e.$loading.show({target:e.$refs.treeLoading});e.$ajax.getJSON("/server/api/dtree").then(function(a){t.hide(),e.treeData=a,e.handleData(e.treeData,!0)}).catch(function(a){t.hide(),console.error(a),e.treeErrMsg=a.err_msg||a.message||"加载失败",e.treeData=!1})})},getServerData:function(){if(!this.$route.params.treeid)return{};var e={level:5,application:"",server_name:"",set_name:"",set_area:"",set_group:""};return this.$route.params.treeid.split(".").forEach(function(t){var a=+t.substr(0,1),r=t.substr(1);switch(a){case 1:e.application=r;break;case 2:e.set_name=r;break;case 3:e.set_area=r;break;case 4:e.set_group=r;break;case 5:e.server_name=r;break;case 6:e.module_name=r}e.level=a}),e},clickTab:function(e){var t=this.isServerManage(e),a=this.isServerManage(this.$route.path),r=t&&a?{path:e,query:{time:Date.now()}}:{path:e,query:{}};this.$router.push(g()({},this.$route,r))},isServerManage:function(e){return e.indexOf("/server")>-1&&e.indexOf("/manage")>-1},isTrueTreeLevel:function(){var e=this.$route.path.split("/"),t=e[e.length-1],a=!1;5===this.serverData.level||"publish"!==t&&"server-monitor"!==t&&"property-monitor"!==t&&"user-manage"!==t||(a=!0),5!==this.serverData.level&&4!==this.serverData.level&&1!==this.serverData.level&&"config"===t&&(a=!0),a&&this.$router.replace("manage")}},created:function(){this.serverData=this.getServerData(),this.isTrueTreeLevel()},mounted:function(){this.getTreeData(),window.dcacheIndex=this}},b={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"page_server"},[e.treeData&&e.treeData.length?r("let-tree",{staticClass:"left-tree",attrs:{data:e.treeData,activeKey:e.$route.params.treeid},on:{"on-select":e.selectTree}}):e._e(),e._v(" "),e.treeData&&!e.treeData.length?r("div",{staticClass:"left-tree"},[r("p",{staticClass:"loading"},[e._v(e._s(e.$t("common.noService")))])]):e._e(),e._v(" "),e.treeData?e._e():r("div",{ref:"treeLoading",staticClass:"left-tree"},[!1===e.treeData?r("div",{staticClass:"loading"},[r("p",[e._v(e._s(e.treeErrMsg))]),e._v(" "),r("a",{attrs:{href:"javascript:;"},on:{click:e.getTreeData}},[e._v(e._s(e.$t("common.reTry")))])]):e._e()]),e._v(" "),this.$route.params.treeid?r("div",{staticClass:"right-view"},[r("let-tabs",{attrs:{activekey:e.$route.path},on:{click:e.clickTab}},[6!==e.serverData.level?r("let-tab-pane",{attrs:{tabkey:e.base+"/manage/"+e.serverType,tab:e.$t("header.tab.tab1")}}):e._e(),e._v(" "),6===e.serverData.level?r("let-tab-pane",{attrs:{tabkey:e.base+"/cache",tab:e.$t("header.tab.tab1")}}):e._e(),e._v(" "),5===e.serverData.level?r("let-tab-pane",{attrs:{tabkey:e.base+"/publish/"+e.serverType,tab:e.$t("index.rightView.tab.patch")}}):e._e(),e._v(" "),5!==e.serverData.level&&4!==e.serverData.level&&1!==e.serverData.level||"dcache"===e.serverType?e._e():r("let-tab-pane",{attrs:{tabkey:e.base+"/config/"+e.serverType,tab:5===e.serverData.level?e.$t("index.rightView.tab.serviceConfig"):4===e.serverData.level?e.$t("index.rightView.tab.setConfig"):1===e.serverData.level?e.$t("index.rightView.tab.appConfig"):""}}),e._v(" "),5===e.serverData.level?r("let-tab-pane",{attrs:{tabkey:e.base+"/server-monitor/"+e.serverType,tab:e.$t("index.rightView.tab.statMonitor")}}):e._e(),e._v(" "),5===e.serverData.level?r("let-tab-pane",{attrs:{tabkey:e.base+"/property-monitor/"+e.serverType,tab:e.$t("index.rightView.tab.propertyMonitor")}}):e._e(),e._v(" "),5===e.serverData.level&&e.enableAuth?r("let-tab-pane",{attrs:{tabkey:e.base+"/user-manage/"+e.serverType,tab:e.$t("index.rightView.tab.privileage")}}):e._e(),e._v(" "),6===e.serverData.level?r("let-tab-pane",{attrs:{tabkey:e.base+"/moduleCache",tab:e.$t("cache.config.configuration")}}):e._e()],1),e._v(" "),r("router-view",{key:e.$route.params.treeid,ref:"childView",staticClass:"page_server_child"})],1):r("div",{staticClass:"right-view"},[r("div",{staticClass:"empty"},[r("img",{staticClass:"package",attrs:{src:a("CZtL")}}),e._v(" "),r("p",{staticClass:"title"},[e._v(e._s(e.$t("index.rightView.title")))]),e._v(" "),r("p",{staticClass:"notice",domProps:{innerHTML:e._s(e.$t("index.rightView.tips"))}})])])],1)},staticRenderFns:[]};var $=a("VU/8")(_,b,!1,function(e){a("Qi1R")},null,null).exports,M=(a("KsY+"),a("+6Bu")),y=a.n(M),w=a("//Fk"),k=a.n(w),x=a("Dd8w"),C=a.n(x),S=a("Xxa5"),L=a.n(S),D=a("exGp"),N=a.n(D),A={name:"ServerManage",data:function(){return{serverType:this.$route.params.serverType||"tars",serverData:{level:5,application:"",server_name:"",set_name:"",set_area:"",set_group:""},serverList:[],serverNotifyList:[],pageNum:1,pageSize:20,total:1,serverTypes:["tars_cpp","tars_java","tars_php","tars_nodejs","not_tars","tars_go"],configModal:{show:!1,model:null},servantModal:{show:!1,model:null,currentServer:null},servantDetailModal:{show:!1,isNew:!0,model:null},logLevels:["NONE","DEBUG","INFO","WARN","ERROR"],moreCmdModal:{show:!1,model:null,currentServer:null},failCount:0}},computed:{showOthers:function(){return 5===this.serverData.level},isEndpointValid:function(){return!(!this.servantDetailModal.model||!this.servantDetailModal.model.endpoint)&&this.checkServantEndpoint(this.servantDetailModal.model.endpoint)}},watch:{$route:function(e,t){this.getServerList(),this.getServerNotifyList(1)}},methods:{getServerList:function(){var e,t=this,a=this.$refs.serverListLoading.$loading.show();this.$ajax.getJSON("/server/api/server_list",{tree_node_id:this.$route.params.treeid}).then((e=N()(L.a.mark(function e(r){return L.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a.hide(),t.serverList=r,"dcache"!==t.serverType){e.next=17;break}if(!(t.serverList.length>0)){e.next=6;break}return e.abrupt("return",!1);case 6:return e.prev=6,e.next=9,t.$ajax.postJSON("/server/api/cache/removeServer",{server_name:t.$route.params.treeid.split(".")[1].substr(1)});case 9:t.$parent.getTreeData(),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(6),console.error(e.t0);case 15:e.next=45;break;case 17:if("proxy"!==t.serverType){e.next=32;break}if(!(t.serverList.length>0)){e.next=21;break}return e.abrupt("return",!1);case 21:return e.prev=21,e.next=24,t.$ajax.postJSON("/server/api/cache/removeProxy",{server_name:t.$route.params.treeid.split(".")[1].substr(1)});case 24:t.$parent.getTreeData(),e.next=30;break;case 27:e.prev=27,e.t1=e.catch(21),console.error(e.t1);case 30:e.next=45;break;case 32:if("router"!==t.serverType){e.next=45;break}if(!(t.serverList.length>0)){e.next=36;break}return e.abrupt("return",!1);case 36:return e.prev=36,e.next=39,t.$ajax.postJSON("/server/api/cache/removeRouter",{server_name:t.$route.params.treeid.split(".")[1].substr(1)});case 39:t.$parent.getTreeData(),e.next=45;break;case 42:e.prev=42,e.t2=e.catch(36),console.error(e.t2);case 45:case"end":return e.stop()}},e,t,[[6,12],[21,27],[36,42]])})),function(t){return e.apply(this,arguments)})).catch(function(e){a.hide(),t.$confirm(e.err_msg||e.message||t.$t("serverList.msg.fail"),t.$t("common.alert")).then(function(){t.getServerList()})})},getServerNotifyList:function(e){var t=this;if(this.showOthers){var a=this.$refs.serverNotifyListLoading.$loading.show();this.$ajax.getJSON("/server/api/server_notify_list",{tree_node_id:this.$route.params.treeid,page_size:this.pageSize,curr_page:e}).then(function(r){a.hide(),t.pageNum=e,t.total=Math.ceil(r.count/t.pageSize),t.serverNotifyList=r.rows}).catch(function(e){a.hide(),t.$tip.error(t.$t("serverList.restart.failed")+": "+(e.err_msg||e.message))})}},gotoPage:function(e){this.getServerNotifyList(e)},getTemplateList:function(){var e=this;this.$ajax.getJSON("/server/api/template_name_list").then(function(t){e.configModal.model?e.configModal.model.templates=t:e.configModal.model={templates:t}}).catch(function(t){e.$tip.error(e.$t("serverList.restart.failed")+": "+(t.err_msg||t.message))})},getServerConfig:function(e){var t=this,a=this.$loading.show({target:this.$refs.configFormLoading});this.$ajax.getJSON("/server/api/server",{id:e}).then(function(e){a.hide(),t.configModal.model?t.configModal.model=g()({},t.configModal.model,e):(e.templates=[],t.configModal.model=e)}).catch(function(e){a.hide(),t.closeConfigModal(),t.$tip.error(t.$t("serverList.restart.failed")+": "+(e.err_msg||e.message))})},configServer:function(e){this.configModal.show=!0,this.getTemplateList(),this.getServerConfig(e)},saveConfig:function(){var e=this;if(this.$refs.configForm.validate()){var t=this.$Loading.show();this.$ajax.postJSON("/server/api/update_server",C()({isBak:this.configModal.model.bak_flag},this.configModal.model)).then(function(a){t.hide(),e.serverList=e.serverList.map(function(e){return e.id===a.id?a:e}),e.closeConfigModal(),e.$tip.success(e.$t("serverList.restart.success"))}).catch(function(a){t.hide(),e.$tip.error(e.$t("serverList.restart.failed")+": "+(a.message||a.err_msg))})}},closeConfigModal:function(){this.$refs.configForm&&this.$refs.configForm.resetValid(),this.configModal.show=!1,this.configModal.model=null},checkTaskStatus:function(e,t){var a=this;return new k.a(function(r,o){a.$ajax.getJSON("/server/api/task",{task_no:e}).then(function(t){1===t.status||0===t.status?setTimeout(function(){r(a.checkTaskStatus(e))},3e3):2===t.status?r("taskid: "+t.task_no):o(new Error("taskid: "+t.task_no))}).catch(function(s){t?o(new Error(s.err_msg||s.message||a.$t("common.networkErr"))):setTimeout(function(){r(a.checkTaskStatus(e,!0))},3e3)})})},addTask:function(e,t,a){var r=this,o=this.$Loading.show();return this.$ajax.postJSON("/server/api/add_task",{serial:!0,items:[{server_id:e,command:t}]}).then(function(e){return r.checkTaskStatus(e).then(function(e){o.hide(),r.getServerList(),r.$tip.success({title:a.success,message:e})}).catch(function(e){throw e})}).catch(function(e){o.hide(),r.getServerList(),r.$tip.error({title:a.error,message:e.err_msg||e.message||r.$t("common.networkErr")})})},restartServer:function(e){this.addTask(e,"restart",{success:this.$t("serverList.restart.success"),error:this.$t("serverList.restart.failed")})},stopServer:function(e){var t=this;this.$confirm(this.$t("serverList.stopService.msg.stopService"),this.$t("common.alert")).then(function(){t.addTask(e,"stop",{success:t.$t("serverList.restart.success"),error:t.$t("serverList.restart.failed")})})},undeployServer:function(e){var t=this,a=e.id,r=e.server_name;y()(e,["id","server_name"]);return N()(L.a.mark(function e(){return L.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.$confirm(t.$t("serverList.dlg.msg.undeploy"),t.$t("common.alert")).then(N()(L.a.mark(function e(){var o,s;return L.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=t.serverList,s=t.serverType,!(["proxy","router"].indexOf(s)>-1&&1===o.length)){e.next=15;break}return e.next=4,t.$ajax.getJSON("/server/api/cache/hasModule",{serverType:s,serverName:r});case 4:if(!e.sent){e.next=7;break}return e.abrupt("return",t.$tip.warning(t.$t("pub.dlg.hasModule")));case 7:return e.prev=7,e.next=10,t.$confirm(t.$t("pub.dlg.cantUseApply"));case 10:e.next=15;break;case 12:return e.prev=12,e.t0=e.catch(7),e.abrupt("return",!1);case 15:return e.prev=15,e.next=18,t.addTask(a,"undeploy_tars",{success:t.$t("serverList.restart.success"),error:t.$t("serverList.restart.failed")});case 18:e.next=22;break;case 20:e.prev=20,e.t1=e.catch(15);case 22:return e.prev=22,t.closeMoreCmdModal(),e.finish(22);case 25:case"end":return e.stop()}},e,t,[[7,12],[15,20,22,25]])})));case 1:case"end":return e.stop()}},e,t)}))()},manageServant:function(e){var t=this;this.servantModal.show=!0;var a=this.$loading.show({target:this.$refs.servantModalLoading});this.$ajax.getJSON("/server/api/adapter_conf_list",{id:e.id}).then(function(r){a.hide(),t.servantModal.model=r,t.servantModal.currentServer=e}).catch(function(e){a.hide(),t.$tip.error(t.$t("serverList.restart.failed")+": "+(e.err_msg||e.message))})},closeServantModal:function(){this.servantModal.show=!1,this.servantModal.model=null,this.servantModal.currentServer=null},configServant:function(e){if(this.servantDetailModal.model={application:this.servantModal.currentServer.application,server_name:this.servantModal.currentServer.server_name,obj_name:"",node_name:"",endpoint:"",servant:"",thread_num:"",max_connections:"200000",queuecap:"10000",queuetimeout:"60000",allow_ip:"",protocol:"not_tars",handlegroup:""},this.servantDetailModal.isNew=!0,e){var t=this.servantModal.model.find(function(t){return t.id===e});t.obj_name=t.servant.split(".")[2],this.servantDetailModal.model=g()({},this.servantDetailModal.model,t),this.servantDetailModal.isNew=!1}this.servantDetailModal.show=!0},closeServantDetailModal:function(){this.$refs.servantDetailForm&&this.$refs.servantDetailForm.resetValid(),this.servantDetailModal.show=!1,this.servantDetailModal.model=null},checkServantEndpoint:function(e){var t=e.split(/\s-/),a=/^h\s(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/i,r=/^t\s([1-9]|[1-9]\d+)$/i,o=/^p\s\d{4,5}$/i,s=!0;if(/^tcp|udp$/i.test(t[0])){for(var l=0,i=1;i<t.length;i++)if(a&&a.test(t[i])&&(l++,this.servantDetailModal.model.node_name=t[i].split(/\s/)[1],a=null),r&&r.test(t[i])&&(l++,r=null),o&&o.test(t[i])){var n=t[i].substring(2);n<0||n>65535||l++,o=null}s=3===l}else s=!1;return s},saveServantDetail:function(){var e=this;if(this.$refs.servantDetailForm.validate()){var t=this.$Loading.show();if(this.servantDetailModal.isNew){var a=this.servantDetailModal.model;a.servant=[a.application,a.server_name,a.obj_name].join("."),this.$ajax.postJSON("/server/api/add_adapter_conf",a).then(function(a){t.hide(),e.servantModal.model.unshift(a),e.$tip.success(e.$t("common.success")),e.closeServantDetailModal()}).catch(function(a){t.hide(),e.$tip.error(e.$t("common.error")+": "+(a.err_msg||a.message))})}else this.servantDetailModal.model.servant=this.servantDetailModal.model.application+"."+this.servantDetailModal.model.server_name+"."+this.servantDetailModal.model.obj_name,this.$ajax.postJSON("/server/api/update_adapter_conf",this.servantDetailModal.model).then(function(a){t.hide(),e.servantModal.model=e.servantModal.model.map(function(e){return e.id===a.id?a:e}),e.$tip.success(e.$t("common.success")),e.closeServantDetailModal()}).catch(function(a){t.hide(),e.$tip.error(e.$t("common.error")+": "+(a.err_msg||a.message))})}},deleteServant:function(e){var t=this;this.$confirm(this.$t("serverList.servant.a"),this.$t("common.alert")).then(function(){var a=t.$Loading.show();t.$ajax.getJSON("/server/api/delete_adapter_conf",{id:e}).then(function(r){a.hide(),t.servantModal.model=t.servantModal.model.map(function(t){if(t.id!==e)return t}).filter(function(e){return e}),t.$tip.success(t.$t("common.success"))}).catch(function(e){a.hide(),t.$tip.error(t.$t("common.error")+": "+(e.err_msg||e.message))})})},showMoreCmd:function(e){var t=this;this.moreCmdModal.model={selected:"setloglevel",setloglevel:"NONE",loadconfig:"",command:"",configs:null},this.moreCmdModal.unwatch=this.$watch("moreCmdModal.model.selected",function(){t.$refs.moreCmdForm&&t.$refs.moreCmdForm.resetValid()}),this.moreCmdModal.show=!0,this.moreCmdModal.currentServer=e,this.$ajax.getJSON("/server/api/config_file_list",{level:5,application:e.application,server_name:e.server_name}).then(function(e){t.moreCmdModal.model&&(t.moreCmdModal.model.configs=e)}).catch(function(e){t.$tip.error(t.$t("common.error")+": "+(e.err_msg||e.message))})},sendCommand:function(e,t,a){var r=this,o=this.$Loading.show();this.$ajax.getJSON("/server/api/send_command",{server_ids:e,command:t}).then(function(e){o.hide();var t=e[0].err_msg.replace(/\n/g,"<br>");if(0!==e[0].ret_code)throw new Error(t);var s={title:r.$t("common.success"),message:t};a&&(s.duration=0),r.$tip.success(s)}).catch(function(e){o.hide(),r.$tip.error({title:r.$t("common.error"),message:e.err_msg||e.message})})},invokeMoreCmd:function(){var e=this.moreCmdModal.model,t=this.moreCmdModal.currentServer;"undeploy_tars"===e.selected?this.undeployServer(t):"setloglevel"===e.selected?this.sendCommand(t.id,"tars.setloglevel "+e.setloglevel):"loadconfig"===e.selected&&this.$refs.moreCmdForm.validate()?this.sendCommand(t.id,"tars.loadconfig "+e.loadconfig):"command"===e.selected&&this.$refs.moreCmdForm.validate()?this.sendCommand(t.id,e.command):"connection"===e.selected&&this.sendCommand(t.id,"tars.connection",!0)},closeMoreCmdModal:function(){this.$refs.moreCmdForm&&this.$refs.moreCmdForm.resetValid(),this.moreCmdModal.unwatch&&this.moreCmdModal.unwatch(),this.moreCmdModal.show=!1,this.moreCmdModal.model=null},handleNoPublishedTime:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.$t("pub.dlg.unpublished");return"0000:00:00 00:00:00"===e?t:e}},created:function(){this.serverData=this.$parent.getServerData(),window.manage=this},mounted:function(){this.getServerList(),this.getServerNotifyList(1)}},F={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page_server_manage"},[e.serverList?a("let-table",{ref:"serverListLoading",attrs:{data:e.serverList,title:e.$t("serverList.title.serverList"),"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{title:e.$t("serverList.table.th.service"),prop:"server_name"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.ip"),prop:"node_name",width:"140px"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.enableSet")},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.enable_set?a("p",{staticStyle:{"max-width":"200px"}},[e._v("\n          "+e._s(e.$t("common.set.setName"))+"："+e._s(t.row.set_name)),a("br"),e._v("\n          "+e._s(e.$t("common.set.setArea"))+"："+e._s(t.row.set_area)),a("br"),e._v("\n          "+e._s(e.$t("common.set.setGroup"))+"："+e._s(t.row.set_group)+"\n        ")]):a("span",[e._v(e._s(e.$t("common.disable")))])]}}],null,!1,1670625483)}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.configStatus"),width:"90px"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("span",{class:"active"===e.row.setting_state?"status-active":"status-off"})]}}],null,!1,3224184510)}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.currStatus"),width:"65px"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("span",{class:"active"===e.row.present_state?"status-active":"activating"===e.row.present_state?"status-activating":"status-off"})]}}],null,!1,4116932289)}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.processID"),prop:"process_id",width:"80px"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.version"),prop:"patch_version",width:"68px"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.time")},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticStyle:{"word-break":"break-word"}},[e._v(e._s(e.handleNoPublishedTime(t.row.patch_time)))])]}}],null,!1,3144837894)}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("operate.operates"),width:"260px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-table-operation",{on:{click:function(a){return e.configServer(t.row.id)}}},[e._v(e._s(e.$t("operate.update")))]),e._v(" "),a("let-table-operation",{on:{click:function(a){return e.restartServer(t.row.id)}}},[e._v(e._s(e.$t("operate.restart")))]),e._v(" "),a("let-table-operation",{staticClass:"danger",on:{click:function(a){return e.stopServer(t.row.id)}}},[e._v(e._s(e.$t("operate.stop")))]),e._v(" "),a("let-table-operation",{on:{click:function(a){return e.manageServant(t.row)}}},[e._v(e._s(e.$t("operate.servant")))]),e._v(" "),a("let-table-operation",{on:{click:function(a){return e.showMoreCmd(t.row)}}},[e._v(e._s(e.$t("operate.more")))])]}}],null,!1,3478261854)})],1):e._e(),e._v(" "),e.serverNotifyList&&e.showOthers?a("let-table",{ref:"serverNotifyListLoading",attrs:{data:e.serverNotifyList,title:e.$t("serverList.title.serverStatus"),"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{title:e.$t("common.time"),prop:"notifytime"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.serviceID"),prop:"server_id"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.threadID"),prop:"thread_id"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.result"),prop:"result"}})],1):e._e(),e._v(" "),a("let-pagination",{staticStyle:{"margin-bottom":"32px"},attrs:{page:e.pageNum,total:e.total},on:{change:e.gotoPage}}),e._v(" "),a("let-modal",{attrs:{title:e.$t("serverList.dlg.title.editService"),width:"800px",footShow:!(!e.configModal.model||!e.configModal.model.server_name)},on:{"on-confirm":e.saveConfig,close:e.closeConfigModal,"on-cancel":e.closeConfigModal},model:{value:e.configModal.show,callback:function(t){e.$set(e.configModal,"show",t)},expression:"configModal.show"}},[e.configModal.model&&e.configModal.model.server_name?a("let-form",{ref:"configForm",staticClass:"two-columns",attrs:{itemWidth:"360px",columns:2}},[a("let-form-item",{attrs:{label:e.$t("common.service")}},[e._v(e._s(e.configModal.model.server_name))]),e._v(" "),a("let-form-item",{attrs:{label:e.$t("common.ip")}},[e._v(e._s(e.configModal.model.node_name))]),e._v(" "),a("let-form-item",{attrs:{label:e.$t("serverList.dlg.isBackup"),required:""}},[a("let-radio-group",{attrs:{size:"small",data:[{value:!0,text:e.$t("common.yes")},{value:!1,text:e.$t("common.no")}]},model:{value:e.configModal.model.bak_flag,callback:function(t){e.$set(e.configModal.model,"bak_flag",t)},expression:"configModal.model.bak_flag"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("common.template"),required:""}},[e.configModal.model.templates&&e.configModal.model.templates.length?a("let-select",{attrs:{size:"small",required:""},model:{value:e.configModal.model.template_name,callback:function(t){e.$set(e.configModal.model,"template_name",t)},expression:"configModal.model.template_name"}},e._l(e.configModal.model.templates,function(t){return a("let-option",{key:t,attrs:{value:t}},[e._v(e._s(t))])}),1):a("span",[e._v(e._s(e.configModal.model.template_name))])],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("serverList.dlg.serviceType"),required:""}},[a("let-select",{attrs:{size:"small",required:""},model:{value:e.configModal.model.server_type,callback:function(t){e.$set(e.configModal.model,"server_type",t)},expression:"configModal.model.server_type"}},e._l(e.serverTypes,function(t){return a("let-option",{key:t,attrs:{value:t}},[e._v(e._s(t))])}),1)],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("serverList.table.th.enableSet"),required:""}},[a("let-radio-group",{attrs:{size:"small",data:[{value:!0,text:e.$t("common.enable")},{value:!1,text:e.$t("common.disable")}]},model:{value:e.configModal.model.enable_set,callback:function(t){e.$set(e.configModal.model,"enable_set",t)},expression:"configModal.model.enable_set"}})],1),e._v(" "),e.configModal.model.enable_set?a("let-form-item",{attrs:{label:e.$t("common.set.setName"),required:""}},[a("let-input",{attrs:{size:"small",placeholder:e.$t("serverList.dlg.errMsg.setName"),required:"",pattern:"^[a-z]+$","pattern-tip":e.$t("serverList.dlg.errMsg.setName")},model:{value:e.configModal.model.set_name,callback:function(t){e.$set(e.configModal.model,"set_name",t)},expression:"configModal.model.set_name"}})],1):e._e(),e._v(" "),e.configModal.model.enable_set?a("let-form-item",{attrs:{label:e.$t("common.set.setArea"),required:""}},[a("let-input",{attrs:{size:"small",placeholder:e.$t("serverList.dlg.errMsg.setArea"),required:"",pattern:"^[a-z]+$","pattern-tip":e.$t("serverList.dlg.errMsg.setArea")},model:{value:e.configModal.model.set_area,callback:function(t){e.$set(e.configModal.model,"set_area",t)},expression:"configModal.model.set_area"}})],1):e._e(),e._v(" "),e.configModal.model.enable_set?a("let-form-item",{attrs:{label:e.$t("common.set.setGroup"),required:""}},[a("let-input",{attrs:{size:"small",placeholder:e.$t("serverList.dlg.errMsg.setGroup"),required:"",pattern:"^[0-9\\*]+$","pattern-tip":e.$t("serverList.dlg.errMsg.setGroup")},model:{value:e.configModal.model.set_group,callback:function(t){e.$set(e.configModal.model,"set_group",t)},expression:"configModal.model.set_group"}})],1):e._e(),e._v(" "),a("let-form-item",{attrs:{label:e.$t("serverList.dlg.asyncThread"),required:""}},[a("let-input",{attrs:{size:"small",placeholder:e.$t("serverList.dlg.placeholder.thread"),required:"",pattern:"tars_nodejs"===e.configModal.model.server_type?"^[1-9][0-9]*$":"^([3-9]|[1-9][0-9]+)$","pattern-tip":"$t('serverList.dlg.placeholder.thread')"},model:{value:e.configModal.model.async_thread_num,callback:function(t){e.$set(e.configModal.model,"async_thread_num",t)},expression:"configModal.model.async_thread_num"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("serverList.dlg.defaultPath")}},[a("let-input",{attrs:{size:"small"},model:{value:e.configModal.model.base_path,callback:function(t){e.$set(e.configModal.model,"base_path",t)},expression:"configModal.model.base_path"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("serverList.dlg.exePath")}},[a("let-input",{attrs:{size:"small"},model:{value:e.configModal.model.exe_path,callback:function(t){e.$set(e.configModal.model,"exe_path",t)},expression:"configModal.model.exe_path"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("serverList.dlg.startScript")}},[a("let-input",{attrs:{size:"small"},model:{value:e.configModal.model.start_script_path,callback:function(t){e.$set(e.configModal.model,"start_script_path",t)},expression:"configModal.model.start_script_path"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("serverList.dlg.stopScript")}},[a("let-input",{attrs:{size:"small"},model:{value:e.configModal.model.stop_script_path,callback:function(t){e.$set(e.configModal.model,"stop_script_path",t)},expression:"configModal.model.stop_script_path"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("serverList.dlg.monitorScript"),itemWidth:"724px"}},[a("let-input",{attrs:{size:"small"},model:{value:e.configModal.model.monitor_script_path,callback:function(t){e.$set(e.configModal.model,"monitor_script_path",t)},expression:"configModal.model.monitor_script_path"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("serverList.dlg.privateTemplate"),labelWidth:"150px",itemWidth:"724px"}},[a("let-input",{attrs:{size:"large",type:"textarea",rows:4},model:{value:e.configModal.model.profile,callback:function(t){e.$set(e.configModal.model,"profile",t)},expression:"configModal.model.profile"}})],1)],1):a("div",{ref:"configFormLoading",staticClass:"loading-placeholder"})],1),e._v(" "),a("let-modal",{attrs:{title:e.$t("serverList.table.servant.title"),width:"1200px",footShow:!1},on:{close:e.closeServantModal},model:{value:e.servantModal.show,callback:function(t){e.$set(e.servantModal,"show",t)},expression:"servantModal.show"}},[a("let-button",{staticClass:"tbm16",attrs:{size:"small",theme:"primary"},on:{click:function(t){return e.configServant()}}},[e._v(e._s(e.$t("operate.add"))+" Servant")]),e._v(" "),e.servantModal.model?a("let-table",{attrs:{data:e.servantModal.model,"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{title:e.$t("operate.servant"),prop:"servant"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.table.servant.adress"),prop:"endpoint"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.table.servant.thread"),prop:"thread_num"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.table.servant.maxConnecttions"),prop:"max_connections"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.table.servant.maxQueue"),prop:"queuecap"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.table.servant.timeout"),prop:"queuetimeout"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("operate.operates"),width:"90px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-table-operation",{on:{click:function(a){return e.configServant(t.row.id)}}},[e._v(e._s(e.$t("operate.update")))]),e._v(" "),a("let-table-operation",{staticClass:"danger",on:{click:function(a){return e.deleteServant(t.row.id)}}},[e._v(e._s(e.$t("operate.delete")))])]}}],null,!1,489266128)})],1):a("div",{ref:"servantModalLoading",staticClass:"loading-placeholder"})],1),e._v(" "),a("let-modal",{attrs:{title:e.servantDetailModal.isNew?e.$t("operate.title.add")+" Servant":e.$t("operate.title.update")+" Servant",width:"800px",footShow:!!e.servantDetailModal.model},on:{"on-confirm":e.saveServantDetail,close:e.closeServantDetailModal,"on-cancel":e.closeServantDetailModal},model:{value:e.servantDetailModal.show,callback:function(t){e.$set(e.servantDetailModal,"show",t)},expression:"servantDetailModal.show"}},[e.servantDetailModal.model?a("let-form",{ref:"servantDetailForm",staticClass:"two-columns",attrs:{itemWidth:"360px",columns:2}},[a("let-form-item",{attrs:{label:e.$t("serverList.servant.appService"),itemWidth:"724px"}},[a("span",[e._v(e._s(e.servantDetailModal.model.application)+"·"+e._s(e.servantDetailModal.model.server_name))])]),e._v(" "),a("let-form-item",{attrs:{label:e.$t("serverList.servant.objName"),required:""}},[a("let-input",{attrs:{size:"small",placeholder:e.$t("serverList.servant.c"),required:"",pattern:"^[A-Za-z]+$","pattern-tip":e.$t("serverList.servant.obj")},model:{value:e.servantDetailModal.model.obj_name,callback:function(t){e.$set(e.servantDetailModal.model,"obj_name",t)},expression:"servantDetailModal.model.obj_name"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("serverList.servant.numOfThread"),required:""}},[a("let-input",{attrs:{size:"small",placeholder:e.$t("serverList.servant.thread"),required:"",pattern:"^[1-9][0-9]*$","pattern-tip":e.$t("serverList.servant.thread")},model:{value:e.servantDetailModal.model.thread_num,callback:function(t){e.$set(e.servantDetailModal.model,"thread_num",t)},expression:"servantDetailModal.model.thread_num"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("serverList.table.servant.adress"),required:"",itemWidth:"724px"}},[a("let-input",{ref:"endpoint",attrs:{size:"small",placeholder:"tcp -h 127.0.0.1 -t 60000 -p 12000",required:"",extraTip:e.isEndpointValid?"":e.$t("serverList.servant.error")},model:{value:e.servantDetailModal.model.endpoint,callback:function(t){e.$set(e.servantDetailModal.model,"endpoint",t)},expression:"servantDetailModal.model.endpoint"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("serverList.servant.maxConnecttions"),labelWidth:"150px"}},[a("let-input",{attrs:{size:"small"},model:{value:e.servantDetailModal.model.max_connections,callback:function(t){e.$set(e.servantDetailModal.model,"max_connections",t)},expression:"servantDetailModal.model.max_connections"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("serverList.servant.lengthOfQueue"),labelWidth:"150px"}},[a("let-input",{attrs:{size:"small"},model:{value:e.servantDetailModal.model.queuecap,callback:function(t){e.$set(e.servantDetailModal.model,"queuecap",t)},expression:"servantDetailModal.model.queuecap"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("serverList.servant.queueTimeout"),labelWidth:"150px"}},[a("let-input",{attrs:{size:"small"},model:{value:e.servantDetailModal.model.queuetimeout,callback:function(t){e.$set(e.servantDetailModal.model,"queuetimeout",t)},expression:"servantDetailModal.model.queuetimeout"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("serverList.servant.allowIP")}},[a("let-input",{attrs:{size:"small"},model:{value:e.servantDetailModal.model.allow_ip,callback:function(t){e.$set(e.servantDetailModal.model,"allow_ip",t)},expression:"servantDetailModal.model.allow_ip"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("serverList.servant.protocol"),required:""}},[a("let-radio-group",{attrs:{size:"small",data:[{value:"tars",text:"TARS"},{value:"not_tars",text:e.$t("serverList.servant.notTARS")}]},model:{value:e.servantDetailModal.model.protocol,callback:function(t){e.$set(e.servantDetailModal.model,"protocol",t)},expression:"servantDetailModal.model.protocol"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("serverList.servant.treatmentGroup"),labelWidth:"150px"}},[a("let-input",{attrs:{size:"small"},model:{value:e.servantDetailModal.model.handlegroup,callback:function(t){e.$set(e.servantDetailModal.model,"handlegroup",t)},expression:"servantDetailModal.model.handlegroup"}})],1)],1):e._e()],1),e._v(" "),a("let-modal",{staticClass:"more-cmd",attrs:{title:e.$t("operate.title.more"),width:"700px"},on:{"on-confirm":e.invokeMoreCmd,close:e.closeMoreCmdModal,"on-cancel":e.closeMoreCmdModal},model:{value:e.moreCmdModal.show,callback:function(t){e.$set(e.moreCmdModal,"show",t)},expression:"moreCmdModal.show"}},[e.moreCmdModal.model?a("let-form",{ref:"moreCmdForm"},[a("let-form-item",{attrs:{itemWidth:"100%"}},[a("let-radio",{attrs:{label:"setloglevel"},model:{value:e.moreCmdModal.model.selected,callback:function(t){e.$set(e.moreCmdModal.model,"selected",t)},expression:"moreCmdModal.model.selected"}},[e._v(e._s(e.$t("serverList.servant.logLevel")))]),e._v(" "),a("let-select",{attrs:{size:"small",disabled:"setloglevel"!==e.moreCmdModal.model.selected},model:{value:e.moreCmdModal.model.setloglevel,callback:function(t){e.$set(e.moreCmdModal.model,"setloglevel",t)},expression:"moreCmdModal.model.setloglevel"}},e._l(e.logLevels,function(t){return a("let-option",{key:t,attrs:{value:t}},[e._v(e._s(t))])}),1)],1),e._v(" "),a("let-form-item",{attrs:{itemWidth:"100%"}},[a("let-radio",{attrs:{label:"loadconfig"},model:{value:e.moreCmdModal.model.selected,callback:function(t){e.$set(e.moreCmdModal.model,"selected",t)},expression:"moreCmdModal.model.selected"}},[e._v(e._s(e.$t("serverList.servant.pushFile")))]),e._v(" "),a("let-select",{attrs:{size:"small",placeholder:e.moreCmdModal.model.configs&&e.moreCmdModal.model.configs.length?e.$t("pub.dlg.defaultValue"):e.$t("pub.dlg.noConfFile"),disabled:!(e.moreCmdModal.model.configs&&e.moreCmdModal.model.configs.length)||"loadconfig"!==e.moreCmdModal.model.selected,required:"loadconfig"===e.moreCmdModal.model.selected},model:{value:e.moreCmdModal.model.loadconfig,callback:function(t){e.$set(e.moreCmdModal.model,"loadconfig",t)},expression:"moreCmdModal.model.loadconfig"}},e._l(e.moreCmdModal.model.configs,function(t){return a("let-option",{key:t.filename,attrs:{value:t.filename}},[e._v(e._s(t.filename))])}),1)],1),e._v(" "),a("let-form-item",{attrs:{itemWidth:"100%"}},[a("let-radio",{attrs:{label:"command"},model:{value:e.moreCmdModal.model.selected,callback:function(t){e.$set(e.moreCmdModal.model,"selected",t)},expression:"moreCmdModal.model.selected"}},[e._v(e._s(e.$t("serverList.servant.sendCommand")))]),e._v(" "),a("let-input",{attrs:{size:"small",disabled:"command"!==e.moreCmdModal.model.selected,required:"command"===e.moreCmdModal.model.selected},model:{value:e.moreCmdModal.model.command,callback:function(t){e.$set(e.moreCmdModal.model,"command",t)},expression:"moreCmdModal.model.command"}})],1),e._v(" "),a("let-form-item",{attrs:{itemWidth:"100%"}},[a("let-radio",{attrs:{label:"connection"},model:{value:e.moreCmdModal.model.selected,callback:function(t){e.$set(e.moreCmdModal.model,"selected",t)},expression:"moreCmdModal.model.selected"}},[e._v(e._s(e.$t("serverList.servant.serviceLink")))])],1),e._v(" "),a("let-form-item",{attrs:{itemWidth:"100%"}},[a("let-radio",{staticClass:"danger",attrs:{label:"undeploy_tars"},model:{value:e.moreCmdModal.model.selected,callback:function(t){e.$set(e.moreCmdModal.model,"selected",t)},expression:"moreCmdModal.model.selected"}},[e._v(e._s(e.$t("operate.undeploy"))+" "+e._s(e.$t("common.service")))])],1)],1):e._e()],1)],1)},staticRenderFns:[]};var T=a("VU/8")(A,F,!1,function(e){a("hrXV")},null,null).exports,q=a("lHA8"),P=a.n(q),R=a("c/Tr"),O=a.n(R),I=a("dZBD"),j=a.n(I),z=a("mw3O"),E=a.n(z),V=j.a.create({baseURL:"/pages/server/api",timeout:25e3,transformRequest:[function(e,t){return"multipart/form-data"===t["Content-Type"]?e:E.a.stringify(e)}]});V.interceptors.request.use(function(e){return e},function(e){throw new Error(e)}),V.interceptors.response.use(function(e){var t=e.data;if(200===t.ret_code)return t.data;throw new Error(t.err_msg)},function(e){throw new Error(e)});var W=V;function J(e){var t=e.servers,a=e.appName,r=e.moduleName,o=e.type,s=void 0===o?"expand":o,l=e.status,i=void 0===l?"1":l,n=e.cache_version;e.srcGroupName,e.dstGroupName;return W({method:"post",url:"/cache/expandModule",data:{appName:a,moduleName:r,servers:t,type:s,status:i,cache_version:n}})}function U(e){var t=e.appName,a=e.moduleName,r=e.type,o=void 0===r?"1":r,s=e.srcGroupName,l=void 0===s?[]:s,i=e.dstGroupName;return W({method:"post",url:"/cache/configTransfer",data:{appName:t,moduleName:a,type:o,srcGroupName:l,dstGroupName:void 0===i?[]:i}})}function B(e){var t=e.appName,a=e.moduleName,r=e.type;return W({method:"get",url:"/cache/hasOperation",params:{appName:t,moduleName:a,type:r}})}function G(e){var t=e.appName,a=void 0===t?"":t,r=e.moduleName,o=void 0===r?"":r,s=e.type,l=void 0===s?"1":s,i=e.srcGroupName,n=void 0===i?[]:i,c=e.dstGroupName;return W({method:"post",url:"/cache/stopTransfer",data:{appName:a,moduleName:o,type:l,srcGroupName:n,dstGroupName:void 0===c?[]:c}})}function H(e){var t=e.appName,a=void 0===t?"":t,r=e.moduleName,o=void 0===r?"":r,s=e.type,l=void 0===s?"1":s,i=e.srcGroupName,n=void 0===i?[]:i,c=e.dstGroupName;return W({method:"post",url:"/cache/deleteTransfer",data:{appName:a,moduleName:o,type:l,srcGroupName:n,dstGroupName:void 0===c?[]:c}})}var Z={props:{releaseId:{type:Number,required:!0}},data:function(){return{releaseProgress:[],timer:"",progressTip:"",success:!1}},methods:{getProgress:function(){var e=this;return N()(L.a.mark(function t(){var a,r,o;return L.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,s={releaseId:e.releaseId},void 0,l=s.releaseId,W({method:"get",url:"/cache/getReleaseProgress",params:{releaseId:l}});case 3:a=t.sent,r=a.percent,o=a.progress,e.releaseProgress=o,100!=+r?e.timer=window.setTimeout(e.getProgress,1e3):(e.timer&&window.clearTimeout(e.timer),e.success=!0,e.$emit("done-fn")),t.next=14;break;case 10:t.prev=10,t.t0=t.catch(0),console.error(t.t0),e.$tip.error(t.t0.message);case 14:case"end":return t.stop()}var s,l},t,e,[[0,10]])}))()}},created:function(){this.getProgress()},destroyed:function(){this.timer&&window.clearTimeout(this.timer)}},K={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"progressTable"},[a("let-table",{ref:"ProgressTable",attrs:{data:e.releaseProgress,"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{title:e.$t("service.serverName"),prop:"serverName",width:"30%"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("service.serverIp"),prop:"nodeName",width:"30%"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("publishLog.releaseId"),prop:"releaseId",width:"15%"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("publishLog.releaseProgress"),prop:"percent"}})],1),e._v(" "),a("p",{ref:"progressTip"},[e._v(e._s(e.success?"发布完成":"发布中..."))])],1)},staticRenderFns:[]};var Y={components:{ReleaseProgress:a("VU/8")(Z,K,!1,function(e){a("uKo1")},"data-v-72d665f3",null).exports},props:{expandServers:{required:!0,type:Array}},data:function(){return{servers:[],releaseId:"",releasing:!1,abc:!0}},computed:{appName:function(){return this.expandServers[0].app_name},moduleName:function(){return this.expandServers[0].module_name},cache_version:function(){return this.expandServers[0].cache_version},groupName:function(){return this.servers[0].group_name}},methods:{submitServerConfig:function(){var e=this;return N()(L.a.mark(function t(){var a,r,o,s,l,i,n;return L.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.$refs.detailForm.validate()){t.next=16;break}return a=e.servers,r=e.appName,o=e.moduleName,s=e.cache_version,l=e.groupName,t.prev=2,t.next=5,J({servers:a,appName:r,moduleName:o,cache_version:s,srcGroupName:[],dstGroupName:[l]});case 5:i=t.sent,n=i.releaseId,e.releaseId=n,e.$tip.success(e.$t("dcache.operationManage.hasExpand")),e.$emit("close"),t.next=16;break;case 12:t.prev=12,t.t0=t.catch(2),console.error(t.t0),e.$tip.error(t.t0.message);case 16:case"end":return t.stop()}},t,e,[[2,12]])}))()},getServers:function(){var e=this.expandServers.map(function(e,t){var a=e.group_name,r=e.server_name;return a=a.replace(/^(.*?)(\d+)$/,function(){return arguments[1]+(+arguments[2]+1)}),r=r.replace(/^(.*?)(\d+)-\d+$/,function(){return arguments[1]+(+arguments[2]+1)+"-"+(t+1)}),g()({},e,{group_name:a,server_name:r,server_ip:"",shmKey:""})});this.servers=e},mapServerType:function(e){return 0===e?this.$t("module.mainServer"):1===e?this.$t("module.backServer"):this.$t("module.mirror")},releaseSuccess:function(){var e=this;return N()(L.a.mark(function t(){var a,r,o,s;return L.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.appName,r=e.moduleName,o=e.groupName,t.prev=1,s={appName:a,moduleName:r,type:"1",srcGroupName:[],dstGroupName:[o]},t.next=5,U(s);case 5:t.sent,t.next=12;break;case 8:t.prev=8,t.t0=t.catch(1),console.error(t.t0),e.$tip.error(t.t0.message);case 12:case"end":return t.stop()}},t,e,[[1,8]])}))()}},created:function(){this.getServers()}},X={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"container"},[a("let-form",{ref:"detailForm",attrs:{inline:""}},[a("let-form-group",{attrs:{inline:"","label-position":"top"}},[a("let-table",{ref:"table",attrs:{data:e.servers,"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{title:e.$t("module.name"),prop:"module_name"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n            "+e._s(a.module_name)+"\n          ")]}}])}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("module.serverGroup"),prop:"group_name"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n            "+e._s(a.group_name)+"\n          ")]}}])}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("service.serverName"),prop:"server_name"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n            "+e._s(a.server_name)+"\n          ")]}}])}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("service.serverIp"),prop:"server_ip"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-input",{attrs:{size:"small",required:"","required-tip":e.$t("deployService.table.tips.empty")},model:{value:t.row.server_ip,callback:function(a){e.$set(t.row,"server_ip",a)},expression:"scope.row.server_ip"}})]}}])}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("module.deployArea"),prop:"area"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n            "+e._s(a.area)+"\n          ")]}}])}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("deployService.form.serviceType"),prop:"server_type"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n            "+e._s(e.mapServerType(a.server_type))+"\n          ")]}}])}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("module.memorySize"),prop:"memory"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n            "+e._s(a.memory)+"\n          ")]}}])}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("module.shmKey"),prop:"shmKey"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-input",{attrs:{size:"small",placeholder:e.$t("module.shmKeyRule"),required:"","required-tip":e.$t("deployService.table.tips.empty")},model:{value:t.row.shmKey,callback:function(a){e.$set(t.row,"shmKey",a)},expression:"scope.row.shmKey"}})]}}])})],1)],1),e._v(" "),a("div",[a("let-button",{attrs:{size:"small",theme:"primary"},on:{click:e.submitServerConfig}},[e._v(e._s(e.$t("common.submit")))])],1)],1)],1)},staticRenderFns:[]};var Q={components:{Expand:a("VU/8")(Y,X,!1,function(e){a("eo2X")},null,null).exports},name:"ServerManage",data:function(){return{expandShow:!1,releaseing:!0,lastGroupServers:[],isCheckedAll:!1,serverData:{level:5,application:"",server_name:"",set_name:"",set_area:"",set_group:""},serverList:[],serverNotifyList:[],pageNum:1,pageSize:20,total:1,serverTypes:["tars_cpp","tars_java","tars_php","tars_nodejs","not_tars","tars_go"],configModal:{show:!1,model:null},servantModal:{show:!1,model:null,currentServer:null},servantDetailModal:{show:!1,isNew:!0,model:null},logLevels:["NONE","DEBUG","INFO","WARN","ERROR"],moreCmdModal:{show:!1,model:null,currentServer:null},failCount:0}},computed:{showOthers:function(){return 5===this.serverData.level},isEndpointValid:function(){return!(!this.servantDetailModal.model||!this.servantDetailModal.model.endpoint)&&this.checkServantEndpoint(this.servantDetailModal.model.endpoint)},hasCheckedItem:function(){return 0!==this.serverList.filter(function(e){return!0===e.isChecked}).length}},watch:{isCheckedAll:function(){var e=this.isCheckedAll;this.serverList.forEach(function(t){t.isChecked=e})}},methods:{expandHandler:function(){var e=this;return N()(L.a.mark(function t(){var a,r,o;return L.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e.checkPatchVersion()){t.next=4;break}throw new Error(e.$t("dcache.noTheSamePatchVersion"));case 4:return a=e.serverList[0],r=a.app_name,o=a.module_name,t.next=8,B({appName:r,moduleName:o});case 8:if(!t.sent){t.next=11;break}throw new Error(e.$t("dcache.hasExpandOperation"));case 11:e.lastGroupServers=e.getLastGroupServers(),e.expandShow=!0,t.next=19;break;case 15:t.prev=15,t.t0=t.catch(0),console.error(t.t0),e.$tip.error(t.t0.message);case 19:case"end":return t.stop()}},t,e,[[0,15]])}))()},shrinkageHandler:function(){var e=this;return N()(L.a.mark(function t(){var a,r,o,s,l,i;return L.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a=e.serverList[0],r=a.app_name,o=a.module_name,t.next=5,B({appName:r,moduleName:o});case 5:if(!t.sent){t.next=8;break}throw new Error(e.$t("dcache.hasShrinkageOperation"));case 8:if(s=e.serverList.map(function(e){return e.group_name}),s=O()(new P.a(s)),l=e.serverList.filter(function(e){return e.isChecked}),i=l.map(function(e){return e.group_name}),i=O()(new P.a(i)),s.toString()!==i.toString()){t.next=15;break}throw new Error(e.$t("dcache.leaveOneServiceGroup"));case 15:return t.next=17,e.$confirm(e.$t("dcache.operationManage.ensureShrinkage"));case 17:return t.next=19,void 0,void 0,void 0,void 0,void 0,c=(n={appName:r,moduleName:o,srcGroupName:i}).appName,d=void 0===c?"":c,u=n.moduleName,m=void 0===u?"":u,p=n.srcGroupName,W({method:"post",url:"/cache/reduceDcache",data:{appName:d,moduleName:m,srcGroupName:void 0===p?[]:p}});case 19:e.$tip.success(e.$t("dcache.operationManage.hasShrinkage")),t.next=26;break;case 22:t.prev=22,t.t0=t.catch(0),console.error(t.t0),e.$tip.error(t.t0.message);case 26:case"end":return t.stop()}var n,c,d,u,m,p},t,e,[[0,22]])}))()},switchHandler:function(){var e=this;return N()(L.a.mark(function t(){var a,r,o,s,l;return L.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,a=e.serverList[0],r=a.app_name,o=a.module_name,s=e.serverList.filter(function(e){return e.isChecked}),l=s.map(function(e){return e.group_name}),1==(l=O()(new P.a(l))).length){t.next=8;break}throw new Error(e.$t("dcache.operationManage.onceSwitch"));case 8:return t.next=10,e.$confirm(e.$t("dcache.operationManage.ensureSwitch"));case 10:return t.next=12,i={appName:r,moduleName:o,groupName:l[0]},void 0,void 0,void 0,void 0,void 0,n=i.appName,c=void 0===n?"":n,d=i.moduleName,u=void 0===d?"":d,m=i.groupName,W({method:"post",url:"/cache/switchServer",data:{appName:c,moduleName:u,groupName:void 0===m?"":m}});case 12:e.$tip.success(e.$t("dcache.operationManage.switchSuccess")),e.getServerList(),t.next=20;break;case 16:t.prev=16,t.t0=t.catch(0),console.error(t.t0),e.$tip.error(t.t0.message);case 20:case"end":return t.stop()}var i,n,c,d,u,m},t,e,[[0,16]])}))()},getLastGroupServers:function(){var e=this.serverList[this.serverList.length-1].group_name;return this.serverList.filter(function(t){return t.group_name===e})},checkPatchVersion:function(){var e=!0,t={};return this.serverList.forEach(function(a,r){var o=a.patch_version;if(0===r)return t[o]=o;t[o]||(e=!1)}),e},checkedAllChange:function(){console.log(arguments)},getServerList:function(){var e=this,t=this.$refs.serverListLoading.$loading.show();this.$ajax.getJSON("/server/api/get_cache_server_list",{tree_node_id:this.$route.params.treeid.substr(1)}).then(function(a){t.hide(),a.forEach(function(e){return e.isChecked=!1}),e.serverList=a}).catch(function(a){t.hide(),e.$confirm(a.err_msg||a.message||e.$t("serverList.msg.fail"),e.$t("common.alert")).then(function(){e.getServerList()})})},getServerNotifyList:function(e){var t=this;if(this.showOthers){var a=this.$refs.serverNotifyListLoading.$loading.show();this.$ajax.getJSON("/server/api/server_notify_list",{tree_node_id:this.$route.params.treeid,page_size:this.pageSize,curr_page:e}).then(function(r){a.hide(),t.pageNum=e,t.total=Math.ceil(r.count/t.pageSize),t.serverNotifyList=r.rows}).catch(function(e){a.hide(),t.$tip.error(t.$t("serverList.restart.failed")+": "+(e.err_msg||e.message))})}},getTemplateList:function(){var e=this;this.$ajax.getJSON("/server/api/template_name_list").then(function(t){e.configModal.model?e.configModal.model.templates=t:e.configModal.model={templates:t}}).catch(function(t){e.$tip.error(e.$t("serverList.restart.failed")+": "+(t.err_msg||t.message))})},getServerConfig:function(e){var t=this,a=this.$loading.show({target:this.$refs.configFormLoading});this.$ajax.getJSON("/server/api/server",{id:e}).then(function(e){a.hide(),t.configModal.model?t.configModal.model=g()({},t.configModal.model,e):(e.templates=[],t.configModal.model=e)}).catch(function(e){a.hide(),t.closeConfigModal(),t.$tip.error(t.$t("serverList.restart.failed")+": "+(e.err_msg||e.message))})},configServer:function(e){this.configModal.show=!0,this.getTemplateList(),this.getServerConfig(e)},saveConfig:function(){var e=this;if(this.$refs.configForm.validate()){var t=this.$Loading.show();this.$ajax.postJSON("/server/api/update_server",C()({isBak:this.configModal.model.bak_flag},this.configModal.model)).then(function(a){t.hide(),e.serverList=e.serverList.map(function(e){return e.id===a.id?a:e}),e.closeConfigModal(),e.$tip.success(e.$t("serverList.restart.success"))}).catch(function(a){t.hide(),e.$tip.error(e.$t("serverList.restart.failed")+": "+(a.message||a.err_msg))})}},closeConfigModal:function(){this.$refs.configForm&&this.$refs.configForm.resetValid(),this.configModal.show=!1,this.configModal.model=null},checkTaskStatus:function(e,t){var a=this;return new k.a(function(r,o){a.$ajax.getJSON("/server/api/task",{task_no:e}).then(function(t){1===t.status||0===t.status?setTimeout(function(){r(a.checkTaskStatus(e))},3e3):2===t.status?r("taskid: "+t.task_no):o(new Error("taskid: "+t.task_no))}).catch(function(s){t?o(new Error(s.err_msg||s.message||a.$t("common.networkErr"))):setTimeout(function(){r(a.checkTaskStatus(e,!0))},3e3)})})},addTask:function(e,t,a){var r=this,o=this.$Loading.show();this.$ajax.postJSON("/server/api/add_task",{serial:!0,items:[{server_id:e,command:t}]}).then(function(e){return r.checkTaskStatus(e).then(function(e){o.hide(),r.getServerList(),r.$tip.success({title:a.success,message:e})}).catch(function(e){throw e})}).catch(function(e){o.hide(),r.getServerList(),r.$tip.error({title:a.error,message:e.err_msg||e.message||r.$t("common.networkErr")})})},restartServer:function(e){this.addTask(e,"restart",{success:this.$t("serverList.restart.success"),error:this.$t("serverList.restart.failed")})},stopServer:function(e){var t=this;this.$confirm(this.$t("serverList.stopService.msg.stopService"),this.$t("common.alert")).then(function(){t.addTask(e,"stop",{success:t.$t("serverList.restart.success"),error:t.$t("serverList.restart.failed")})})},undeployServer:function(e){var t=this;this.$confirm(this.$t("serverList.dlg.msg.undeploy"),this.$t("common.alert")).then(function(){t.addTask(e,"undeploy_tars",{success:t.$t("serverList.restart.success"),error:t.$t("serverList.restart.failed")}),t.closeMoreCmdModal()})},manageServant:function(e){var t=this;this.servantModal.show=!0;var a=this.$loading.show({target:this.$refs.servantModalLoading});this.$ajax.getJSON("/server/api/adapter_conf_list",{id:e.id}).then(function(r){a.hide(),t.servantModal.model=r,t.servantModal.currentServer=e}).catch(function(e){a.hide(),t.$tip.error(t.$t("serverList.restart.failed")+": "+(e.err_msg||e.message))})},closeServantModal:function(){this.servantModal.show=!1,this.servantModal.model=null,this.servantModal.currentServer=null},configServant:function(e){if(this.servantDetailModal.model={application:this.servantModal.currentServer.application,server_name:this.servantModal.currentServer.server_name,obj_name:"",node_name:"",endpoint:"",servant:"",thread_num:"",max_connections:"200000",queuecap:"10000",queuetimeout:"60000",allow_ip:"",protocol:"not_tars",handlegroup:""},this.servantDetailModal.isNew=!0,e){var t=this.servantModal.model.find(function(t){return t.id===e});t.obj_name=t.servant.split(".")[2],this.servantDetailModal.model=g()({},this.servantDetailModal.model,t),this.servantDetailModal.isNew=!1}this.servantDetailModal.show=!0},closeServantDetailModal:function(){this.$refs.servantDetailForm&&this.$refs.servantDetailForm.resetValid(),this.servantDetailModal.show=!1,this.servantDetailModal.model=null},checkServantEndpoint:function(e){var t=e.split(/\s-/),a=/^h\s(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/i,r=/^t\s([1-9]|[1-9]\d+)$/i,o=/^p\s\d{4,5}$/i,s=!0;if(/^tcp|udp$/i.test(t[0])){for(var l=0,i=1;i<t.length;i++)if(a&&a.test(t[i])&&(l++,this.servantDetailModal.model.node_name=t[i].split(/\s/)[1],a=null),r&&r.test(t[i])&&(l++,r=null),o&&o.test(t[i])){var n=t[i].substring(2);n<0||n>65535||l++,o=null}s=3===l}else s=!1;return s},saveServantDetail:function(){var e=this;if(this.$refs.servantDetailForm.validate()){var t=this.$Loading.show();if(this.servantDetailModal.isNew){var a=this.servantDetailModal.model;a.servant=[a.application,a.server_name,a.obj_name].join("."),this.$ajax.postJSON("/server/api/add_adapter_conf",a).then(function(a){t.hide(),e.servantModal.model.unshift(a),e.$tip.success(e.$t("common.success")),e.closeServantDetailModal()}).catch(function(a){t.hide(),e.$tip.error(e.$t("common.error")+": "+(a.err_msg||a.message))})}else this.servantDetailModal.model.servant=this.servantDetailModal.model.application+"."+this.servantDetailModal.model.server_name+"."+this.servantDetailModal.model.obj_name,this.$ajax.postJSON("/server/api/update_adapter_conf",this.servantDetailModal.model).then(function(a){t.hide(),e.servantModal.model=e.servantModal.model.map(function(e){return e.id===a.id?a:e}),e.$tip.success(e.$t("common.success")),e.closeServantDetailModal()}).catch(function(a){t.hide(),e.$tip.error(e.$t("common.error")+": "+(a.err_msg||a.message))})}},deleteServant:function(e){var t=this;this.$confirm(this.$t("serverList.servant.a"),this.$t("common.alert")).then(function(){var a=t.$Loading.show();t.$ajax.getJSON("/server/api/delete_adapter_conf",{id:e}).then(function(r){a.hide(),t.servantModal.model=t.servantModal.model.map(function(t){if(t.id!==e)return t}).filter(function(e){return e}),t.$tip.success(t.$t("common.success"))}).catch(function(e){a.hide(),t.$tip.error(t.$t("common.error")+": "+(e.err_msg||e.message))})})},showMoreCmd:function(e){var t=this;this.moreCmdModal.model={selected:"setloglevel",setloglevel:"NONE",loadconfig:"",command:"",configs:null},this.moreCmdModal.unwatch=this.$watch("moreCmdModal.model.selected",function(){t.$refs.moreCmdForm&&t.$refs.moreCmdForm.resetValid()}),this.moreCmdModal.show=!0,this.moreCmdModal.currentServer=e,this.$ajax.getJSON("/server/api/config_file_list",{level:5,application:e.application,server_name:e.server_name}).then(function(e){t.moreCmdModal.model&&(t.moreCmdModal.model.configs=e)}).catch(function(e){t.$tip.error(t.$t("common.error")+": "+(e.err_msg||e.message))})},sendCommand:function(e,t,a){var r=this,o=this.$Loading.show();this.$ajax.getJSON("/server/api/send_command",{server_ids:e,command:t}).then(function(e){o.hide();var t=e[0].err_msg.replace(/\n/g,"<br>");if(0!==e[0].ret_code)throw new Error(t);var s={title:r.$t("common.success"),message:t};a&&(s.duration=0),r.$tip.success(s)}).catch(function(e){o.hide(),r.$tip.error({title:r.$t("common.error"),message:e.err_msg||e.message})})},invokeMoreCmd:function(){var e=this.moreCmdModal.model,t=this.moreCmdModal.currentServer;"undeploy_tars"===e.selected?this.undeployServer(t.id):"setloglevel"===e.selected?this.sendCommand(t.id,"tars.setloglevel "+e.setloglevel):"loadconfig"===e.selected&&this.$refs.moreCmdForm.validate()?this.sendCommand(t.id,"tars.loadconfig "+e.loadconfig):"command"===e.selected&&this.$refs.moreCmdForm.validate()?this.sendCommand(t.id,e.command):"connection"===e.selected&&this.sendCommand(t.id,"tars.connection",!0)},closeMoreCmdModal:function(){this.$refs.moreCmdForm&&this.$refs.moreCmdForm.resetValid(),this.moreCmdModal.unwatch&&this.moreCmdModal.unwatch(),this.moreCmdModal.show=!1,this.moreCmdModal.model=null},handleNoPublishedTime:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.$t("pub.dlg.unpublished");return"0000:00:00 00:00:00"===e?t:e}},created:function(){this.serverData=this.$parent.getServerData()},mounted:function(){this.getServerList(),this.getServerNotifyList(1)}},ee={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page_server_manage"},[e.serverList?a("let-table",{ref:"serverListLoading",attrs:{data:e.serverList,title:e.$t("serverList.title.serverList"),"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{scopedSlots:e._u([{key:"head",fn:function(t){return[a("let-checkbox",{attrs:{value:e.isCheckedAll,change:e.checkedAllChange},model:{value:e.isCheckedAll,callback:function(t){e.isCheckedAll=t},expression:"isCheckedAll"}})]}},{key:"default",fn:function(t){return[a("let-checkbox",{attrs:{value:t.row.id},model:{value:t.row.isChecked,callback:function(a){e.$set(t.row,"isChecked",a)},expression:"scope.row.isChecked"}})]}}],null,!1,2423312602)}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.group"),prop:"group_name"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row.group_name;return[e._v(e._s(/.*?(\d+)$/.exec(a)[1]))]}}],null,!1,1174827465)}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.service"),prop:"server_name"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.ip"),prop:"node_name",width:"140px"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.zb"),width:"140px"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row.server_type;return[0===r?a("span",[e._v(e._s(e.$t("cache.mainEngine")))]):1===r?a("span",[e._v(e._s(e.$t("cache.standByEngine")))]):2===r?a("span",[e._v(e._s(e.$t("cache.mirror")))]):e._e()]}}],null,!1,205204667)}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.enableSet")},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.enable_set?a("p",{staticStyle:{"max-width":"200px"}},[e._v("\n          "+e._s(e.$t("common.set.setName"))+"："+e._s(t.row.set_name)),a("br"),e._v("\n          "+e._s(e.$t("common.set.setArea"))+"："+e._s(t.row.set_area)),a("br"),e._v("\n          "+e._s(e.$t("common.set.setGroup"))+"："+e._s(t.row.set_group)+"\n        ")]):a("span",[e._v(e._s(e.$t("common.disable")))])]}}],null,!1,1670625483)}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.configStatus"),width:"90px"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("span",{class:"active"===e.row.setting_state?"status-active":"status-off"})]}}],null,!1,3224184510)}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.currStatus"),width:"65px"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("span",{class:"active"===e.row.present_state?"status-active":"activating"===e.row.present_state?"status-activating":"status-off"})]}}],null,!1,4116932289)}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.processID"),prop:"process_id",width:"80px"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.version"),prop:"patch_version",width:"68px"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.time")},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticStyle:{"word-break":"break-word"}},[e._v(e._s(e.handleNoPublishedTime(t.row.patch_time)))])]}}],null,!1,3144837894)}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("operate.operates"),width:"260px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-table-operation",{on:{click:function(a){return e.configServer(t.row.id)}}},[e._v(e._s(e.$t("operate.update")))]),e._v(" "),a("let-table-operation",{on:{click:function(a){return e.restartServer(t.row.id)}}},[e._v(e._s(e.$t("operate.restart")))]),e._v(" "),a("let-table-operation",{staticClass:"danger",on:{click:function(a){return e.stopServer(t.row.id)}}},[e._v(e._s(e.$t("operate.stop"))+"\n        ")]),e._v(" "),a("let-table-operation",{on:{click:function(a){return e.manageServant(t.row)}}},[e._v(e._s(e.$t("operate.servant")))]),e._v(" "),a("let-table-operation",{on:{click:function(a){return e.showMoreCmd(t.row)}}},[e._v(e._s(e.$t("operate.more")))])]}}],null,!1,3143139527)}),e._v(" "),a("template",{slot:"operations"},[a("let-button",{attrs:{theme:"primary"},on:{click:e.expandHandler}},[e._v(e._s(e.$t("dcache.expand")))]),e._v(" "),a("let-button",{attrs:{theme:"primary",disabled:!e.hasCheckedItem},on:{click:e.shrinkageHandler}},[e._v(e._s(e.$t("dcache.Shrinkage"))+"\n      ")]),e._v(" "),a("let-button",{attrs:{theme:"primary",disabled:!e.hasCheckedItem},on:{click:function(e){}}},[e._v(e._s(e.$t("dcache.Migration")))]),e._v(" "),a("let-button",{attrs:{theme:"primary",disabled:!e.hasCheckedItem},on:{click:e.switchHandler}},[e._v(e._s(e.$t("dcache.switch")))])],1)],2):e._e(),e._v(" "),e.serverNotifyList&&e.showOthers?a("let-table",{ref:"serverNotifyListLoading",attrs:{data:e.serverNotifyList,title:e.$t("serverList.title.serverStatus"),"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{title:e.$t("common.time"),prop:"notifytime"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.serviceID"),prop:"server_id"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.threadID"),prop:"thread_id"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.result"),prop:"result"}})],1):e._e(),e._v(" "),a("let-modal",{attrs:{title:e.$t("serverList.dlg.title.editService"),width:"800px",footShow:!(!e.configModal.model||!e.configModal.model.server_name)},on:{"on-confirm":e.saveConfig,close:e.closeConfigModal,"on-cancel":e.closeConfigModal},model:{value:e.configModal.show,callback:function(t){e.$set(e.configModal,"show",t)},expression:"configModal.show"}},[e.configModal.model&&e.configModal.model.server_name?a("let-form",{ref:"configForm",staticClass:"two-columns",attrs:{itemWidth:"360px",columns:2}},[a("let-form-item",{attrs:{label:e.$t("common.service")}},[e._v(e._s(e.configModal.model.server_name))]),e._v(" "),a("let-form-item",{attrs:{label:e.$t("common.ip")}},[e._v(e._s(e.configModal.model.node_name))]),e._v(" "),a("let-form-item",{attrs:{label:e.$t("serverList.dlg.isBackup"),required:""}},[a("let-radio-group",{attrs:{size:"small",data:[{value:!0,text:e.$t("common.yes")},{value:!1,text:e.$t("common.no")}]},model:{value:e.configModal.model.bak_flag,callback:function(t){e.$set(e.configModal.model,"bak_flag",t)},expression:"configModal.model.bak_flag"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("common.template"),required:""}},[e.configModal.model.templates&&e.configModal.model.templates.length?a("let-select",{attrs:{size:"small",required:""},model:{value:e.configModal.model.template_name,callback:function(t){e.$set(e.configModal.model,"template_name",t)},expression:"configModal.model.template_name"}},e._l(e.configModal.model.templates,function(t){return a("let-option",{key:t,attrs:{value:t}},[e._v(e._s(t))])}),1):a("span",[e._v(e._s(e.configModal.model.template_name))])],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("serverList.dlg.serviceType"),required:""}},[a("let-select",{attrs:{size:"small",required:""},model:{value:e.configModal.model.server_type,callback:function(t){e.$set(e.configModal.model,"server_type",t)},expression:"configModal.model.server_type"}},e._l(e.serverTypes,function(t){return a("let-option",{key:t,attrs:{value:t}},[e._v(e._s(t))])}),1)],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("serverList.table.th.enableSet"),required:""}},[a("let-radio-group",{attrs:{size:"small",data:[{value:!0,text:e.$t("common.enable")},{value:!1,text:e.$t("common.disable")}]},model:{value:e.configModal.model.enable_set,callback:function(t){e.$set(e.configModal.model,"enable_set",t)},expression:"configModal.model.enable_set"}})],1),e._v(" "),e.configModal.model.enable_set?a("let-form-item",{attrs:{label:e.$t("common.set.setName"),required:""}},[a("let-input",{attrs:{size:"small",placeholder:e.$t("serverList.dlg.errMsg.setName"),required:"",pattern:"^[a-z]+$","pattern-tip":e.$t("serverList.dlg.errMsg.setName")},model:{value:e.configModal.model.set_name,callback:function(t){e.$set(e.configModal.model,"set_name",t)},expression:"configModal.model.set_name"}})],1):e._e(),e._v(" "),e.configModal.model.enable_set?a("let-form-item",{attrs:{label:e.$t("common.set.setArea"),required:""}},[a("let-input",{attrs:{size:"small",placeholder:e.$t("serverList.dlg.errMsg.setArea"),required:"",pattern:"^[a-z]+$","pattern-tip":e.$t("serverList.dlg.errMsg.setArea")},model:{value:e.configModal.model.set_area,callback:function(t){e.$set(e.configModal.model,"set_area",t)},expression:"configModal.model.set_area"}})],1):e._e(),e._v(" "),e.configModal.model.enable_set?a("let-form-item",{attrs:{label:e.$t("common.set.setGroup"),required:""}},[a("let-input",{attrs:{size:"small",placeholder:e.$t("serverList.dlg.errMsg.setGroup"),required:"",pattern:"^[0-9\\*]+$","pattern-tip":e.$t("serverList.dlg.errMsg.setGroup")},model:{value:e.configModal.model.set_group,callback:function(t){e.$set(e.configModal.model,"set_group",t)},expression:"configModal.model.set_group"}})],1):e._e(),e._v(" "),a("let-form-item",{attrs:{label:e.$t("serverList.dlg.asyncThread"),required:""}},[a("let-input",{attrs:{size:"small",placeholder:e.$t("serverList.dlg.placeholder.thread"),required:"",pattern:"tars_nodejs"===e.configModal.model.server_type?"^[1-9][0-9]*$":"^([3-9]|[1-9][0-9]+)$","pattern-tip":"$t('serverList.dlg.placeholder.thread')"},model:{value:e.configModal.model.async_thread_num,callback:function(t){e.$set(e.configModal.model,"async_thread_num",t)},expression:"configModal.model.async_thread_num"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("serverList.dlg.defaultPath")}},[a("let-input",{attrs:{size:"small"},model:{value:e.configModal.model.base_path,callback:function(t){e.$set(e.configModal.model,"base_path",t)},expression:"configModal.model.base_path"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("serverList.dlg.exePath")}},[a("let-input",{attrs:{size:"small"},model:{value:e.configModal.model.exe_path,callback:function(t){e.$set(e.configModal.model,"exe_path",t)},expression:"configModal.model.exe_path"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("serverList.dlg.startScript")}},[a("let-input",{attrs:{size:"small"},model:{value:e.configModal.model.start_script_path,callback:function(t){e.$set(e.configModal.model,"start_script_path",t)},expression:"configModal.model.start_script_path"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("serverList.dlg.stopScript")}},[a("let-input",{attrs:{size:"small"},model:{value:e.configModal.model.stop_script_path,callback:function(t){e.$set(e.configModal.model,"stop_script_path",t)},expression:"configModal.model.stop_script_path"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("serverList.dlg.monitorScript"),itemWidth:"724px"}},[a("let-input",{attrs:{size:"small"},model:{value:e.configModal.model.monitor_script_path,callback:function(t){e.$set(e.configModal.model,"monitor_script_path",t)},expression:"configModal.model.monitor_script_path"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("serverList.dlg.privateTemplate"),labelWidth:"150px",itemWidth:"724px"}},[a("let-input",{attrs:{size:"large",type:"textarea",rows:4},model:{value:e.configModal.model.profile,callback:function(t){e.$set(e.configModal.model,"profile",t)},expression:"configModal.model.profile"}})],1)],1):a("div",{ref:"configFormLoading",staticClass:"loading-placeholder"})],1),e._v(" "),a("let-modal",{attrs:{title:e.$t("serverList.table.servant.title"),width:"1200px",footShow:!1},on:{close:e.closeServantModal},model:{value:e.servantModal.show,callback:function(t){e.$set(e.servantModal,"show",t)},expression:"servantModal.show"}},[a("let-button",{staticClass:"tbm16",attrs:{size:"small",theme:"primary"},on:{click:function(t){return e.configServant()}}},[e._v(e._s(e.$t("operate.add"))+" Servant\n    ")]),e._v(" "),e.servantModal.model?a("let-table",{attrs:{data:e.servantModal.model,"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{title:e.$t("operate.servant"),prop:"servant"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.table.servant.adress"),prop:"endpoint"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.table.servant.thread"),prop:"thread_num"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.table.servant.maxConnecttions"),prop:"max_connections"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.table.servant.maxQueue"),prop:"queuecap"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.table.servant.timeout"),prop:"queuetimeout"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("operate.operates"),width:"90px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-table-operation",{on:{click:function(a){return e.configServant(t.row.id)}}},[e._v(e._s(e.$t("operate.update")))]),e._v(" "),a("let-table-operation",{staticClass:"danger",on:{click:function(a){return e.deleteServant(t.row.id)}}},[e._v(e._s(e.$t("operate.delete"))+"\n          ")])]}}],null,!1,390471177)})],1):a("div",{ref:"servantModalLoading",staticClass:"loading-placeholder"})],1),e._v(" "),a("let-modal",{attrs:{title:e.servantDetailModal.isNew?e.$t("operate.title.add")+" Servant":e.$t("operate.title.update")+" Servant",width:"800px",footShow:!!e.servantDetailModal.model},on:{"on-confirm":e.saveServantDetail,close:e.closeServantDetailModal,"on-cancel":e.closeServantDetailModal},model:{value:e.servantDetailModal.show,callback:function(t){e.$set(e.servantDetailModal,"show",t)},expression:"servantDetailModal.show"}},[e.servantDetailModal.model?a("let-form",{ref:"servantDetailForm",staticClass:"two-columns",attrs:{itemWidth:"360px",columns:2}},[a("let-form-item",{attrs:{label:e.$t("serverList.servant.appService"),itemWidth:"724px"}},[a("span",[e._v(e._s(e.servantDetailModal.model.application)+"·"+e._s(e.servantDetailModal.model.server_name))])]),e._v(" "),a("let-form-item",{attrs:{label:e.$t("serverList.servant.objName"),required:""}},[a("let-input",{attrs:{size:"small",placeholder:e.$t("serverList.servant.c"),required:"",pattern:"^[A-Za-z]+$","pattern-tip":e.$t("serverList.servant.obj")},model:{value:e.servantDetailModal.model.obj_name,callback:function(t){e.$set(e.servantDetailModal.model,"obj_name",t)},expression:"servantDetailModal.model.obj_name"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("serverList.servant.numOfThread"),required:""}},[a("let-input",{attrs:{size:"small",placeholder:e.$t("serverList.servant.thread"),required:"",pattern:"^[1-9][0-9]*$","pattern-tip":e.$t("serverList.servant.thread")},model:{value:e.servantDetailModal.model.thread_num,callback:function(t){e.$set(e.servantDetailModal.model,"thread_num",t)},expression:"servantDetailModal.model.thread_num"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("serverList.table.servant.adress"),required:"",itemWidth:"724px"}},[a("let-input",{ref:"endpoint",attrs:{size:"small",placeholder:"tcp -h 127.0.0.1 -t 60000 -p 12000",required:"",extraTip:e.isEndpointValid?"":e.$t("serverList.servant.error")},model:{value:e.servantDetailModal.model.endpoint,callback:function(t){e.$set(e.servantDetailModal.model,"endpoint",t)},expression:"servantDetailModal.model.endpoint"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("serverList.servant.maxConnecttions"),labelWidth:"150px"}},[a("let-input",{attrs:{size:"small"},model:{value:e.servantDetailModal.model.max_connections,callback:function(t){e.$set(e.servantDetailModal.model,"max_connections",t)},expression:"servantDetailModal.model.max_connections"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("serverList.servant.lengthOfQueue"),labelWidth:"150px"}},[a("let-input",{attrs:{size:"small"},model:{value:e.servantDetailModal.model.queuecap,callback:function(t){e.$set(e.servantDetailModal.model,"queuecap",t)},expression:"servantDetailModal.model.queuecap"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("serverList.servant.queueTimeout"),labelWidth:"150px"}},[a("let-input",{attrs:{size:"small"},model:{value:e.servantDetailModal.model.queuetimeout,callback:function(t){e.$set(e.servantDetailModal.model,"queuetimeout",t)},expression:"servantDetailModal.model.queuetimeout"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("serverList.servant.allowIP")}},[a("let-input",{attrs:{size:"small"},model:{value:e.servantDetailModal.model.allow_ip,callback:function(t){e.$set(e.servantDetailModal.model,"allow_ip",t)},expression:"servantDetailModal.model.allow_ip"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("serverList.servant.protocol"),required:""}},[a("let-radio-group",{attrs:{size:"small",data:[{value:"tars",text:"TARS"},{value:"not_tars",text:e.$t("serverList.servant.notTARS")}]},model:{value:e.servantDetailModal.model.protocol,callback:function(t){e.$set(e.servantDetailModal.model,"protocol",t)},expression:"servantDetailModal.model.protocol"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("serverList.servant.treatmentGroup"),labelWidth:"150px"}},[a("let-input",{attrs:{size:"small"},model:{value:e.servantDetailModal.model.handlegroup,callback:function(t){e.$set(e.servantDetailModal.model,"handlegroup",t)},expression:"servantDetailModal.model.handlegroup"}})],1)],1):e._e()],1),e._v(" "),a("let-modal",{staticClass:"more-cmd",attrs:{title:e.$t("operate.title.more"),width:"700px"},on:{"on-confirm":e.invokeMoreCmd,close:e.closeMoreCmdModal,"on-cancel":e.closeMoreCmdModal},model:{value:e.moreCmdModal.show,callback:function(t){e.$set(e.moreCmdModal,"show",t)},expression:"moreCmdModal.show"}},[e.moreCmdModal.model?a("let-form",{ref:"moreCmdForm"},[a("let-form-item",{attrs:{itemWidth:"100%"}},[a("let-radio",{attrs:{label:"setloglevel"},model:{value:e.moreCmdModal.model.selected,callback:function(t){e.$set(e.moreCmdModal.model,"selected",t)},expression:"moreCmdModal.model.selected"}},[e._v(e._s(e.$t("serverList.servant.logLevel"))+"\n        ")]),e._v(" "),a("let-select",{attrs:{size:"small",disabled:"setloglevel"!==e.moreCmdModal.model.selected},model:{value:e.moreCmdModal.model.setloglevel,callback:function(t){e.$set(e.moreCmdModal.model,"setloglevel",t)},expression:"moreCmdModal.model.setloglevel"}},e._l(e.logLevels,function(t){return a("let-option",{key:t,attrs:{value:t}},[e._v(e._s(t))])}),1)],1),e._v(" "),a("let-form-item",{attrs:{itemWidth:"100%"}},[a("let-radio",{attrs:{label:"loadconfig"},model:{value:e.moreCmdModal.model.selected,callback:function(t){e.$set(e.moreCmdModal.model,"selected",t)},expression:"moreCmdModal.model.selected"}},[e._v(e._s(e.$t("serverList.servant.pushFile"))+"\n        ")]),e._v(" "),a("let-select",{attrs:{size:"small",placeholder:e.moreCmdModal.model.configs&&e.moreCmdModal.model.configs.length?e.$t("pub.dlg.defaultValue"):e.$t("pub.dlg.noConfFile"),disabled:!(e.moreCmdModal.model.configs&&e.moreCmdModal.model.configs.length)||"loadconfig"!==e.moreCmdModal.model.selected,required:"loadconfig"===e.moreCmdModal.model.selected},model:{value:e.moreCmdModal.model.loadconfig,callback:function(t){e.$set(e.moreCmdModal.model,"loadconfig",t)},expression:"moreCmdModal.model.loadconfig"}},e._l(e.moreCmdModal.model.configs,function(t){return a("let-option",{key:t.filename,attrs:{value:t.filename}},[e._v(e._s(t.filename)+"\n          ")])}),1)],1),e._v(" "),a("let-form-item",{attrs:{itemWidth:"100%"}},[a("let-radio",{attrs:{label:"command"},model:{value:e.moreCmdModal.model.selected,callback:function(t){e.$set(e.moreCmdModal.model,"selected",t)},expression:"moreCmdModal.model.selected"}},[e._v(e._s(e.$t("serverList.servant.sendCommand"))+"\n        ")]),e._v(" "),a("let-input",{attrs:{size:"small",disabled:"command"!==e.moreCmdModal.model.selected,required:"command"===e.moreCmdModal.model.selected},model:{value:e.moreCmdModal.model.command,callback:function(t){e.$set(e.moreCmdModal.model,"command",t)},expression:"moreCmdModal.model.command"}})],1),e._v(" "),a("let-form-item",{attrs:{itemWidth:"100%"}},[a("let-radio",{attrs:{label:"connection"},model:{value:e.moreCmdModal.model.selected,callback:function(t){e.$set(e.moreCmdModal.model,"selected",t)},expression:"moreCmdModal.model.selected"}},[e._v(e._s(e.$t("serverList.servant.serviceLink"))+"\n        ")])],1),e._v(" "),a("let-form-item",{attrs:{itemWidth:"100%"}},[a("let-radio",{staticClass:"danger",attrs:{label:"undeploy_tars"},model:{value:e.moreCmdModal.model.selected,callback:function(t){e.$set(e.moreCmdModal.model,"selected",t)},expression:"moreCmdModal.model.selected"}},[e._v("\n          "+e._s(e.$t("operate.undeploy"))+" "+e._s(e.$t("common.service"))+"\n        ")])],1)],1):e._e()],1),e._v(" "),a("let-modal",{attrs:{footShow:!1,closeOnClickBackdrop:!1,width:"1000px",title:e.$t("dcache.expand")},model:{value:e.expandShow,callback:function(t){e.expandShow=t},expression:"expandShow"}},[e.expandShow?a("Expand",{attrs:{"expand-servers":e.lastGroupServers},on:{close:function(t){e.expandShow=!1}}}):e._e()],1),e._v(" "),a("let-modal",{attrs:{title:e.$t("publishLog.title"),footShow:!1,closeOnClickBackdrop:!1,width:"1000px"},model:{value:e.releaseing,callback:function(t){e.releaseing=t},expression:"releaseing"}})],1)},staticRenderFns:[]};var te=a("VU/8")(Q,ee,!1,function(e){a("NxlF")},null,null).exports,ae=a("fZjL"),re=a.n(ae),oe={name:"ServerPublish",data:function(){return{serverType:this.$route.params.serverType||"tars",activeKey:"",treeData:[],totalServerList:[],serverList:[],isCheckedAll:!1,totalPage:0,pageSize:20,page:1,publishModal:{publishId:null,show:!1,model:null,module_name:"",application:"",totalPatchPage:0,patchPageSize:10,patchPage:1},finishModal:{show:!1,model:{task_no:"",items:[]}},statusConfig:{0:this.$t("serverList.restart.notStart"),1:this.$t("serverList.restart.running"),2:this.$t("serverList.restart.success"),3:this.$t("serverList.restart.failed"),4:this.$t("serverList.restart.cancel"),5:this.$t("serverList.restart.parial")},statusMap:{0:"EM_T_NOT_START",1:"EM_T_RUNNING",2:"EM_T_SUCCESS",3:"EM_T_FAILED",4:"EM_T_CANCEL",5:"EM_T_PARIAL"},showHistory:!1,startTime:"",endTime:"",totalHistoryList:[],historyList:[],historyTotalPage:0,historyPage:1,historyPageSize:20,taskModal:{show:!1,modal:!0},uploadModal:{show:!1,model:null},patchType:"patch",patchRadioData:[{value:"patch",text:this.$t("pub.dlg.upload")}],tagList:[],tagVersion:"",publishUrlConfModal:{show:!1,model:{tag:"",compiler:"",task:""}},compilerModal:{show:!1,model:null},pkgUpload:{show:!1,model:null}}},methods:{getCompileConf:function(){var e=this;this.$ajax.getJSON("/server/api/get_compile_conf").then(function(t){t.enable&&e.patchRadioData.push({value:"compile",text:e.$t("pub.dlg.compileAndPublish")})}).catch(function(t){e.$tip.error(e.$t("common.error")+": "+(t.message||t.err_msg))})},getServerList:function(){var e=this,t=this.$Loading.show();this.$ajax.getJSON("/server/api/server_list",{tree_node_id:this.$route.params.treeid}).then(function(a){t.hide();var r=a||[];r.forEach(function(e){e.isChecked=!1}),e.totalServerList=r,e.totalPage=Math.ceil(e.totalServerList.length/e.pageSize),e.page=1,e.updateServerList()}).catch(function(a){t.hide(),e.$confirm(a.err_msg||a.message||e.$t("serverList.table.msg.fail")).then(function(){e.getServerList()})})},changePage:function(e){this.page=e},openPublishModal:function(){var e=this,t=this.serverList.filter(function(e){return e.isChecked});if(t.length<=0)this.$tip.warning(this.$t("pub.dlg.a"));else{var a=t[0];this.publishModal.publishId=null,this.publishModal.model={application:a.application,server_name:a.server_name,serverList:t,patchList:[],patch_id:"",update_text:"",show:!0};var r=this.serverType,o=a.server_name;"router"==r?o="RouterServer":"proxy"==r?o="ProxyServer":"dcache"==r&&(o="DCacheServerGroup"),this.publishModal.module_name=o,this.publishModal.application=a.application,this.publishModal.patchPage=1,this.publishModal.patchPageSize=5,this.getPatchList(a.application,o,1,5).then(function(t){e.publishModal.model.patchList=t.rows,e.publishModal.totalPatchPage=Math.ceil(t.count/5),e.publishModal.show=!0})}},patchChangePage:function(e){var t=this;this.publishModal.patchPage=e;var a=this.publishModal,r=a.module_name,o=a.application,s=a.patchPage,l=a.patchPageSize;this.getPatchList(o,r,s,l).then(function(e){t.publishModal.model.patchList=e.rows,t.publishModal.totalPatchPage=Math.ceil(e.count/l)})},getPatchList:function(e,t,a,r){return this.$ajax.getJSON("/server/api/server_patch_list",{application:e,module_name:t,curr_page:a,page_size:r})},closePublishModal:function(){this.publishModal.show=!1,this.publishModal.modal=null,this.patchType="patch",this.$refs.publishForm.resetValid()},savePublishServer:function(){var e=this;if(this.$refs.publishForm.validate()){var t=[],a="tars"===this.serverType?this.publishModal.model.patch_id.toString():this.publishModal.publishId;if(!a)return this.$tip.warning(this.$t("pub.dlg.ab"));var r=this.serverType,o="";"router"==r?o="RouterServer":"proxy"==r?o="ProxyServer":"dcache"==r&&(o="DCacheServerGroup"),this.publishModal.model.serverList.forEach(function(r){t.push({server_id:r.id.toString(),command:"patch_tars",parameters:{patch_id:a,bak_flag:r.bak_flag,update_text:e.publishModal.model.update_text,group_name:o}})});var s=this.$Loading.show();this.$ajax.postJSON("/server/api/add_task",{serial:!0,items:t}).then(function(t){s.hide(),e.closePublishModal(),e.finishModal.model.task_no=t,e.finishModal.show=!0,e.getTaskRepeat(t)}).catch(function(t){s.hide(),e.$tip.error(e.$t("common.error")+": "+(t.message||t.err_msg))})}},closeFinishModal:function(){this.finishModal.show=!1,this.finishModal.modal=null,this.$refs.finishForm.resetValid()},getTaskRepeat:function(e){var t=this,a=void 0;a&&clearTimeout(a);!function r(){t.$ajax.getJSON("/server/api/task",{task_no:e}).then(function(e){e.items.forEach(function(e){2===parseInt(e.status,10)||3===parseInt(e.status,10)?clearTimeout(a):a=setTimeout(r,3e3)}),t.finishModal.model.items=e.items}).catch(function(e){clearTimeout(a),t.$tip.error(t.$t("common.error")+": "+(e.message||e.err_msg))})}()},updateServerList:function(){var e=(this.page-1)*this.pageSize,t=this.page*this.pageSize;this.serverList=this.totalServerList.slice(e,t)},gotoHistory:function(){this.showHistory=!0,this.getHistoryList(1)},getHistoryList:function(e){var t=this;"number"!=typeof e&&(e=1);var a=this.$Loading.show(),r={application:this.serverList[0].application||"",server_name:this.serverList[0].server_name||"",from:this.startTime,to:this.endTime,page_size:this.historyPageSize,curr_page:e};this.historyPage=e,this.$ajax.getJSON("/server/api/task_list",r).then(function(e){a.hide(),t.totalHistoryList=e.rows||[],t.historyTotalPage=Math.ceil(e.count/t.historyPageSize)}).catch(function(e){a.hide(),t.$tip.error(t.$t("common.error")+": "+(e.message||e.err_msg))})},viewTask:function(e){var t=this;this.$ajax.getJSON("/server/api/task",{task_no:e}).then(function(e){t.taskModal.model=e,t.taskModal.show=!0})},changeHistoryPage:function(e){this.getHistoryList(e)},showUploadModal:function(){this.serverList.length<=0&&this.$tip.warning(this.$t("pub.dlg.a")),this.uploadModal.model={application:this.serverList[0].application||"",server_name:this.serverList[0].server_name||"",file:null,comment:""},this.uploadModal.show=!0},closeUploadModal:function(){this.uploadModal.show=!1,this.uploadModal.model=null,this.$refs.uploadForm.resetValid()},uploadFile:function(e){this.uploadModal.model.file=e},uploadPatchPackage:function(){var e=this;if(this.$refs.uploadForm.validate()){var t=this.$Loading.show(),a=new FormData;a.append("application",this.uploadModal.model.application),a.append("module_name",this.uploadModal.model.server_name),a.append("suse",this.uploadModal.model.file),a.append("comment",this.uploadModal.model.comment),a.append("task_id",(new Date).getTime()),this.$ajax.postForm("/server/api/upload_patch_package",a).then(function(){e.getPatchList(e.uploadModal.model.application,e.uploadModal.model.server_name,1,50).then(function(a){t.hide(),e.publishModal.model.patchList=a.rows,e.closeUploadModal()})}).catch(function(a){t.hide(),e.$tip.error(e.$t("common.error")+": "+(a.message||a.err_msg))})}},handleNoPublishedTime:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.$t("pub.dlg.unpublished");return"0000:00:00 00:00:00"===e?t:e},patchChange:function(){"patch"==this.patchType?this.publishModal.model.show=!0:(this.publishModal.model.show=!1,this.getCodeVersion())},getCodeVersion:function(){var e=this;this.$ajax.get("/server/api/get_tag_list",{application:this.publishModal.model.application,server_name:this.publishModal.model.server_name}).then(function(t){""==t.data?e.openPubConfModal():e.tagList=t.data}).catch(function(t){e.tagList=[],e.$tip.error(e.$t("common.error")+": "+(err.err_msg||err.message))})},openPubConfModal:function(){var e=this;this.publishUrlConfModal.show=!0,this.$ajax.getJSON("/server/api/get_tag_conf",{application:this.publishModal.model.application,server_name:this.publishModal.model.server_name}).then(function(t){e.publishUrlConfModal.model.tag=t.path}).catch(function(t){e.$tip.error(e.$t("common.error")+": "+(t.err_msg||t.message))})},saveCompilerUrl:function(){var e=this;if(this.$refs.compilerForm.validate()){var t=this.$Loading.show();this.$ajax.getJSON("/server/api/set_tag_conf",{path:this.publishUrlConfModal.model.tag,application:this.publishModal.model.application,server_name:this.publishModal.model.server_name}).then(function(a){t.hide(),e.$tip.success(e.$t("common.success")),e.publishUrlConfModal.show=!1,e.getCodeVersion()}).catch(function(a){t.hide(),e.$tip.error(e.$t("common.error")+": "+(a.err_msg||a.message))})}},addCompileTask:function(){var e=this;this.$ajax.getJSON("/server/api/get_compile_conf").then(function(t){var a=t.getVersionList;if(a){var r=e.publishModal.model.serverList.map(function(e){return e.node_name}),o={application:e.publishModal.model.application,server_name:e.publishModal.model.server_name,node:r.join(";"),path:e.tagVersion.split("--")[0],version:e.tagVersion.split("--")[1],comment:e.publishModal.model.update_text||"",compileUrl:a},s=e.$Loading.show();e.$ajax.postJSON("/server/api/do_compile",o).then(function(t){s.hide(),e.compilerModal.show=!0;var a="string"==typeof t?t:t.data;e.getStatus(a)}).catch(function(t){s.hide(),e.$tip.error(e.$t("common.error")+": "+(t.err_msg||t.message))})}else e.openPubConfModal()}).catch(function(t){e.$tip.error(e.$t("common.error")+": "+(t.err_msg||t.message))})},taskStatus:function(e){this.getStatus(e)},getStatus:function(e){var t=this;!function a(){var r=null;r&&clearTimeout(r),t.$ajax.getJSON("/server/api/compiler_task",{taskNo:e}).then(function(o){var s="array"==typeof o?o:o.data;if(s[0].status=t.statusConfig[s[0].state],1==s[0].state&&(r=setTimeout(a,2e3)),t.compilerModal.model?g()(t.compilerModal.model,{progress:s}):t.compilerModal.model={progress:s},2==s[0].state){var l=t.$Loading({text:"回传发布包"});l.show(),t.compilerModal.show=!1,setTimeout(function a(){t.$ajax.getJSON("/server/api/get_server_patch",{task_id:e}).then(function(e){0!==re()(e).length?(l.hide(),t.publishModal.model.patch_id=e.id,t.publishModal.show=!1,t.savePublishServer()):setTimeout(a,2e3)}).catch(function(e){l.hide(),t.$tip.error(t.$t("common.error")+": "+(e.err_msg||e.message))})},2e3)}}).catch(function(e){t.$tip.error(t.$t("common.error")+": "+(e.err_msg||e.message))})}()}},mounted:function(){this.getServerList(),this.getCompileConf()},watch:{isCheckedAll:function(){var e=this.isCheckedAll;this.serverList.forEach(function(t){t.isChecked=e})},page:function(){this.updateServerList()}}},se={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page_server_publish"},[e.showHistory?e._e():a("div",[e.serverList&&e.serverList.length>0?a("let-table",{ref:"table",attrs:{data:e.serverList,title:e.$t("serverList.title.serverList"),"empty-msg":e.$t("common.noService")}},[a("let-table-column",{scopedSlots:e._u([{key:"head",fn:function(t){return[a("let-checkbox",{model:{value:e.isCheckedAll,callback:function(t){e.isCheckedAll=t},expression:"isCheckedAll"}})]}},{key:"default",fn:function(t){return[a("let-checkbox",{attrs:{value:t.row.id},model:{value:t.row.isChecked,callback:function(a){e.$set(t.row,"isChecked",a)},expression:"scope.row.isChecked"}})]}}],null,!1,1693185143)}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.ip"),prop:"node_name"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.enableSet")},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.enable_set?e.$t("common.enable"):e.$t("common.disable")))])]}}],null,!1,2059146282)}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("common.set.setName"),prop:"set_name"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("common.set.setArea"),prop:"set_area"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("common.set.setGroup"),prop:"set_group"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.configStatus")},scopedSlots:e._u([{key:"default",fn:function(e){return[a("span",{class:"active"==e.row.setting_state?"status-active":"status-off"})]}}],null,!1,483453731)}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.currStatus")},scopedSlots:e._u([{key:"default",fn:function(e){return[a("span",{class:"active"==e.row.present_state?"status-active":"status-off"})]}}],null,!1,3783586142)}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.version"),prop:"patch_version"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.time")},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticStyle:{"word-break":"break-word"}},[e._v(e._s(e.handleNoPublishedTime(t.row.patch_time)))])]}}],null,!1,3144837894)}),e._v(" "),a("let-pagination",{attrs:{slot:"pagination",align:"right",total:e.totalPage,page:e.page},on:{change:e.changePage},slot:"pagination"}),e._v(" "),a("div",{staticStyle:{"margin-left":"-15px"},attrs:{slot:"operations"},slot:"operations"},[a("let-button",{attrs:{theme:"primary",size:"small"},on:{click:e.openPublishModal}},[e._v(e._s(e.$t("pub.btn.pub")))]),e._v(" "),e.serverList&&e.serverList.length>0?a("let-button",{attrs:{size:"small"},on:{click:e.gotoHistory}},[e._v("\n          "+e._s(e.$t("pub.btn.history"))+"\n        ")]):e._e()],1)],1):e._e(),e._v(" "),a("let-modal",{attrs:{title:e.$t("index.rightView.tab.patch"),width:"880px",footShow:!1},on:{close:e.closePublishModal,"on-confirm":e.savePublishServer},model:{value:e.publishModal.show,callback:function(t){e.$set(e.publishModal,"show",t)},expression:"publishModal.show"}},[e.publishModal.model?a("let-form",{ref:"publishForm",attrs:{itemWidth:"100%"}},[a("let-form-item",{attrs:{label:e.$t("serverList.servant.appService")}},[e._v("\n          "+e._s(e.publishModal.model.application)+"·"+e._s(e.publishModal.model.server_name)+"\n        ")]),e._v(" "),a("let-form-item",{attrs:{label:e.$t("pub.dlg.ip")}},e._l(e.publishModal.model.serverList,function(t){return a("div",{key:t.id},[e._v(e._s(t.node_name))])}),0),e._v(" "),"tars"==e.serverType?a("let-form-item",{attrs:{label:e.$t("serverList.servant.comment")}},[a("let-input",{model:{value:e.publishModal.model.update_text,callback:function(t){e.$set(e.publishModal.model,"update_text",t)},expression:"publishModal.model.update_text"}})],1):e._e(),e._v(" "),e.patchRadioData.length>1?a("let-form-item",{attrs:{label:e.$t("pub.dlg.patchType")}},[a("let-radio-group",{attrs:{type:"button",size:"small",data:e.patchRadioData},on:{change:e.patchChange},model:{value:e.patchType,callback:function(t){e.patchType=t},expression:"patchType"}})],1):e._e(),e._v(" "),e.publishModal.model.show?a("let-form-item",{attrs:{label:e.$t("pub.dlg.releaseVersion")}},["tars"==e.serverType?a("let-select",{attrs:{size:"small",required:"","required-tip":e.$t("pub.dlg.ab")},model:{value:e.publishModal.model.patch_id,callback:function(t){e.$set(e.publishModal.model,"patch_id",t)},expression:"publishModal.model.patch_id"}},e._l(e.publishModal.model.patchList,function(t){return a("let-option",{key:t.id,attrs:{value:t.id}},[e._v("\n              "+e._s(t.id)+" | "+e._s(t.posttime)+" | "+e._s(t.comment)+"\n            ")])}),1):e._e(),e._v(" "),"tars"==e.serverType?a("let-button",{staticClass:"mt10",attrs:{theme:"primary",size:"small"},on:{click:e.showUploadModal}},[e._v("\n            "+e._s(e.$t("pub.dlg.upload"))+"\n          ")]):e._e(),e._v(" "),a("br"),e._v(" "),"tars"!==e.serverType?a("let-table",{attrs:{data:e.publishModal.model.patchList,"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-radio",{attrs:{label:t.row.id},model:{value:e.publishModal.publishId,callback:function(t){e.$set(e.publishModal,"publishId",t)},expression:"publishModal.publishId"}},[e._v(" ")])]}}],null,!1,3748975665)}),e._v(" "),a("let-table-column",{attrs:{title:"ID",prop:"id"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s(t.row.id)+"\n                "),a("span",{staticStyle:{color:"green",display:"inline-block",width:"1em",height:"1em"},attrs:{title:e.$t("releasePackage.default")}},[1==t.row.default_version?a("icon",{attrs:{name:"default"}}):e._e()],1)]}}],null,!1,3749738076)}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("releasePackage.moduleName"),prop:"server"}}),e._v(" "),"dcache"===e.serverType?a("let-table-column",{attrs:{title:e.$t("releasePackage.cacheType")},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(1==t.row.package_type?"KVcache":"MKVcache"))])]}}],null,!1,1195663938)}):e._e(),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.servant.comment"),prop:"comment"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("releasePackage.uploadTime"),prop:"posttime"}}),e._v(" "),a("let-pagination",{attrs:{slot:"pagination",align:"right",total:e.publishModal.totalPatchPage,page:e.publishModal.patchPage},on:{change:e.patchChangePage},slot:"pagination"})],1):e._e(),e._v(" "),a("let-button",{staticClass:"mt10",attrs:{theme:"primary",size:"small"},on:{click:e.savePublishServer}},[e._v(e._s(e.$t("common.patch"))+"\n          ")])],1):a("let-form-item",{attrs:{label:e.$t("serverList.table.th.version")}},[a("let-select",{attrs:{size:"small",required:"","required-tip":e.$t("deployService.table.tips.empty"),requred:""},model:{value:e.tagVersion,callback:function(t){e.tagVersion=t},expression:"tagVersion"}},e._l(e.tagList,function(t){return a("let-option",{key:""+t.version,attrs:{value:t.path+"--"+t.version}},[e._v("\n              "+e._s(t.version)+"\n            ")])}),1),e._v(" "),a("let-button",{staticClass:"mt10",attrs:{theme:"primary",size:"small"},on:{click:e.addCompileTask}},[e._v("\n            "+e._s(e.$t("pub.dlg.compileAndPublish"))+"\n          ")]),e._v(" "),e._e()],1)],1):e._e()],1),e._v(" "),a("let-modal",{attrs:{title:e.$t("pub.dlg.upload"),width:"880px",footShow:!1},on:{"on-cancel":e.closeUploadModal},model:{value:e.uploadModal.show,callback:function(t){e.$set(e.uploadModal,"show",t)},expression:"uploadModal.show"}},[e.uploadModal.model?a("let-form",{ref:"uploadForm",attrs:{itemWidth:"100%"},nativeOn:{submit:function(t){return t.preventDefault(),e.uploadPatchPackage(t)}}},[a("let-form-item",{attrs:{label:e.$t("pub.dlg.releasePkg"),itemWidth:"400px"}},[a("let-uploader",{attrs:{placeholder:e.$t("pub.dlg.defaultValue")},on:{upload:e.uploadFile}},[e._v(e._s(e.$t("common.submit"))+"\n          ")]),e._v(" "),e.uploadModal.model.file?a("span",[e._v(e._s(e.uploadModal.model.file.name))]):e._e()],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("serverList.servant.comment")}},[a("let-input",{attrs:{type:"textarea",rows:3},model:{value:e.uploadModal.model.comment,callback:function(t){e.$set(e.uploadModal.model,"comment",t)},expression:"uploadModal.model.comment"}})],1),e._v(" "),a("let-button",{attrs:{type:"submit",theme:"primary"}},[e._v(e._s(e.$t("serverList.servant.upload")))])],1):e._e()],1),e._v(" "),a("let-modal",{attrs:{title:e.$t("serverList.table.th.result"),width:"880px",footShow:!1},on:{"on-cancel":e.closeFinishModal},model:{value:e.finishModal.show,callback:function(t){e.$set(e.finishModal,"show",t)},expression:"finishModal.show"}},[e.finishModal.model?a("let-table",{attrs:{title:e.$t("serverList.servant.taskID")+e.finishModal.model.task_no,data:e.finishModal.model.items}},[a("let-table-column",{attrs:{title:e.$t("serverList.table.th.ip"),prop:"node_name"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("common.status")},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-tag",{attrs:{theme:2==t.row.status?"success":3==t.row.status?"danger":"",checked:""}},[e._v("\n              "+e._s(e.statusConfig[t.row.status]+(2!=t.row.status&&3!=t.row.status?"...":""))+"\n            ")])]}}],null,!1,1065210608)})],1):e._e()],1)],1),e._v(" "),e.showHistory?a("div",[a("let-form",{attrs:{inline:"",itemWidth:"300px"},nativeOn:{submit:function(t){return t.preventDefault(),e.getHistoryList(t)}}},[a("let-form-item",{attrs:{label:e.$t("pub.date")}},[a("let-date-range-picker",{attrs:{start:e.startTime,end:e.endTime},on:{"update:start":function(t){e.startTime=t},"update:end":function(t){e.endTime=t}}})],1),e._v(" "),a("let-form-item",[a("let-button",{attrs:{type:"submit",theme:"primary"}},[e._v(e._s(e.$t("operate.search")))])],1)],1),e._v(" "),a("let-table",{ref:"historyTable",attrs:{data:e.totalHistoryList,title:e.$t("historyList.title"),"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{title:e.$t("serverList.servant.taskID"),prop:"task_no"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("historyList.table.th.c2")},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.serial?e.$t("common.yes"):e.$t("common.no")))])]}}],null,!1,98019885)}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.dlg.title.taskStatus")},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e.statusMap[t.row.status]||"-"))])]}}],null,!1,3973050033)}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("historyList.table.th.c4")},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-table-operation",{on:{click:function(a){return e.viewTask(t.row.task_no)}}},[e._v(e._s(e.$t("operate.view")))])]}}],null,!1,1853944e3)}),e._v(" "),a("let-pagination",{attrs:{slot:"pagination",align:"right",total:e.historyTotalPage,page:e.historyPage},on:{change:e.changeHistoryPage},slot:"pagination"}),e._v(" "),a("div",{staticStyle:{"margin-left":"-15px"},attrs:{slot:"operations"},slot:"operations"},[a("let-button",{attrs:{theme:"primary",size:"small"},on:{click:function(t){e.showHistory=!1}}},[e._v(e._s(e.$t("operate.goback")))])],1)],1),e._v(" "),a("let-modal",{attrs:{title:e.$t("historyList.table.th.c4"),width:"880px",footShow:!1},on:{"on-cancel":function(t){e.taskModal.show=!1}},model:{value:e.taskModal.show,callback:function(t){e.$set(e.taskModal,"show",t)},expression:"taskModal.show"}},[e.taskModal.model?a("let-table",{attrs:{data:e.taskModal.model.items}},[a("let-table-column",{attrs:{title:e.$t("historyList.dlg.th.c1"),prop:"item_no"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("historyList.dlg.th.c2"),prop:"application"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("historyList.dlg.th.c3"),prop:"server_name"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("historyList.dlg.th.c4"),prop:"node_name"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("historyList.dlg.th.c5"),prop:"command"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("monitor.search.start"),prop:"start_time"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("monitor.search.end"),prop:"end_time"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("common.status"),prop:"status_info"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("historyList.dlg.th.c7"),prop:"execute_info"}})],1):e._e()],1)],1):e._e(),e._v(" "),a("let-modal",{attrs:{title:e.$t("pub.dlg.conf"),width:"800px",footShow:!0},on:{"on-confirm":e.saveCompilerUrl,"on-cancel":function(t){e.publishUrlConfModal.show=!1}},model:{value:e.publishUrlConfModal.show,callback:function(t){e.$set(e.publishUrlConfModal,"show",t)},expression:"publishUrlConfModal.show"}},[e.publishUrlConfModal.model?a("let-form",{ref:"compilerForm",attrs:{itemWidth:"100%",required:""}},[a("let-form-item",{attrs:{label:e.$t("pub.dlg.tag")}},[a("let-input",{attrs:{size:"small",placeholder:e.$t("pub.tips.tag"),"required-tip":e.$t("deployService.table.tips.empty"),required:""},model:{value:e.publishUrlConfModal.model.tag,callback:function(t){e.$set(e.publishUrlConfModal.model,"tag",t)},expression:"publishUrlConfModal.model.tag"}})],1)],1):e._e()],1),e._v(" "),a("let-modal",{attrs:{title:e.$t("pub.dlg.compileProgress"),width:"880px",footShow:!1},model:{value:e.compilerModal.show,callback:function(t){e.$set(e.compilerModal,"show",t)},expression:"compilerModal.show"}},[e.compilerModal.model?a("let-table",{attrs:{data:e.compilerModal.model.progress}},[a("let-table-column",{attrs:{title:e.$t("historyList.dlg.th.c2"),prop:"application"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("historyList.dlg.th.c3"),prop:"server_name"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("historyList.dlg.th.c4"),prop:"node"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("historyList.dlg.th.c8"),prop:"status"},scopedSlots:e._u([{key:"default",fn:function(t){return["1"==t.row.state?a("span",{staticClass:"running"},[e._v(e._s(t.row.status))]):"2"==t.row.state?a("span",{staticClass:"success"},[e._v(e._s(t.row.status))]):a("span",{staticClass:"stop"},[e._v(e._s(t.row.status))])]}}],null,!1,3193835083)}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("monitor.search.start"),prop:"start_time"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("monitor.search.end"),prop:"end_time"}})],1):e._e()],1)],1)},staticRenderFns:[]};var le=a("VU/8")(oe,se,!1,function(e){a("MJuj")},null,null).exports,ie=a("vOkX"),ne=a("SJ4V"),ce=a("tqp+"),de=a("E+Yk"),ue=a("7x6k"),me={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page_operation"},[a("let-tabs",{attrs:{activekey:e.$route.matched[1]?e.$route.matched[1].path:"/operation/apply"},on:{click:e.onTabClick}},[a("let-tab-pane",{attrs:{tab:e.$t("apply.title"),tabkey:"/operation/apply"}}),e._v(" "),a("let-tab-pane",{attrs:{tab:e.$t("module.title"),tabkey:"/operation/module"}}),e._v(" "),a("let-tab-pane",{attrs:{tab:e.$t("region.title"),tabkey:"/operation/region"}})],1),e._v(" "),a("router-view",{staticClass:"page_operation_children"})],1)},staticRenderFns:[]};var pe=a("VU/8")({name:"Oparetion",methods:{onTabClick:function(e){this.$router.replace(e)}}},me,!1,function(e){a("8bu2")},null,null).exports,fe={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page_operation_apply"},[a("let-steps",{staticClass:"apply_steps",attrs:{current:e.step}},[a("let-step",{attrs:{title:e.$t(e.title1)}}),e._v(" "),a("let-step",{attrs:{title:e.$t(e.title2)}}),e._v(" "),a("let-step",{attrs:{title:e.$t(e.title3)}})],1),e._v(" "),a("router-view",{staticClass:"page_operation_apply_children"})],1)},staticRenderFns:[]};var he=a("VU/8")({data:function(){var e=this.$route.fullPath,t=1;return e.indexOf("createApply")>-1?t=1:e.indexOf("createService")>-1?t=2:e.indexOf("installAndPublish")>-1&&(t=3),{title1:"apply.createApply",title2:"apply.createRouterProxyService",title3:"apply.installAndPublish",step:t}},watch:{$route:function(e,t){var a=e.fullPath;a.indexOf("createApply")>-1?this.step=1:a.indexOf("createService")>-1?this.step=2:a.indexOf("installAndPublish")>-1&&(this.step=3)}},methods:{}},fe,!1,function(e){a("1Ggf")},null,null).exports,ve={data:function(){return{regions:[],setRegions:[],model:{name:"",admin:"",idcArea:"",setArea:[]}}},methods:{changeSelect:function(){var e=this;this.model.setArea=[];var t=this.regions.concat();t.splice(t.indexOf(t.find(function(t){return t.label==e.model.idcArea})),1),this.setRegions=t},createApply:function(){var e=this;if(this.$refs.detailForm.validate()){var t=this.model,a=this.$Loading.show();this.$ajax.postJSON("/server/api/add_apply",t).then(function(t){a.hide(),e.$tip.success(e.$t("common.success")),e.$router.push("/operation/apply/createService/"+t.id)}).catch(function(t){a.hide(),e.$tip.error(e.$t("common.error")+": "+(t.message||t.err_msg))})}}},created:function(){window.a=this},beforeRouteEnter:function(e,t,a){o.a.getJSON("/server/api/get_region_list").then(function(e){e.length&&a(function(t){t.regions=e})}).catch(function(e){alert(e.message||e.err_msg)}),o.a.getJSON("/server/api/has_dcahce_patch_package").then(function(e){e?a():a(function(e){e.$tip.warning(e.$t("common.warning")+": "+e.$t("apply.uploadPatchPackage")),e.$router.push("/releasePackage/proxyList")})}).catch(function(e){alert(e.message||e.err_msg)})}},ge={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"page_operation_create_apply"},[a("let-form",{ref:"detailForm",attrs:{inline:""}},[a("let-form-item",{attrs:{label:e.$t("apply.title"),itemWidth:"240px",required:""}},[a("let-input",{attrs:{size:"small",required:"","required-tip":e.$t("deployService.table.tips.empty")},model:{value:e.model.name,callback:function(t){e.$set(e.model,"name",t)},expression:"model.name"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("common.admin"),itemWidth:"240px"}},[a("let-input",{attrs:{size:"small"},model:{value:e.model.admin,callback:function(t){e.$set(e.model,"admin",t)},expression:"model.admin"}})],1),e._v(" "),a("br"),e._v(" "),a("let-form-item",{attrs:{label:e.$t("region.idcArea"),itemWidth:"240px"}},[a("let-select",{attrs:{size:"small"},on:{change:e.changeSelect},model:{value:e.model.idcArea,callback:function(t){e.$set(e.model,"idcArea",t)},expression:"model.idcArea"}},e._l(e.regions,function(t){return a("let-option",{key:t.label,attrs:{value:t.label}},[e._v("\n            "+e._s(t.region)+"\n          ")])}),1)],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("region.setArea"),itemWidth:"240px"}},[a("let-select",{attrs:{size:"small",multiple:!0},model:{value:e.model.setArea,callback:function(t){e.$set(e.model,"setArea",t)},expression:"model.setArea"}},e._l(e.setRegions,function(t){return a("let-option",{key:t.label,attrs:{value:t.label}},[e._v("\n            "+e._s(t.region)+"\n          ")])}),1)],1),e._v(" "),a("div",[a("let-button",{attrs:{size:"small",theme:"primary"},on:{click:e.createApply}},[e._v(e._s(e.$t("apply.createApply")))])],1)],1)],1)},staticRenderFns:[]};var _e=a("VU/8")(ve,ge,!1,function(e){a("kM9U")},null,null).exports,be={data:function(){return{templates:[],applyId:this.$route.params.applyId,apply:{Router:{apply_id:17,create_person:"adminUser",router_db_ip:"",router_db_name:"",router_db_pass:"",router_db_port:"",router_db_user:"",server_ip:"",server_name:"aswRouterServer",template_file:""},Proxy:[{apply_id:17,create_person:"adminUser",idc_area:"sz",server_ip:"",server_name:"aswRouterServer",template_file:""}]}}},methods:{templateNameList:function(){var e=this;return this.$ajax.getJSON("/server/api/template_name_list").then(function(t){e.templates=t,e.apply.Router.template_file=t[0],e.apply.Proxy.forEach(function(e){return e.template_file=t[0]})}).catch(function(t){e.$tip.error(e.$t("common.error")+": "+(t.message||t.err_msg))})},getApplyInfo:function(){var e=this,t=this.applyId;return this.$ajax.getJSON("/server/api/get_apply_and_router_and_proxy",{applyId:t}).then(function(t){e.apply=t||{}}).catch(function(t){e.$tip.error(e.$t("common.error")+": "+(t.message||t.err_msg))})},createService:function(){var e=this;if(this.$refs.detailForm.validate()){var t=this.apply,a=this.$Loading.show();this.$ajax.postJSON("/server/api/save_router_proxy",t).then(function(t){a.hide();var r=e.applyId;e.$router.push("/operation/apply/installAndPublish/"+r)}).catch(function(t){a.hide(),e.$tip.error(e.$t("common.error")+": "+(t.message||t.err_msg))})}}},created:function(){var e=this;return N()(L.a.mark(function t(){return L.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getApplyInfo();case 2:return t.next=4,e.templateNameList();case 4:case"end":return t.stop()}},t,e)}))()}},$e={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"page_operation_create_service"},[a("let-form",{ref:"detailForm",attrs:{"label-position":"top"}},[a("let-form-group",{attrs:{title:e.$t("apply.RouterConfigInfo"),inline:"","label-position":"top"}},[a("let-form-item",{attrs:{label:e.$t("service.serverName"),itemWidth:"240px",required:""}},[a("let-input",{attrs:{size:"small",required:"","required-tip":e.$t("deployService.table.tips.empty")},model:{value:e.apply.Router.server_name,callback:function(t){e.$set(e.apply.Router,"server_name",t)},expression:"apply.Router.server_name"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("service.serverIp"),itemWidth:"240px",required:""}},[a("let-input",{attrs:{size:"small",required:"","required-tip":e.$t("deployService.table.tips.empty")},model:{value:e.apply.Router.server_ip,callback:function(t){e.$set(e.apply.Router,"server_ip",t)},expression:"apply.Router.server_ip"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("deployService.form.template"),itemWidth:"240px",required:""}},[a("let-select",{attrs:{size:"small",required:"","required-tip":e.$t("deployService.form.templateTips")},model:{value:e.apply.Router.template_file,callback:function(t){e.$set(e.apply.Router,"template_file",t)},expression:"apply.Router.template_file"}},e._l(e.templates,function(t){return a("let-option",{key:t,attrs:{value:t}},[e._v(e._s(t))])}),1)],1),e._v(" "),a("br"),e._v(" "),a("span",{staticStyle:{"margin-left":"20px"}},[e._v(e._s(e.$t("service.routerDbNameTip")))]),e._v(" "),a("br"),e._v(" "),a("let-form-item",{attrs:{label:e.$t("service.routerDbName"),itemWidth:"240px",required:""}},[a("let-input",{attrs:{size:"small",required:"","required-tip":e.$t("deployService.table.tips.empty")},model:{value:e.apply.Router.router_db_name,callback:function(t){e.$set(e.apply.Router,"router_db_name",t)},expression:"apply.Router.router_db_name"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("service.routerDbIp"),itemWidth:"240px",required:""}},[a("let-input",{attrs:{size:"small",required:"","required-tip":e.$t("deployService.table.tips.empty")},model:{value:e.apply.Router.router_db_ip,callback:function(t){e.$set(e.apply.Router,"router_db_ip",t)},expression:"apply.Router.router_db_ip"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("service.routerDbPort"),itemWidth:"240px",required:""}},[a("let-input",{attrs:{size:"small",required:"","required-tip":e.$t("deployService.table.tips.empty")},model:{value:e.apply.Router.router_db_port,callback:function(t){e.$set(e.apply.Router,"router_db_port",t)},expression:"apply.Router.router_db_port"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("service.routerDbUser"),itemWidth:"240px",required:""}},[a("let-input",{attrs:{size:"small",required:"","required-tip":e.$t("deployService.table.tips.empty")},model:{value:e.apply.Router.router_db_user,callback:function(t){e.$set(e.apply.Router,"router_db_user",t)},expression:"apply.Router.router_db_user"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("service.routerDbPass"),itemWidth:"240px",required:""}},[a("let-input",{attrs:{size:"small",required:"","required-tip":e.$t("deployService.table.tips.empty")},model:{value:e.apply.Router.router_db_pass,callback:function(t){e.$set(e.apply.Router,"router_db_pass",t)},expression:"apply.Router.router_db_pass"}})],1)],1),e._v(" "),a("let-form-group",{attrs:{title:e.$t("apply.ProxyConfigInfo"),inline:"","label-position":"top"}},[a("let-table",{ref:"table",attrs:{data:e.apply.Proxy,"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{title:e.$t("service.serverName"),prop:"server_name",width:"25%"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-input",{attrs:{size:"small",required:"","required-tip":e.$t("deployService.table.tips.empty")},model:{value:t.row.server_name,callback:function(a){e.$set(t.row,"server_name",a)},expression:"scope.row.server_name"}})]}}])}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("service.multipleIp"),prop:"server_ip",width:"25%"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-input",{attrs:{size:"small",required:"","required-tip":e.$t("deployService.table.tips.empty")},model:{value:t.row.server_ip,callback:function(a){e.$set(t.row,"server_ip",a)},expression:"scope.row.server_ip"}})]}}])}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("region.idcArea"),prop:"idc_area"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(t.row.idc_area)+"\n          ")]}}])}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("deployService.form.template"),prop:"template_file"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-select",{attrs:{size:"small",required:"","required-tip":e.$t("deployService.form.templateTips")},model:{value:t.row.template_file,callback:function(a){e.$set(t.row,"template_file",a)},expression:"scope.row.template_file"}},e._l(e.templates,function(t){return a("let-option",{key:t,attrs:{value:t}},[e._v(e._s(t))])}),1)]}}])})],1)],1),e._v(" "),a("let-button",{attrs:{size:"small",theme:"primary"},on:{click:e.createService}},[e._v(e._s(e.$t("apply.createRouterProxyService"))+"\n    ")])],1)],1)},staticRenderFns:[]};var Me=a("VU/8")(be,$e,!1,function(e){a("3T6I")},null,null).exports,ye={data:function(){return{applyId:this.$route.params.applyId,showModal:!1,items:[],apply:{set_area:[],Router:{apply_id:17,create_person:"adminUser",router_db_ip:"",router_db_name:"",router_db_pass:"",router_db_port:"",router_db_user:"",server_ip:"",server_name:"aswRouterServer",template_file:""},Proxy:[{apply_id:17,create_person:"adminUser",idc_area:"sz",server_ip:"",server_name:"aswRouterServer",template_file:""}]},timerId:null}},methods:{getApplyInfo:function(){var e=this,t=this.applyId;this.$ajax.getJSON("/server/api/get_apply_and_router_and_proxy",{applyId:t}).then(function(t){e.apply=t||{}}).catch(function(t){e.$tip.error(e.$t("common.error")+": "+(t.message||t.err_msg))})},installAndPublish:function(){var e=this,t=this.applyId;this.$ajax.getJSON("/server/api/install_and_publish",{applyId:t}).then(function(t){var a=t.proxy.releaseId,r=t.router.releaseId;e.getTaskRepeat({proxyReleaseId:a,routerReleaseId:r}),e.$tip.success(t.proxy.errMsg)}).catch(function(t){e.$tip.error(e.$t("common.error")+": "+(t.message||t.err_msg))})},getTaskRepeat:function(e){var t=this,a=e.proxyReleaseId,r=e.routerReleaseId;clearTimeout(this.timerId),this.showModal=!0;!function e(){t.$ajax.getJSON("/server/api/get_release_progress",{proxyReleaseId:a,routerReleaseId:r}).then(function(a){var r=!0;a.progress.forEach(function(e){100!==parseInt(e.percent,10)&&(r=!1)}),r?clearTimeout(t.timerId):t.timerId=setTimeout(e,1e3),t.items=a.progress}).catch(function(e){clearTimeout(t.timerId),t.$tip.error(t.$t("common.error")+": "+(e.message||e.err_msg))})}()},confirmPublish:function(){this.showModal=!1,document.body.classList.remove("has-modal-open"),this.$router.push("/operation/module/createModule")}},beforeRouteLeave:function(e,t,a){clearTimeout(this.timerId),a()},created:function(){this.getApplyInfo()}},we={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"page_operation_install_and_publish"},[a("let-form",{ref:"detailForm",attrs:{"label-position":"top"}},[a("let-form-group",{attrs:{title:e.$t("common.baseInfo"),inline:"","label-position":"top"}},[a("let-form-item",{attrs:{label:e.$t("apply.name"),itemWidth:"240px",required:""}},[e._v("\n        "+e._s(e.apply.name)+"\n      ")]),e._v(" "),a("let-form-item",{attrs:{label:e.$t("common.admin"),itemWidth:"240px",required:""}},[e._v("\n        "+e._s(e.apply.admin)+"\n      ")]),e._v(" "),a("let-form-item",{attrs:{label:e.$t("region.idcArea"),itemWidth:"240px",required:""}},[e._v("\n        "+e._s(e.apply.idc_area)+"\n      ")]),e._v(" "),a("let-form-item",{attrs:{label:e.$t("region.setArea"),itemWidth:"240px",required:""}},[e._v("\n        "+e._s(e.apply.set_area.join(","))+"\n      ")]),e._v(" "),a("let-form-item",{attrs:{label:e.$t("common.createPerson"),itemWidth:"240px",required:""}},[e._v("\n        "+e._s(e.apply.create_person)+"\n      ")])],1),e._v(" "),a("let-form-group",{attrs:{title:e.$t("apply.RouterConfigInfo"),inline:"","label-position":"top"}},[a("let-form-item",{attrs:{label:e.$t("service.serverName"),itemWidth:"240px",required:""}},[e._v("\n        "+e._s(e.apply.Router.server_name)+"\n      ")]),e._v(" "),a("let-form-item",{attrs:{label:e.$t("service.serverIp"),itemWidth:"240px",required:""}},[e._v("\n        "+e._s(e.apply.Router.server_ip)+"\n      ")]),e._v(" "),a("let-form-item",{attrs:{label:e.$t("service.templateFile"),itemWidth:"240px",required:""}},[e._v("\n        "+e._s(e.apply.Router.template_file)+"\n      ")]),e._v(" "),a("let-form-item",{attrs:{label:e.$t("service.routerDbName"),itemWidth:"240px",required:""}},[e._v("\n        "+e._s(e.apply.Router.router_db_name)+"\n      ")]),e._v(" "),a("br"),e._v(" "),a("let-form-item",{attrs:{label:e.$t("service.routerDbIp"),itemWidth:"240px",required:""}},[e._v("\n        "+e._s(e.apply.Router.router_db_ip)+"\n      ")]),e._v(" "),a("let-form-item",{attrs:{label:e.$t("service.routerDbPort"),itemWidth:"240px",required:""}},[e._v("\n        "+e._s(e.apply.Router.router_db_port)+"\n      ")]),e._v(" "),a("let-form-item",{attrs:{label:e.$t("service.routerDbUser"),itemWidth:"240px",required:""}},[e._v("\n        "+e._s(e.apply.Router.router_db_user)+"\n      ")]),e._v(" "),a("let-form-item",{attrs:{label:e.$t("service.routerDbPass"),itemWidth:"240px",required:""}},[e._v("\n        "+e._s(e.apply.Router.router_db_pass)+"\n      ")])],1),e._v(" "),a("let-form-group",{attrs:{title:e.$t("apply.ProxyConfigInfo"),inline:"","label-position":"top"}},[a("let-table",{ref:"table",attrs:{data:e.apply.Proxy,"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{title:e.$t("service.serverName"),prop:"server_name",width:"25%"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(t.row.server_name)+"\n          ")]}}])}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("service.multipleIp"),prop:"server_ip",width:"25%"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(t.row.server_ip)+"\n          ")]}}])}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("region.idcArea"),prop:"idc_area"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(t.row.idc_area)+"\n          ")]}}])}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("service.templateFile"),prop:"template_file"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(t.row.template_file)+"\n          ")]}}])})],1)],1),e._v(" "),a("let-button",{attrs:{size:"small",theme:"primary"},on:{click:e.installAndPublish}},[e._v(e._s(e.$t("apply.installAndPublish"))+"\n    ")])],1),e._v(" "),a("let-modal",{attrs:{title:e.$t("publishLog.title"),width:"800px"},on:{"on-confirm":e.confirmPublish},model:{value:e.showModal,callback:function(t){e.showModal=t},expression:"showModal"}},[a("let-table",{ref:"ProgressTable",staticStyle:{"margin-top":"20px"},attrs:{data:e.items,"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{title:e.$t("module.title"),prop:"module",width:"20%"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("publishLog.releaseId"),prop:"releaseId",width:"20%"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("publishLog.releaseProgress"),prop:"percent"}})],1)],1)],1)},staticRenderFns:[]};var ke=a("VU/8")(ye,we,!1,function(e){a("0ri5")},null,null).exports,xe={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page_operation_module"},[a("let-steps",{staticClass:"apply_steps",attrs:{current:e.step}},[a("let-step",{attrs:{title:e.$t(e.title1)}}),e._v(" "),a("let-step",{attrs:{title:e.$t(e.title2)}}),e._v(" "),a("let-step",{attrs:{title:e.$t(e.title3)}}),e._v(" "),a("let-step",{attrs:{title:e.$t(e.title4)}})],1),e._v(" "),a("router-view",{staticClass:"page_operation_apply_children"})],1)},staticRenderFns:[]};var Ce=a("VU/8")({data:function(){var e=this.$route.fullPath,t=1;return e.indexOf("createApply")>-1?t=1:e.indexOf("moduleConfig")>-1?t=2:e.indexOf("serverConfig")>-1?t=3:e.indexOf("installAndPublish")>-1&&(t=4),{title1:"module.createModule",title2:"module.moduleConfig",title3:"module.serverConfig",title4:"apply.installAndPublish",step:t}},watch:{$route:function(e,t){var a=e.fullPath;a.indexOf("createApply")>-1?this.step=1:a.indexOf("moduleConfig")>-1?this.step=2:a.indexOf("serverConfig")>-1?this.step=3:a.indexOf("installAndPublish")>-1&&(this.step=4)}},methods:{}},xe,!1,function(e){a("qneH")},null,null).exports,Se=[{key:"1-0",value:"key-value(KVCache)"},{key:"2-1",value:"k-k-row(MKVCache)"},{key:"2-2",value:"Set(MKVCache)"},{key:"2-3",value:"List(MKVCache)"},{key:"2-4",value:"Zset(MKVCache)"}],Le={data:function(){return{model:{apply_id:"",follower:"",cache_version:"",mkcache_struct:""},applys:[],types:Se}},computed:{type:{get:function(){return this.model.cache_version?this.model.cache_version+"-"+this.model.mkcache_struct:""},set:function(e){var t=e.split("-");this.model.cache_version=t[0],this.model.mkcache_struct=t[1]}}},methods:{createModule:function(){var e=this;if(this.$refs.detailForm.validate()){var t=this.model,a=this.$Loading.show();this.$ajax.postJSON("/server/api/add_module_base_info",t).then(function(t){a.hide(),e.$tip.success(e.$t("common.success")),e.$router.push("/operation/module/moduleConfig/"+t.id)}).catch(function(t){a.hide(),e.$tip.error(e.$t("common.error")+": "+(t.message||t.err_msg))})}}},beforeRouteEnter:function(e,t,a){o.a.getJSON("/server/api/get_apply_list").then(function(e){e.length?a(function(t){t.applys=e}):a(function(e){e.$tip.warning(e.$t("common.warning")+": "+e.$t("module.createApplyTips")),e.$router.push("/operation/apply/createApply")})}).catch(function(e){alert(e.message||e.err_msg)})}},De={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"page_operation_create_module"},[a("let-form",{ref:"detailForm",attrs:{inline:""}},[a("let-form-item",{attrs:{label:e.$t("apply.title"),itemWidth:"240px",required:""}},[a("let-select",{attrs:{size:"small",required:"","required-tip":e.$t("deployService.table.tips.empty")},model:{value:e.model.apply_id,callback:function(t){e.$set(e.model,"apply_id",t)},expression:"model.apply_id"}},e._l(e.applys,function(t){return a("let-option",{key:t.id,attrs:{value:t.id}},[e._v("\n            "+e._s(t.name)+"\n          ")])}),1)],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("module.cacheType"),itemWidth:"240px",required:""}},[a("let-select",{attrs:{size:"small",required:"","required-tip":e.$t("deployService.table.tips.empty")},model:{value:e.type,callback:function(t){e.type=t},expression:"type"}},e._l(e.types,function(t){return a("let-option",{key:t.key,attrs:{value:t.key}},[e._v("\n            "+e._s(t.value)+"\n          ")])}),1)],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("module.follower"),itemWidth:"240px"}},[a("let-input",{attrs:{size:"small"},model:{value:e.model.follower,callback:function(t){e.$set(e.model,"follower",t)},expression:"model.follower"}})],1),e._v(" "),a("div",[a("let-button",{attrs:{size:"small",theme:"primary"},on:{click:e.createModule}},[e._v(e._s(e.$t("common.nextStep")))])],1)],1)],1)},staticRenderFns:[]};var Ne=a("VU/8")(Le,De,!1,function(e){a("fT6T")},null,null).exports,Ae=[{key:"1",value:"cache.title"},{key:"2",value:"cache.cachePersistent"}],Fe=[{key:"0",value:"string"},{key:"1",value:"int"},{key:"2",value:"longlong"}],Te={data:function(){return{cacheTypeOption:[{value:"1",text:this.$t("cache.cacheTypeTip1")},{value:"2",text:this.$t("cache.cacheTypeTip2")},{value:"3",text:this.$t("cache.cacheTypeTip3")}],keyTypeOption:Fe,cacheModuleType:Ae,regions:[],setRegions:[],module:{cache_version:1},model:{admin:"",idc_area:"",key_type:null,module_name:"",cache_module_type:"",cache_type:"",db_data_count:"",per_record_avg:"",total_record:"",max_read_flow:"",max_write_flow:"",module_remark:"",set_area:[],module_id:"",apply_id:""}}},methods:{addModuleConfig:function(){var e=this;if(this.$refs.detailForm.validate()){var t=this.model,a=this.$Loading.show();this.$ajax.postJSON("/server/api/add_module_config",t).then(function(t){a.hide(),e.$tip.success(e.$t("common.success")),e.$router.push("/operation/module/serverConfig/"+t.module_id)}).catch(function(t){a.hide(),e.$tip.error(e.$t("common.error")+": "+(t.message||t.err_msg))})}},changeSelect:function(){var e=this;this.model.set_area=[];var t=this.regions.concat();t.splice(t.indexOf(t.find(function(t){return t.label==e.model.idc_area})),1),this.setRegions=t},getRegionList:function(){var e=this;this.$ajax.getJSON("/server/api/get_region_list").then(function(t){t.length&&(e.regions=t)}).catch(function(t){e.$tip.error(e.$t("common.error")+": "+(t.message||t.err_msg))})},getModuleInfo:function(){var e=this,t=this.$route.params.moduleId;this.$ajax.getJSON("/server/api/get_module_info",{moduleId:t}).then(function(t){e.model.apply_id=t.apply_id,e.model.module_id=t.id,e.module=t}).catch(function(t){e.$tip.error(e.$t("common.error")+": "+(t.message||t.err_msg))})}},created:function(){this.getRegionList(),this.getModuleInfo()}},qe={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"page_operation_module_info"},[a("let-form",{ref:"detailForm",attrs:{inline:""}},[a("let-form-item",{attrs:{label:e.$t("module.name"),itemWidth:"240px",required:""}},[a("let-input",{attrs:{size:"small",placeholder:e.$t("module.namingRule"),required:"","required-tip":e.$t("deployService.table.tips.empty")},model:{value:e.model.module_name,callback:function(t){e.$set(e.model,"module_name",t)},expression:"model.module_name"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("module.deployArea"),itemWidth:"240px"}},[a("let-select",{attrs:{size:"small"},on:{change:e.changeSelect},model:{value:e.model.idc_area,callback:function(t){e.$set(e.model,"idc_area",t)},expression:"model.idc_area"}},e._l(e.regions,function(t){return a("let-option",{key:t.label,attrs:{value:t.label}},[e._v("\n          "+e._s(t.region)+"\n        ")])}),1)],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("region.setArea"),itemWidth:"240px"}},[a("let-select",{attrs:{size:"small",multiple:!0},model:{value:e.model.set_area,callback:function(t){e.$set(e.model,"set_area",t)},expression:"model.set_area"}},e._l(e.setRegions,function(t){return a("let-option",{key:t.label,attrs:{value:t.label}},[e._v("\n          "+e._s(t.region)+"\n        ")])}),1)],1),e._v(" "),a("br"),e._v(" "),a("let-form-item",{attrs:{label:e.$t("cache.perRecordAvg"),itemWidth:"240px",required:""}},[a("let-input",{attrs:{size:"small",placeholder:e.$t("cache.perRecordAvgUnit"),required:"","required-tip":e.$t("deployService.table.tips.empty")},model:{value:e.model.per_record_avg,callback:function(t){e.$set(e.model,"per_record_avg",t)},expression:"model.per_record_avg"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("cache.totalRecord"),itemWidth:"240px",required:""}},[a("let-input",{attrs:{size:"small",placeholder:e.$t("cache.dbDataCountUnit"),required:"","required-tip":e.$t("deployService.table.tips.empty")},model:{value:e.model.total_record,callback:function(t){e.$set(e.model,"total_record",t)},expression:"model.total_record"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("cache.maxReadFlow"),itemWidth:"240px",required:""}},[a("let-input",{attrs:{size:"small",placeholder:e.$t("cache.flowUnit"),required:"","required-tip":e.$t("deployService.table.tips.empty")},model:{value:e.model.max_read_flow,callback:function(t){e.$set(e.model,"max_read_flow",t)},expression:"model.max_read_flow"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("cache.maxWriteFlow"),itemWidth:"240px",required:""}},[a("let-input",{attrs:{size:"small",placeholder:e.$t("cache.flowUnit"),required:"","required-tip":e.$t("deployService.table.tips.empty")},model:{value:e.model.max_write_flow,callback:function(t){e.$set(e.model,"max_write_flow",t)},expression:"model.max_write_flow"}})],1),e._v(" "),a("br"),e._v(" "),a("let-form-item",{attrs:{label:e.$t("module.scenario"),itemWidth:"240px",required:""}},[a("let-select",{attrs:{size:"small",required:"","required-tip":e.$t("deployService.table.tips.empty")},model:{value:e.model.cache_module_type,callback:function(t){e.$set(e.model,"cache_module_type",t)},expression:"model.cache_module_type"}},e._l(e.cacheModuleType,function(t){return a("let-option",{key:t.key,attrs:{value:t.key}},[e._v("\n          "+e._s(e.$t(t.value))+"\n        ")])}),1)],1),e._v(" "),1==e.model.cache_module_type?a("let-form-item",{attrs:{label:e.$t("cache.cacheType"),itemWidth:"500px",required:""}},[a("let-radio-group",{attrs:{size:"small",required:"",data:e.cacheTypeOption},model:{value:e.model.cache_type,callback:function(t){e.$set(e.model,"cache_type",t)},expression:"model.cache_type"}})],1):e._e(),e._v(" "),2==e.model.cache_module_type?a("let-form-item",{attrs:{label:e.$t("cache.persistentNumber"),itemWidth:"240px",required:""}},[a("let-input",{attrs:{size:"small",placeholder:e.$t("cache.dbDataCountUnit"),required:"","required-tip":e.$t("deployService.table.tips.empty")},model:{value:e.model.db_data_count,callback:function(t){e.$set(e.model,"db_data_count",t)},expression:"model.db_data_count"}})],1):e._e(),e._v(" "),a("br"),e._v(" "),a("let-form-item",{attrs:{label:e.$t("cache.moduleRemark"),itemWidth:"516px",required:""}},[a("let-input",{attrs:{size:"small",type:"textarea",rows:4,required:"","required-tip":e.$t("deployService.table.tips.empty")},model:{value:e.model.module_remark,callback:function(t){e.$set(e.model,"module_remark",t)},expression:"model.module_remark"}})],1),e._v(" "),a("div",[a("let-button",{attrs:{size:"small",theme:"primary"},on:{click:e.addModuleConfig}},[e._v(e._s(e.$t("common.nextStep")))])],1)],1)],1)},staticRenderFns:[]};var Pe=a("VU/8")(Te,qe,!1,function(e){a("52cW")},null,null).exports,Re=a("mvHQ"),Oe=a.n(Re),Ie=[{key:"int",value:"int"},{key:"long",value:"long"},{key:"string",value:"string"},{key:"byte",value:"byte"},{key:"float",value:"float"},{key:"double",value:"double"}],je=[{key:"require",value:"require"},{key:"optional",value:"optional"}],ze={data:function(){return{moduleId:this.$route.params.moduleId,moduleData:[],isMkCache:!1,multiKey:!1,dataTypeOption:Ie,propertyOption:je,showMKModal:!1,mkCacheStructure:{mainKey:[{fieldName:"",keyType:"mkey",dataType:"",property:"require",defaultValue:"",maxLen:""}],unionKey:[{fieldName:"",keyType:"ukey",dataType:"",property:"require",defaultValue:"",maxLen:""}],value:[{fieldName:"",keyType:"value",dataType:"",property:"",defaultValue:"",maxLen:""}]}}},methods:{submitServerConfig:function(){this.$refs.detailForm.validate()&&(this.isMkCache?this.showMKModal=!0:this.addServerConfig())},addServerConfig:function(){var e=this,t=this.moduleData,a=this.$Loading.show();this.$ajax.postJSON("/server/api/add_server_config",t).then(function(t){a.hide(),e.$tip.success(e.$t("common.success")),e.$router.push("/operation/module/installAndPublish/"+e.moduleId)}).catch(function(t){a.hide(),e.$tip.error(e.$t("common.error")+": "+(t.message||t.err_msg))})},getModuleConfigInfo:function(){var e=this,t=this.$route.params.moduleId;this.$ajax.getJSON("/server/api/get_module_config_info",{moduleId:t}).then(function(t){var a=1===t.ModuleBase.cache_version?"KV":"MKV";t.group_name=t.module_name+a+"Group1",t.area=t.idc_area,t.server_name=t.module_name+a+"CacheServer1-1",t.server_type=0,t.memory=Math.ceil(t.per_record_avg*t.total_record*1e4/1024/1024/1024),e.moduleData.push(t);var r=C()({},t);r.server_name=t.module_name+a+"CacheServer1-2",r.server_type=1,e.moduleData.push(r),t.set_area.length>0&&t.set_area.forEach(function(r,o){var s=C()({},t);s.area=r,s.server_name=t.module_name+a+"CacheServer1-"+(o+3),s.server_type=2,e.moduleData.push(s)}),e.isMkCache=2===t.ModuleBase.cache_version,e.multiKey=2===t.ModuleBase.cache_version&&1===t.ModuleBase.mkcache_struct}).catch(function(t){e.$tip.error(e.$t("common.error")+": "+(t.message||t.err_msg))})},mapServerType:function(e){return 0===e?this.$t("module.mainServer"):1===e?this.$t("module.backServer"):this.$t("module.mirror")},addUnionKey:function(){this.mkCacheStructure.unionKey.push({fieldName:"",keyType:"ukey",dataType:"",property:"require",defaultValue:"",maxLen:""})},deleteUnionKey:function(e){this.mkCacheStructure.unionKey.length>1?this.mkCacheStructure.unionKey.splice(e,1):this.$tip.error(this.$t("MKCache.error"))},addValue:function(){this.mkCacheStructure.value.push({fieldName:"",keyType:"value",dataType:"",property:"",defaultValue:"",maxLen:""})},deleteValue:function(e){this.mkCacheStructure.value.length>1?this.mkCacheStructure.value.splice(e,1):this.$tip.error(this.$t("MKCache.error"))},submitMKCache:function(){this.$refs.multiKeyForm.validate()&&(sessionStorage.setItem("mkCache",Oe()(this.mkCacheStructure)),this.showMKModal=!1,this.addServerConfig())}},created:function(){var e=this;return N()(L.a.mark(function t(){return L.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return sessionStorage.clear(),t.next=3,e.getModuleConfigInfo();case 3:case"end":return t.stop()}},t,e)}))()}},Ee={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"page_operation_create_service"},[a("let-form",{ref:"detailForm",attrs:{inline:""}},[a("let-form-group",{attrs:{title:e.$t("module.serverInfo"),inline:"","label-position":"top"}},[a("let-table",{ref:"table",attrs:{data:e.moduleData,"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{title:e.$t("module.name"),prop:"module_name",width:"20%"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(t.row.module_name)+"\n          ")]}}])}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("module.serverGroup"),prop:"group_name",width:"15%"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(t.row.group_name)+"\n          ")]}}])}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("service.serverName"),prop:"server_name",width:"20%"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(t.row.server_name)+"\n          ")]}}])}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("service.serverIp"),prop:"server_ip"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-input",{attrs:{size:"small",required:"","required-tip":e.$t("deployService.table.tips.empty")},model:{value:t.row.server_ip,callback:function(a){e.$set(t.row,"server_ip",a)},expression:"scope.row.server_ip"}})]}}])}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("module.deployArea"),prop:"area"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(t.row.area)+"\n          ")]}}])}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("deployService.form.serviceType"),prop:"server_type"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(e.mapServerType(t.row.server_type))+"\n          ")]}}])}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("module.memorySize"),prop:"memory"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(t.row.memory)+"\n          ")]}}])}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("module.shmKey"),prop:"shmKey"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-input",{attrs:{size:"small",placeholder:e.$t("module.shmKeyRule"),required:"","required-tip":e.$t("deployService.table.tips.empty")},model:{value:t.row.shmKey,callback:function(a){e.$set(t.row,"shmKey",a)},expression:"scope.row.shmKey"}})]}}])})],1)],1),e._v(" "),a("div",[a("let-button",{attrs:{size:"small",theme:"primary"},on:{click:e.submitServerConfig}},[e._v(e._s(e.$t("common.nextStep")))])],1)],1),e._v(" "),a("let-modal",{attrs:{title:e.$t("module.MultiKeyConfig"),width:"1000px"},on:{"on-confirm":e.submitMKCache},model:{value:e.showMKModal,callback:function(t){e.showMKModal=t},expression:"showMKModal"}},[a("let-form",{ref:"multiKeyForm",attrs:{"label-position":"top"}},[a("let-form-group",{attrs:{title:e.$t("MKCache.mainKey"),inline:"","label-position":"top"}},[a("let-table",{ref:"mainKey",attrs:{data:e.mkCacheStructure.mainKey,"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{title:e.$t("MKCache.fieldName"),prop:"fieldName",width:"30%"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-input",{attrs:{size:"small",required:"","required-tip":e.$t("deployService.table.tips.empty")},model:{value:t.row.fieldName,callback:function(a){e.$set(t.row,"fieldName",a)},expression:"scope.row.fieldName"}})]}}])}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("MKCache.dataType"),prop:"dataType"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-select",{attrs:{size:"small",required:"","required-tip":e.$t("deployService.table.tips.empty")},model:{value:t.row.dataType,callback:function(a){e.$set(t.row,"dataType",a)},expression:"scope.row.dataType"}},e._l(e.dataTypeOption,function(t){return a("let-option",{key:t.key,attrs:{value:t.value}},[e._v("\n                  "+e._s(t.value)+"\n                ")])}),1)]}}])}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("MKCache.fieldProperty"),prop:"property",width:"15%"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(t.row.property)+"\n            ")]}}])}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("MKCache.defaultValue"),prop:"defaultValue"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-input",{attrs:{size:"small"},model:{value:t.row.defaultValue,callback:function(a){e.$set(t.row,"defaultValue",a)},expression:"scope.row.defaultValue"}})]}}])}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("MKCache.maxLen"),prop:"maxLen"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-input",{attrs:{size:"small"},model:{value:t.row.maxLen,callback:function(a){e.$set(t.row,"maxLen",a)},expression:"scope.row.maxLen"}})]}}])})],1)],1),e._v(" "),e.multiKey?a("let-form-group",{attrs:{title:e.$t("MKCache.unionKey"),inline:"","label-position":"top"}},[a("let-table",{ref:"unionKey",attrs:{data:e.mkCacheStructure.unionKey,"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{title:e.$t("MKCache.fieldName"),prop:"fieldName",width:"25%"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-input",{attrs:{size:"small",required:"","required-tip":e.$t("deployService.table.tips.empty")},model:{value:t.row.fieldName,callback:function(a){e.$set(t.row,"fieldName",a)},expression:"scope.row.fieldName"}})]}}],null,!1,4011857556)}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("MKCache.dataType"),prop:"dataType"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-select",{attrs:{size:"small",required:"","required-tip":e.$t("deployService.table.tips.empty")},model:{value:t.row.dataType,callback:function(a){e.$set(t.row,"dataType",a)},expression:"scope.row.dataType"}},e._l(e.dataTypeOption,function(t){return a("let-option",{key:t.key,attrs:{value:t.value}},[e._v("\n                  "+e._s(t.value)+"\n                ")])}),1)]}}],null,!1,1906165843)}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("MKCache.fieldProperty"),prop:"property",width:"15%"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(t.row.property)+"\n            ")]}}],null,!1,1274096314)}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("MKCache.defaultValue"),prop:"defaultValue"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-input",{attrs:{size:"small"},model:{value:t.row.defaultValue,callback:function(a){e.$set(t.row,"defaultValue",a)},expression:"scope.row.defaultValue"}})]}}],null,!1,3960107341)}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("MKCache.maxLen"),prop:"maxLen"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-input",{attrs:{size:"small"},model:{value:t.row.maxLen,callback:function(a){e.$set(t.row,"maxLen",a)},expression:"scope.row.maxLen"}})]}}],null,!1,112591966)}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("operate.operates"),width:"15%"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-table-operation",{on:{click:e.addUnionKey}},[e._v(e._s(e.$t("operate.add")))]),e._v(" "),a("let-table-operation",{on:{click:function(a){return e.deleteUnionKey(t.$index)}}},[e._v(e._s(e.$t("operate.delete")))])]}}],null,!1,1394424424)})],1)],1):e._e(),e._v(" "),a("let-form-group",{attrs:{title:e.$t("MKCache.dataValue"),inline:"","label-position":"top"}},[a("let-table",{ref:"dataValue",attrs:{data:e.mkCacheStructure.value,"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{title:e.$t("MKCache.fieldName"),prop:"fieldName",width:"25%"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-input",{attrs:{size:"small",required:"","required-tip":e.$t("deployService.table.tips.empty")},model:{value:t.row.fieldName,callback:function(a){e.$set(t.row,"fieldName",a)},expression:"scope.row.fieldName"}})]}}])}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("MKCache.dataType"),prop:"dataType"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-select",{attrs:{size:"small",required:"","required-tip":e.$t("deployService.table.tips.empty")},model:{value:t.row.dataType,callback:function(a){e.$set(t.row,"dataType",a)},expression:"scope.row.dataType"}},e._l(e.dataTypeOption,function(t){return a("let-option",{key:t.key,attrs:{value:t.value}},[e._v("\n                  "+e._s(t.value)+"\n                ")])}),1)]}}])}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("MKCache.fieldProperty"),prop:"property",width:"15%"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-select",{attrs:{size:"small",required:"","required-tip":e.$t("deployService.table.tips.empty")},model:{value:t.row.property,callback:function(a){e.$set(t.row,"property",a)},expression:"scope.row.property"}},e._l(e.propertyOption,function(t){return a("let-option",{key:t.key,attrs:{value:t.value}},[e._v("\n                  "+e._s(t.value)+"\n                ")])}),1)]}}])}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("MKCache.defaultValue"),prop:"defaultValue"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-input",{attrs:{size:"small",required:"","required-tip":e.$t("deployService.table.tips.empty")},model:{value:t.row.defaultValue,callback:function(a){e.$set(t.row,"defaultValue",a)},expression:"scope.row.defaultValue"}})]}}])}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("MKCache.maxLen"),prop:"maxLen"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-input",{attrs:{size:"small",required:"","required-tip":e.$t("deployService.table.tips.empty")},model:{value:t.row.maxLen,callback:function(a){e.$set(t.row,"maxLen",a)},expression:"scope.row.maxLen"}})]}}])}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("operate.operates"),width:"15%"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-table-operation",{on:{click:e.addValue}},[e._v(e._s(e.$t("operate.add")))]),e._v(" "),a("let-table-operation",{on:{click:function(a){return e.deleteValue(t.$index)}}},[e._v(e._s(e.$t("operate.delete")))])]}}])})],1)],1)],1)],1)],1)},staticRenderFns:[]},Ve=a("VU/8")(ze,Ee,!1,null,null,null).exports,We={data:function(){return{moduleId:this.$route.params.moduleId,moduleData:{},releaseProgress:[],showModal:!1,timerId:null}},methods:{getModuleFullInfo:function(){var e=this,t=this.moduleId;this.$ajax.getJSON("/server/api/get_module_full_info",{moduleId:t}).then(function(t){e.moduleData=t||{}}).catch(function(t){e.$tip.error(e.$t("common.error")+": "+(t.message||t.err_msg))})},installAndPublish:function(){var e=this,t=this.moduleId,a=sessionStorage.getItem("mkCache");this.$ajax.getJSON("/server/api/module_install_and_publish",{moduleId:t,mkCache:a}).then(function(t){var a=t.releaseRsp.releaseId;e.getTaskRepeat({releaseId:a}),e.$tip.success(t.releaseRsp.errMsg)}).catch(function(t){e.$tip.error(e.$t("common.error")+": "+(t.message||t.err_msg))})},getTaskRepeat:function(e){var t=this,a=e.releaseId;clearTimeout(this.timerId),this.showModal=!0;!function e(){t.$ajax.getJSON("/server/api/get_module_release_progress",{releaseId:a}).then(function(a){var r=!0;a.progress.forEach(function(e){100!==parseInt(e.percent,10)&&(r=!1)}),r?clearTimeout(t.timerId):t.timerId=setTimeout(e,1e3),t.releaseProgress=a.progress}).catch(function(e){clearTimeout(t.timerId),t.$tip.error(t.$t("common.error")+": "+(e.message||e.err_msg))})}()},getReleaseProgress:function(e){var t=this;this.$ajax.getJSON("/server/api/get_module_release_progress",{releaseId:e}).then(function(e){console.log(e),t.showModal=!0,t.releaseProgress=e.progress}).catch(function(e){t.$tip.error(t.$t("common.error")+": "+(e.message||e.err_msg))})},mapServerType:function(e){return 0===e?this.$t("module.mainServer"):1===e?this.$t("module.backServer"):this.$t("module.mirror")},mapModuleType:function(e){return 1===e?this.$t("cache.title"):this.$t("cache.cachePersistent")},mapCacheType:function(e){if(!e)return null;if(1===e.cache_version)return"key-value(KVCache)";switch(e.mkcache_struct){case 1:return"k-k-row(MKVCache)";case 2:return"Set(MKVCache)";case 3:return"List(MKVCache)";case 4:return"Zset(MKVCache)";default:return null}},confirmPublish:function(){this.showModal=!1,document.body.classList.remove("has-modal-open"),this.$router.push("/server"),window.dcacheIndex&&window.dcacheIndex.getTreeData&&window.dcacheIndex.getTreeData()}},beforeRouteLeave:function(e,t,a){clearTimeout(this.timerId),a()},created:function(){this.getModuleFullInfo()}},Je={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"page_operation_install_and_publish"},[a("let-form",{ref:"detailForm",attrs:{"label-position":"top"}},[a("let-form-group",{attrs:{title:e.$t("common.baseInfo"),inline:"","label-position":"top"}},[a("let-form-item",{attrs:{label:e.$t("module.moduleId"),itemWidth:"240px",required:""}},[e._v("\n        "+e._s(e.moduleData.module_id)+"\n      ")]),e._v(" "),a("let-form-item",{attrs:{label:e.$t("module.name"),itemWidth:"240px",required:""}},[e._v("\n        "+e._s(e.moduleData.module_name)+"\n      ")]),e._v(" "),a("let-form-item",{attrs:{label:e.$t("module.cacheType"),itemWidth:"240px",required:""}},[e._v("\n        "+e._s(e.mapCacheType(e.moduleData.ModuleBase))+"\n      ")]),e._v(" "),a("let-form-item",{attrs:{label:e.$t("module.follower"),itemWidth:"240px",required:""}},[e._v("\n        "+e._s(e.moduleData.ModuleBase&&e.moduleData.ModuleBase.follower)+"\n      ")])],1),e._v(" "),a("let-form-group",{attrs:{title:e.$t("module.moduleInfo"),inline:"","label-position":"top"}},[a("let-form-item",{attrs:{label:e.$t("module.deployArea"),itemWidth:"240px"}},[e._v("\n        "+e._s(e.moduleData.idc_area)+"\n      ")]),e._v(" "),a("let-form-item",{attrs:{label:e.$t("region.setArea"),itemWidth:"240px"}},[e._v("\n        "+e._s(e.moduleData.set_area&&e.moduleData.set_area.join(","))+"\n      ")]),e._v(" "),a("let-form-item",{attrs:{label:e.$t("module.scenario"),itemWidth:"240px",required:""}},[e._v("\n        "+e._s(e.mapModuleType(e.moduleData.cache_module_type))+"\n      ")]),e._v(" "),a("let-form-item",{attrs:{label:e.$t("cache.perRecordAvg"),itemWidth:"240px",required:""}},[e._v("\n        "+e._s(e.moduleData.per_record_avg)+"\n      ")]),e._v(" "),a("let-form-item",{attrs:{label:e.$t("cache.maxReadFlow"),itemWidth:"240px",required:""}},[e._v("\n        "+e._s(e.moduleData.max_read_flow)+"\n      ")]),e._v(" "),a("let-form-item",{attrs:{label:e.$t("cache.totalRecord"),itemWidth:"240px",required:""}},[e._v("\n        "+e._s(e.moduleData.total_record)+"\n      ")]),e._v(" "),a("let-form-item",{attrs:{label:e.$t("cache.maxWriteFlow"),itemWidth:"240px",required:""}},[e._v("\n        "+e._s(e.moduleData.max_write_flow)+"\n      ")]),e._v(" "),a("let-form-item",{attrs:{label:e.$t("cache.moduleRemark"),itemWidth:"240px",required:""}},[e._v("\n        "+e._s(e.moduleData.module_remark)+"\n      ")])],1),e._v(" "),a("let-form-group",{attrs:{title:e.$t("module.serverInfo"),inline:"","label-position":"top"}},[a("let-table",{ref:"table",attrs:{data:e.moduleData.ServerConf,"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{title:e.$t("module.name"),prop:"module_name",width:"25%"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(t.row.module_name)+"\n          ")]}}])}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("module.serverGroup"),prop:"group_name",width:"25%"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(t.row.group_name)+"\n          ")]}}])}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("service.serverName"),prop:"server_name"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(t.row.server_name)+"\n          ")]}}])}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("service.serverIp"),prop:"server_ip"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(t.row.server_ip)+"\n          ")]}}])}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("module.deployArea"),prop:"area"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(t.row.area)+"\n          ")]}}])}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("deployService.form.serviceType"),prop:"server_type"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(e.mapServerType(t.row.server_type))+"\n          ")]}}])}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("module.memorySize"),prop:"memory"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(t.row.memory)+"\n          ")]}}])}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("module.shmKey"),prop:"shmKey"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(t.row.shmKey)+"\n          ")]}}])})],1)],1),e._v(" "),a("let-button",{attrs:{size:"small",theme:"primary"},on:{click:e.installAndPublish}},[e._v(e._s(e.$t("apply.installAndPublish"))+"\n    ")])],1),e._v(" "),a("let-modal",{attrs:{title:e.$t("publishLog.title"),width:"800px"},on:{"on-confirm":e.confirmPublish},model:{value:e.showModal,callback:function(t){e.showModal=t},expression:"showModal"}},[a("let-table",{ref:"ProgressTable",attrs:{data:e.releaseProgress,"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{title:e.$t("service.serverName"),prop:"serverName",width:"30%"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("service.serverIp"),prop:"nodeName",width:"30%"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("publishLog.releaseId"),prop:"releaseId",width:"15%"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("publishLog.releaseProgress"),prop:"percent"}})],1)],1)],1)},staticRenderFns:[]},Ue=a("VU/8")(We,Je,!1,null,null,null).exports,Be={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"page_operation_region"},[a("let-button",{attrs:{theme:"primary",size:"mini"},on:{click:e.addRegion}},[e._v(e._s(e.$t("region.add")))]),e._v(" "),a("let-table",{ref:"table",attrs:{data:e.items,"empty-msg":e.$t("common.nodata"),title:e.$t("region.list")}},[a("let-table-column",{attrs:{title:e.$t("common.serial"),width:"25%"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.$index+1))]}}])}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("region.title"),prop:"region",width:"25%"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("region.label"),prop:"label"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("operate.operates"),width:"180px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-table-operation",{on:{click:function(a){return e.editRegion(t.row)}}},[e._v(e._s(e.$t("operate.update")))]),e._v(" "),a("let-table-operation",{on:{click:function(a){return e.removeItem(t.row)}}},[e._v(e._s(e.$t("operate.delete")))])]}}])})],1),e._v(" "),a("let-modal",{attrs:{title:e.$t(e.title),width:"600px"},on:{"on-confirm":e.saveItem},model:{value:e.showModel,callback:function(t){e.showModel=t},expression:"showModel"}},[a("let-form",{ref:"detailForm"},[a("let-form-item",{attrs:{label:e.$t("region.title"),required:""}},[a("let-input",{attrs:{size:"small",required:"",placeholder:e.$t("region.regionTips")},model:{value:e.model.region,callback:function(t){e.$set(e.model,"region",t)},expression:"model.region"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("region.label"),required:""}},[a("let-input",{attrs:{size:"small",required:"",placeholder:e.$t("region.labelTips")},model:{value:e.model.label,callback:function(t){e.$set(e.model,"label",t)},expression:"model.label"}})],1)],1)],1)],1)},staticRenderFns:[]};var Ge=a("VU/8")({data:function(){return{title:"region.add",items:[],showModel:!1,model:{}}},mounted:function(){this.fetchData()},methods:{fetchData:function(){var e=this;this.$ajax.getJSON("/server/api/get_region_list").then(function(t){e.items=t||[]}).catch(function(t){e.$tip.error(e.$t("common.error")+": "+(t.message||t.err_msg))})},addRegion:function(){this.showModel=!0,this.title="region.add",this.model={region:"",label:""}},editRegion:function(e){this.showModel=!0,this.showModel=!0,this.title="region.modify",this.model=e},saveItem:function(){var e=this;if(this.$refs.detailForm.validate()){var t=this.model,a=t.id?"/server/api/update_region":"/server/api/add_region",r=this.$Loading.show();this.$ajax.postJSON(a,t).then(function(){r.hide(),e.$tip.success(e.$t("common.success")),e.closeDetailModal(),e.fetchData()}).catch(function(t){r.hide(),e.$tip.error(e.$t("common.error")+": "+(t.message||t.err_msg))})}},removeItem:function(e){var t=this,a=e.id;this.$ajax.getJSON("/server/api/delete_region",{id:a}).then(function(e){t.$tip.success(t.$t("common.success")),t.fetchData()}).catch(function(e){t.$tip.error(t.$t("common.error")+": "+(e.message||e.err_msg))})},closeDetailModal:function(){this.$refs.detailForm.resetValid(),this.showModel=!1,this.model={}}}},Be,!1,function(e){a("sZcP")},null,null).exports,He={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page_operation"},[a("let-tabs",{attrs:{activekey:e.$route.matched[1]?e.$route.matched[1].path:"/operation/apply"},on:{click:e.onTabClick}},[a("let-tab-pane",{attrs:{tab:e.$t("releasePackage.proxyList"),tabkey:"/releasePackage/proxyList"}}),e._v(" "),a("let-tab-pane",{attrs:{tab:e.$t("releasePackage.routerList"),tabkey:"/releasePackage/routerList"}}),e._v(" "),a("let-tab-pane",{attrs:{tab:e.$t("releasePackage.cacheList"),tabkey:"/releasePackage/cacheList"}})],1),e._v(" "),a("router-view",{staticClass:"page_operation_children"})],1)},staticRenderFns:[]};var Ze=a("VU/8")({methods:{onTabClick:function(e){this.$router.replace(e)}}},He,!1,function(e){a("sPk+")},null,null).exports,Ke=a("Wc9H"),Ye=a.n(Ke),Xe=a("IaZV"),Qe=a.n(Xe),et=new Ye.a({id:"default",use:"default-usage",viewBox:"0 0 1024 1024",content:'<symbol class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" id="default"><defs><style></style></defs><path d="M512 0a512 512 0 1 0 512 512A512 512 0 0 0 512 0z m327.554535 373.651898l-342.957664 349.062903a109.334209 109.334209 0 0 1-77.351712 32.822668h-1.064216a109.278197 109.278197 0 0 1-76.903621-31.366372L184.837545 570.811946a36.631441 36.631441 0 1 1 51.25041-52.258615l156.383766 153.359151a36.295372 36.295372 0 0 0 25.709222 10.362105h0.39208a36.463407 36.463407 0 0 0 25.821245-10.866207l342.901651-349.118915a36.631441 36.631441 0 0 1 52.258616 51.306422z m0 0" /></symbol>'}),tt=(Qe.a.add(et),{data:function(){return{uploadModal:{show:!1,model:{application:"DCache",module_name:"ProxyServer",file:{},comment:""}},packages:{count:0,rows:[]}}},methods:{closeUploadModal:function(){this.uploadModal.show=!1},uploadFile:function(e){this.uploadModal.model.file=e},uploadPatchPackage:function(){var e=this;if(this.$refs.uploadForm.validate()){var t=this.$Loading.show(),a=new FormData;a.append("application",this.uploadModal.model.application),a.append("module_name",this.uploadModal.model.module_name),a.append("task_id",(new Date).getTime()),a.append("suse",this.uploadModal.model.file),a.append("comment",this.uploadModal.model.comment),this.$ajax.postForm("/server/api/upload_patch_package",a).then(function(){t.hide(),e.closeUploadModal(),e.getPatchPackage()}).catch(function(a){t.hide(),e.$tip.error(e.$t("common.error")+": "+(a.message||a.err_msg))})}},getPatchPackage:function(){var e=this;this.$ajax.getJSON("/server/api/server_patch_list",{application:"DCache",module_name:"ProxyServer"}).then(function(t){e.packages=t}).catch(function(t){e.$tip.error(e.$t("common.error")+": "+(t.message||t.err_msg))})},deletePackage:function(e){var t=this;this.$confirm(this.$t("releasePackage.confirmDeleteTip"),this.$t("common.alert")).then(function(){t.$ajax.postJSON("/server/api/delete_patch_package",{id:e}).then(function(e){t.getPatchPackage()})}).catch(function(e){t.$tip.error(t.$t("common.error")+": "+(e.message||e.err_msg))})},setDefault:function(e){var t=this,a=e.id,r=e.package_type;this.$ajax.postJSON("/server/api/set_patch_package_default",{id:a,package_type:r,application:this.uploadModal.model.application,module_name:this.uploadModal.model.module_name}).then(function(e){t.getPatchPackage()}).catch(function(e){t.$tip.error(t.$t("common.error")+": "+(e.message||e.err_msg))})}},created:function(){this.getPatchPackage()}}),at={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"container"},[a("div",[a("let-button",{attrs:{theme:"primary",size:"small"},on:{click:function(t){e.uploadModal.show=!e.uploadModal.show}}},[e._v("\n      "+e._s(e.$t("releasePackage.uploadPackage"))+"\n    ")])],1),e._v(" "),a("let-table",{attrs:{data:e.packages.rows,title:e.$t("serverList.title.serverList"),"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{title:"ID",prop:"id"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticStyle:{color:"green",display:"inline-block",width:"1em",height:"1em"},attrs:{title:e.$t("releasePackage.default")}},[1==t.row.default_version?a("icon",{attrs:{name:"default"}}):e._e()],1),e._v("\n        "+e._s(t.row.id)+"\n      ")]}}])}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("releasePackage.moduleName"),prop:"server"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.servant.comment"),prop:"comment"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("releasePackage.uploadTime"),prop:"posttime"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("operate.operates"),width:"260px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-table-operation",{on:{click:function(a){return e.setDefault(t.row)}}},[e._v(e._s(e.$t("operate.default")))]),e._v(" "),a("let-table-operation",{on:{click:function(a){return e.deletePackage(t.row.id)}}},[e._v(e._s(e.$t("operate.delete")))])]}}])})],1),e._v(" "),a("let-modal",{attrs:{title:e.$t("pub.dlg.upload"),width:"880px",footShow:!1},on:{"on-cancel":e.closeUploadModal},model:{value:e.uploadModal.show,callback:function(t){e.$set(e.uploadModal,"show",t)},expression:"uploadModal.show"}},[e.uploadModal.model?a("let-form",{ref:"uploadForm",attrs:{itemWidth:"100%"},nativeOn:{submit:function(t){return t.preventDefault(),e.uploadPatchPackage(t)}}},[a("let-form-item",{attrs:{label:e.$t("releasePackage.moduleName")}},[e._v("\n        "+e._s(e.uploadModal.model.application)+"."+e._s(e.uploadModal.model.module_name)+"\n      ")]),e._v(" "),a("let-form-item",{attrs:{label:e.$t("pub.dlg.releasePkg"),itemWidth:"400px"}},[a("let-uploader",{attrs:{placeholder:e.$t("pub.dlg.defaultValue")},on:{upload:e.uploadFile}},[e._v(e._s(e.$t("common.submit"))+"\n        ")]),e._v(" "),e.uploadModal.model.file?a("span",[e._v(e._s(e.uploadModal.model.file.name))]):e._e()],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("serverList.servant.comment")}},[a("let-input",{attrs:{type:"textarea",rows:3},model:{value:e.uploadModal.model.comment,callback:function(t){e.$set(e.uploadModal.model,"comment",t)},expression:"uploadModal.model.comment"}})],1),e._v(" "),a("let-button",{attrs:{type:"submit",theme:"primary"}},[e._v(e._s(e.$t("serverList.servant.upload")))])],1):e._e()],1)],1)},staticRenderFns:[]};var rt=a("VU/8")(tt,at,!1,function(e){a("6uR2")},null,null).exports,ot={data:function(){return{uploadModal:{show:!1,model:{application:"DCache",module_name:"RouterServer",file:{},comment:""}},packages:{count:0,rows:[]}}},methods:{closeUploadModal:function(){this.uploadModal.show=!1},uploadFile:function(e){this.uploadModal.model.file=e},uploadPatchPackage:function(){var e=this;if(this.$refs.uploadForm.validate()){var t=this.$Loading.show(),a=new FormData;a.append("application",this.uploadModal.model.application),a.append("module_name",this.uploadModal.model.module_name),a.append("task_id",(new Date).getTime()),a.append("suse",this.uploadModal.model.file),a.append("comment",this.uploadModal.model.comment),this.$ajax.postForm("/server/api/upload_patch_package",a).then(function(){t.hide(),e.closeUploadModal(),e.getPatchPackage()}).catch(function(a){t.hide(),e.$tip.error(e.$t("common.error")+": "+(a.message||a.err_msg))})}},getPatchPackage:function(){var e=this;this.$ajax.getJSON("/server/api/server_patch_list",{application:"DCache",module_name:"RouterServer"}).then(function(t){e.packages=t}).catch(function(t){e.$tip.error(e.$t("common.error")+": "+(t.message||t.err_msg))})},deletePackage:function(e){var t=this;this.$confirm(this.$t("releasePackage.confirmDeleteTip"),this.$t("common.alert")).then(function(){t.$ajax.postJSON("/server/api/delete_patch_package",{id:e}).then(function(e){t.getPatchPackage()})}).catch(function(e){t.$tip.error(t.$t("common.error")+": "+(e.message||e.err_msg))})},setDefault:function(e){var t=this,a=e.id,r=e.package_type;this.$ajax.postJSON("/server/api/set_patch_package_default",{id:a,package_type:r,application:this.uploadModal.model.application,module_name:this.uploadModal.model.module_name}).then(function(e){t.getPatchPackage()}).catch(function(e){t.$tip.error(t.$t("common.error")+": "+(e.message||e.err_msg))})}},created:function(){this.getPatchPackage()}},st={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"container"},[a("div",[a("let-button",{attrs:{theme:"primary",size:"small"},on:{click:function(t){e.uploadModal.show=!e.uploadModal.show}}},[e._v("\n      "+e._s(e.$t("releasePackage.uploadPackage"))+"\n    ")])],1),e._v(" "),a("let-table",{attrs:{data:e.packages.rows,title:e.$t("serverList.title.serverList"),"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{title:"ID",prop:"id"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticStyle:{color:"green",display:"inline-block",width:"1em",height:"1em"},attrs:{title:e.$t("releasePackage.default")}},[1==t.row.default_version?a("icon",{attrs:{name:"default"}}):e._e()],1),e._v("\n        "+e._s(t.row.id)+"\n      ")]}}])}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("releasePackage.moduleName"),prop:"server"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.servant.comment"),prop:"comment"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("releasePackage.uploadTime"),prop:"posttime"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("operate.operates"),width:"260px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-table-operation",{on:{click:function(a){return e.setDefault(t.row)}}},[e._v(e._s(e.$t("operate.default")))]),e._v(" "),a("let-table-operation",{on:{click:function(a){return e.deletePackage(t.row.id)}}},[e._v(e._s(e.$t("operate.delete")))])]}}])})],1),e._v(" "),a("let-modal",{attrs:{title:e.$t("pub.dlg.upload"),width:"880px",footShow:!1},on:{"on-cancel":e.closeUploadModal},model:{value:e.uploadModal.show,callback:function(t){e.$set(e.uploadModal,"show",t)},expression:"uploadModal.show"}},[e.uploadModal.model?a("let-form",{ref:"uploadForm",attrs:{itemWidth:"100%"},nativeOn:{submit:function(t){return t.preventDefault(),e.uploadPatchPackage(t)}}},[a("let-form-item",{attrs:{label:e.$t("releasePackage.moduleName")}},[e._v("\n        "+e._s(e.uploadModal.model.application)+"."+e._s(e.uploadModal.model.module_name)+"\n      ")]),e._v(" "),a("let-form-item",{attrs:{label:e.$t("pub.dlg.releasePkg"),itemWidth:"400px"}},[a("let-uploader",{attrs:{placeholder:e.$t("pub.dlg.defaultValue")},on:{upload:e.uploadFile}},[e._v(e._s(e.$t("common.submit"))+"\n        ")]),e._v(" "),e.uploadModal.model.file?a("span",[e._v(e._s(e.uploadModal.model.file.name))]):e._e()],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("serverList.servant.comment")}},[a("let-input",{attrs:{type:"textarea",rows:3},model:{value:e.uploadModal.model.comment,callback:function(t){e.$set(e.uploadModal.model,"comment",t)},expression:"uploadModal.model.comment"}})],1),e._v(" "),a("let-button",{attrs:{type:"submit",theme:"primary"}},[e._v(e._s(e.$t("serverList.servant.upload")))])],1):e._e()],1)],1)},staticRenderFns:[]};var lt=a("VU/8")(ot,st,!1,function(e){a("ohPC")},null,null).exports,it={data:function(){return{uploadModal:{show:!1,model:{application:"DCache",module_name:"DCacheServerGroup",package_type:"1",file:{},comment:""}},packages:{count:0,rows:[]}}},methods:{closeUploadModal:function(){this.uploadModal.show=!1},uploadFile:function(e){this.uploadModal.model.file=e},uploadPatchPackage:function(){var e=this;if(this.$refs.uploadForm.validate()){var t=this.$Loading.show(),a=new FormData;a.append("application",this.uploadModal.model.application),a.append("module_name",this.uploadModal.model.module_name),a.append("task_id",(new Date).getTime()),a.append("package_type",this.uploadModal.model.package_type),a.append("suse",this.uploadModal.model.file),a.append("comment",this.uploadModal.model.comment),this.$ajax.postForm("/server/api/upload_patch_package",a).then(function(){t.hide(),e.closeUploadModal(),e.getPatchPackage()}).catch(function(a){t.hide(),e.$tip.error(e.$t("common.error")+": "+(a.message||a.err_msg))})}},getPatchPackage:function(){var e=this;this.$ajax.getJSON("/server/api/server_patch_list",{application:"DCache",module_name:"DCacheServerGroup"}).then(function(t){e.packages=t}).catch(function(t){e.$tip.error(e.$t("common.error")+": "+(t.message||t.err_msg))})},deletePackage:function(e){var t=this;this.$confirm(this.$t("releasePackage.confirmDeleteTip"),this.$t("common.alert")).then(function(){t.$ajax.postJSON("/server/api/delete_patch_package",{id:e}).then(function(e){t.getPatchPackage()})}).catch(function(e){t.$tip.error(t.$t("common.error")+": "+(e.message||e.err_msg))})},setDefault:function(e){var t=this,a=e.id,r=e.package_type;this.$ajax.postJSON("/server/api/set_patch_package_default",{id:a,package_type:r,application:this.uploadModal.model.application,module_name:this.uploadModal.model.module_name}).then(function(e){t.getPatchPackage()}).catch(function(e){t.$tip.error(t.$t("common.error")+": "+(e.message||e.err_msg))})}},created:function(){this.getPatchPackage()}},nt={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"container"},[a("div",[a("let-button",{attrs:{theme:"primary",size:"small"},on:{click:function(t){e.uploadModal.show=!e.uploadModal.show}}},[e._v("\n      "+e._s(e.$t("releasePackage.uploadPackage"))+"\n    ")])],1),e._v(" "),a("let-table",{attrs:{data:e.packages.rows,title:e.$t("serverList.title.serverList"),"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{title:"ID",prop:"id"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticStyle:{color:"green",display:"inline-block",width:"1em",height:"1em"},attrs:{title:e.$t("releasePackage.default")}},[1==t.row.default_version?a("icon",{attrs:{name:"default"}}):e._e()],1),e._v("\n        "+e._s(t.row.id)+"\n      ")]}}])}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("releasePackage.moduleName"),prop:"server"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("releasePackage.cacheType")},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.package_type?a("span",[e._v("KVCache")]):2==t.row.package_type?a("span",[e._v("MKVCache")]):e._e()]}}])}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.servant.comment"),prop:"comment"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("releasePackage.uploadTime"),prop:"posttime"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("operate.operates"),width:"260px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-table-operation",{on:{click:function(a){return e.setDefault(t.row)}}},[e._v(e._s(e.$t("operate.default")))]),e._v(" "),a("let-table-operation",{on:{click:function(a){return e.deletePackage(t.row.id)}}},[e._v(e._s(e.$t("operate.delete")))])]}}])})],1),e._v(" "),a("let-modal",{attrs:{title:e.$t("pub.dlg.upload"),width:"880px",footShow:!1},on:{"on-cancel":e.closeUploadModal},model:{value:e.uploadModal.show,callback:function(t){e.$set(e.uploadModal,"show",t)},expression:"uploadModal.show"}},[e.uploadModal.model?a("let-form",{ref:"uploadForm",attrs:{itemWidth:"100%"},nativeOn:{submit:function(t){return t.preventDefault(),e.uploadPatchPackage(t)}}},[a("let-form-item",{attrs:{label:e.$t("releasePackage.moduleName")}},[e._v("\n        "+e._s(e.uploadModal.model.application)+"."+e._s(e.uploadModal.model.module_name)+"\n      ")]),e._v(" "),a("let-form-item",{attrs:{label:e.$t("releasePackage.cacheType")}},[a("let-select",{attrs:{size:"small"},model:{value:e.uploadModal.model.package_type,callback:function(t){e.$set(e.uploadModal.model,"package_type",t)},expression:"uploadModal.model.package_type"}},[a("let-option",{attrs:{value:"1"}},[e._v("KVCache")]),e._v(" "),a("let-option",{attrs:{value:"2"}},[e._v("MKVCache")])],1)],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("pub.dlg.releasePkg"),itemWidth:"400px"}},[a("let-uploader",{attrs:{placeholder:e.$t("pub.dlg.defaultValue")},on:{upload:e.uploadFile}},[e._v(e._s(e.$t("common.submit"))+"\n        ")]),e._v(" "),e.uploadModal.model.file?a("span",[e._v(e._s(e.uploadModal.model.file.name))]):e._e()],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("serverList.servant.comment")}},[a("let-input",{attrs:{type:"textarea",rows:3},model:{value:e.uploadModal.model.comment,callback:function(t){e.$set(e.uploadModal.model,"comment",t)},expression:"uploadModal.model.comment"}})],1),e._v(" "),a("let-button",{attrs:{type:"submit",theme:"primary"}},[e._v(e._s(e.$t("serverList.servant.upload")))])],1):e._e()],1)],1)},staticRenderFns:[]};var ct=a("VU/8")(it,nt,!1,function(e){a("a94L")},null,null).exports,dt={data:function(){return{config:{item:"",path:"",period:"",reload:"",remark:""}}},methods:{submit:function(){var e=this;return N()(L.a.mark(function t(){return L.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.$refs.addConfigForm.validate()){t.next=13;break}return t.prev=1,t.next=4,e.$ajax.postJSON("/server/api/cache/addConfig",e.config);case 4:e.$tip.success(""+e.$t("cache.config.addSuccess")),g()(e.config,{item:""}),e.$emit("call-back"),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),console.error(t.t0),e.$tip.error(e.$t("common.error")+": "+(t.t0.message||t.t0.err_msg));case 13:case"end":return t.stop()}},t,e,[[1,9]])}))()}}},ut={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",[a("let-form",{ref:"addConfigForm",attrs:{type:"medium",title:e.$t("cache.config.addConfig"),columns:2}},[a("let-form-item",{attrs:{label:e.$t("cache.config.item"),required:""}},[a("let-input",{attrs:{size:"small",required:""},model:{value:e.config.item,callback:function(t){e.$set(e.config,"item",t)},expression:"config.item"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("cache.config.path"),required:""}},[a("let-input",{attrs:{size:"small",required:""},model:{value:e.config.path,callback:function(t){e.$set(e.config,"path",t)},expression:"config.path"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("cache.config.reload"),required:""}},[a("let-input",{attrs:{size:"small",required:""},model:{value:e.config.reload,callback:function(t){e.$set(e.config,"reload",t)},expression:"config.reload"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("cache.config.period"),required:""}},[a("let-input",{attrs:{size:"small",required:""},model:{value:e.config.period,callback:function(t){e.$set(e.config,"period",t)},expression:"config.period"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("cache.config.remark"),required:""}},[a("let-input",{attrs:{size:"small",required:""},model:{value:e.config.remark,callback:function(t){e.$set(e.config,"remark",t)},expression:"config.remark"}})],1),e._v(" "),a("br"),e._v(" "),a("let-form-item",{attrs:{label:" "}},[a("let-button",{attrs:{theme:"primary"},on:{click:e.submit}},[e._v(e._s(e.$t("cache.add")))])],1)],1)],1)},staticRenderFns:[]};var mt=a("VU/8")(dt,ut,!1,function(e){a("/4MF")},null,null).exports,pt={props:{id:{type:String,required:!0},item:{type:String,required:!0},path:{type:String,required:!0},period:{type:String,required:!0},reload:{type:String,required:!0},remark:{type:String,required:!0}},data:function(){return{config:{id:this.id,item:this.item,path:this.path,period:this.period,reload:this.reload,remark:this.remark}}},methods:{submit:function(){var e=this;return N()(L.a.mark(function t(){return L.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.$refs.editConfigForm.validate()){t.next=12;break}return t.prev=1,t.next=4,e.$ajax.postJSON("/server/api/cache/editConfig",e.config);case 4:e.$tip.success(""+e.$t("cache.config.addSuccess")),e.$emit("call-back"),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(1),console.error(t.t0),e.$tip.error(e.$t("common.error")+": "+(t.t0.message||t.t0.err_msg));case 12:case"end":return t.stop()}},t,e,[[1,8]])}))()}}},ft={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{},[a("let-form",{ref:"editConfigForm",attrs:{type:"medium",title:e.$t("cache.config.editConfig"),columns:2}},[a("let-form-item",{attrs:{label:e.$t("cache.config.reload"),required:""}},[a("let-input",{attrs:{size:"small",required:""},model:{value:e.config.reload,callback:function(t){e.$set(e.config,"reload",t)},expression:"config.reload"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("cache.config.period"),required:""}},[a("let-input",{attrs:{size:"small",required:""},model:{value:e.config.period,callback:function(t){e.$set(e.config,"period",t)},expression:"config.period"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("cache.config.remark"),required:""}},[a("let-input",{attrs:{size:"small",required:""},model:{value:e.config.remark,callback:function(t){e.$set(e.config,"remark",t)},expression:"config.remark"}})],1),e._v(" "),a("br"),e._v(" "),a("let-form-item",{attrs:{label:" "}},[a("let-button",{attrs:{theme:"primary"},on:{click:e.submit}},[e._v(e._s(e.$t("cache.modification")))])],1)],1)],1)},staticRenderFns:[]};var ht={components:{AddConfig:mt,EditConfig:a("VU/8")(pt,ft,!1,function(e){a("CH5c")},null,null).exports},data:function(){return{list:[],addConfigVisible:!1,editConfigVisible:!1,editConfigObj:null}},methods:{addConfig:function(){this.addConfigVisible=!0},editConfig:function(e){this.editConfigVisible=!0,this.editConfigObj=e},deleteConfig:function(e){var t=this,a=e.id;this.$confirm(this.$t("cache.config.deleteConfig"),this.$t("common.alert")).then(N()(L.a.mark(function e(){return L.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$ajax.getJSON("/server/api/cache/deleteConfig",{id:a});case 3:return e.sent,e.next=6,t.getConfig();case 6:e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0),t.$tip.error(t.$t("common.error")+": "+(e.t0.message||e.t0.err_msg));case 12:case"end":return e.stop()}},e,t,[[0,8]])})))},getConfig:function(){var e=this;return N()(L.a.mark(function t(){var a;return L.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$ajax.getJSON("/server/api/cache/getConfig");case 3:a=t.sent,e.list=a,t.next=11;break;case 7:t.prev=7,t.t0=t.catch(0),console.error(t.t0),e.$tip.error(e.$t("common.error")+": "+(t.t0.message||t.t0.err_msg));case 11:case"end":return t.stop()}},t,e,[[0,7]])}))()}},created:function(){var e=this;return N()(L.a.mark(function t(){return L.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:console.log("aaaaaaaaaaa"),e.getConfig();case 2:case"end":return t.stop()}},t,e)}))()}},vt={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"page_operation"},[a("let-button",{attrs:{theme:"primary",size:"small"},on:{click:e.addConfig}},[e._v(e._s(e.$t("cache.config.addConfig")))]),e._v(" "),a("let-table",{attrs:{data:e.list,title:e.$t("cache.config.tableTitle"),"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{title:"ID",prop:"id"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("cache.config.remark"),prop:"remark"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("cache.config.path"),prop:"path"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("cache.config.item"),prop:"item"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("cache.config.reload"),prop:"reload"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("cache.config.period"),prop:"period"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("operate.operates")},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("let-table-operation",{on:{click:function(t){return e.editConfig(r)}}},[e._v(e._s(e.$t("operate.update")))]),e._v(" "),a("let-table-operation",{staticClass:"danger",on:{click:function(t){return e.deleteConfig(r)}}},[e._v(e._s(e.$t("operate.delete")))])]}}])})],1),e._v(" "),a("let-modal",{attrs:{footShow:!1,closeOnClickBackdrop:!0},model:{value:e.addConfigVisible,callback:function(t){e.addConfigVisible=t},expression:"addConfigVisible"}},[e.addConfigVisible?a("add-config",{on:{"call-back":e.getConfig}}):e._e()],1),e._v(" "),a("let-modal",{attrs:{footShow:!1,closeOnClickBackdrop:!0},model:{value:e.editConfigVisible,callback:function(t){e.editConfigVisible=t},expression:"editConfigVisible"}},[e.editConfigVisible?a("edit-config",e._b({on:{"call-back":e.getConfig}},"edit-config",e.editConfigObj,!1)):e._e()],1)],1)},staticRenderFns:[]};var gt=a("VU/8")(ht,vt,!1,function(e){a("9eSX")},null,null).exports,_t={props:{moduleName:{type:String,required:!0},serverName:{type:String,required:!0},nodeName:{type:String,required:!0}},data:function(){return{configList:[]}},methods:{getServerConfig:function(){var e=this;return N()(L.a.mark(function t(){var a,r;return L.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a={moduleName:e.moduleName,serverName:e.serverName,nodeName:e.nodeName},t.next=4,e.$ajax.getJSON("/server/api/cache/getServerConfig",a);case 4:r=t.sent,e.configList=r,t.next=12;break;case 8:t.prev=8,t.t0=t.catch(0),console.error(t.t0),e.$tip.error(e.$t("common.error")+": "+(t.t0.message||t.t0.err_msg));case 12:case"end":return t.stop()}},t,e,[[0,8]])}))()}},created:function(){this.getServerConfig()}},bt={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",[a("let-table",{attrs:{data:e.configList,"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{title:e.$t("cache.config.remark"),prop:"remark"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("cache.config.path"),prop:"path"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("cache.config.item"),prop:"item"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("cache.config.value"),prop:"config_value"}})],1)],1)},staticRenderFns:[]};var $t=a("VU/8")(_t,bt,!1,function(e){a("DhpO")},null,null).exports,Mt={props:{serverName:{type:String,required:!0},nodeName:{type:String,required:!0}},data:function(){return{configList:[]}},methods:{getServerConfig:function(){var e=this;return N()(L.a.mark(function t(){var a,r;return L.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a={serverName:e.serverName,nodeName:e.nodeName},t.next=4,e.$ajax.getJSON("/server/api/cache/getServerNodeConfig",a);case 4:(r=t.sent).forEach(function(e){return e.modify_value=""}),e.configList=r,t.next=13;break;case 9:t.prev=9,t.t0=t.catch(0),console.error(t.t0),e.$tip.error(e.$t("common.error")+": "+(t.t0.message||t.t0.err_msg));case 13:case"end":return t.stop()}},t,e,[[0,9]])}))()},deleteConfig:function(e){var t=this,a=e.id;this.$confirm(this.$t("cache.config.deleteConfig"),this.$t("common.alert")).then(N()(L.a.mark(function e(){return L.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$ajax.getJSON("/server/api/cache/deleteServerConfigItem",{id:a});case 3:return e.sent,e.next=6,t.getServerConfig();case 6:e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0),t.$tip.error(t.$t("common.error")+": "+(e.t0.message||e.t0.err_msg));case 12:case"end":return e.stop()}},e,t,[[0,8]])})))},saveConfig:function(e){var t=this,a=e.id,r=e.modify_value;return N()(L.a.mark(function e(){return L.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$ajax.getJSON("/server/api/cache/updateServerConfigItem",{id:a,configValue:r});case 3:return e.sent,e.next=6,t.getServerConfig();case 6:e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0),t.$tip.error(t.$t("common.error")+": "+(e.t0.message||e.t0.err_msg));case 12:case"end":return e.stop()}},e,t,[[0,8]])}))()}},created:function(){this.getServerConfig()}},yt={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",[a("let-table",{attrs:{data:e.configList,"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{title:e.$t("cache.config.remark"),prop:"remark"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("cache.config.path"),prop:"path"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("cache.config.item"),prop:"item"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("cache.config.value"),prop:"config_value"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("cache.config.modify_value"),prop:"config_value"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("let-input",{attrs:{size:"small"},model:{value:r.modify_value,callback:function(t){e.$set(r,"modify_value",t)},expression:"row.modify_value"}})]}}])}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("operate.operates")},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("let-table-operation",{on:{click:function(t){return e.saveConfig(r)}}},[e._v(e._s(e.$t("operate.save")))]),e._v(" "),a("let-table-operation",{staticClass:"danger",on:{click:function(t){return e.deleteConfig(r)}}},[e._v(e._s(e.$t("operate.delete")))])]}}])})],1)],1)},staticRenderFns:[]};var wt=a("VU/8")(Mt,yt,!1,function(e){a("KDy6")},null,null).exports,kt={props:{serverName:{type:String,required:!1},nodeName:{type:String,required:!1},appName:{type:String,required:!1},moduleName:{type:String,required:!1}},data:function(){return{itemId:"",list:[],configValue:""}},methods:{submit:function(){var e=this;return N()(L.a.mark(function t(){var a;return L.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.$refs.addConfigForm.validate()){t.next=14;break}return t.prev=1,a={itemId:e.itemId,configValue:e.configValue,serverName:e.serverName,nodeName:e.nodeName,appName:e.appName,moduleName:e.moduleName},t.next=5,e.$ajax.postJSON("/server/api/cache/addServerConfigItem",a);case 5:e.$tip.success(""+e.$t("cache.config.addSuccess")),e.configValue=null,e.moduleName&&e.$emit("call-back"),t.next=14;break;case 10:t.prev=10,t.t0=t.catch(1),console.error(t.t0),e.$tip.error(e.$t("common.error")+": "+(t.t0.message||t.t0.err_msg));case 14:case"end":return t.stop()}},t,e,[[1,10]])}))()},getConfig:function(){var e=this;return N()(L.a.mark(function t(){var a;return L.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$ajax.getJSON("/server/api/cache/getConfig");case 3:a=t.sent,e.list=a,t.next=11;break;case 7:t.prev=7,t.t0=t.catch(0),console.error(t.t0),e.$tip.error(e.$t("common.error")+": "+(t.t0.message||t.t0.err_msg));case 11:case"end":return t.stop()}},t,e,[[0,7]])}))()}},created:function(){this.getConfig()}},xt={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",[a("let-form",{ref:"addConfigForm",attrs:{type:"medium",title:e.$t("cache.config.addConfig")}},[a("let-form-item",{attrs:{label:e.$t("cache.config.item"),required:""}},[a("let-select",{attrs:{size:"small",required:""},model:{value:e.itemId,callback:function(t){e.itemId=t},expression:"itemId"}},e._l(e.list,function(t){return a("let-option",{attrs:{value:t.id}},[e._v(e._s(t.path)+"__"+e._s(t.item)+"("+e._s(t.remark)+")")])}),1)],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("cache.config.itemValue"),required:""}},[a("let-input",{attrs:{size:"small",required:""},model:{value:e.configValue,callback:function(t){e.configValue=t},expression:"configValue"}})],1),e._v(" "),a("br"),e._v(" "),a("let-form-item",{attrs:{label:" "}},[a("let-button",{attrs:{theme:"primary"},on:{click:e.submit}},[e._v(e._s(e.$t("cache.add")))])],1)],1)],1)},staticRenderFns:[]};var Ct={components:{ServerConfigList:$t,ServerConfig:wt,addServerConfig:a("VU/8")(kt,xt,!1,function(e){a("NezY")},null,null).exports},data:function(){return{moduleName:this.$route.params.treeid.substr(1),configList:[],serverList:[],serverConfigListVisible:!1,serverConfigVisible:!1,addServerConfigVisible:!1,checkServer:{},isCheckedAll:!1,pagination:{page:1}}},computed:{showConfigList:function(){return this.configList.slice(10*(this.pagination.page-1),10*this.pagination.page)},total:function(){return Math.ceil(this.configList.length/10)},hasCheckedItem:function(){return 0!==this.showConfigList.filter(function(e){return!0===e.isChecked}).length}},watch:{isCheckedAll:function(){var e=this.isCheckedAll;this.showConfigList.forEach(function(t){t.isChecked=e})}},methods:{checkedAllChange:function(){console.log(arguments)},changePage:function(e){this.pagination.page=e},getModuleConfig:function(){var e=this;return N()(L.a.mark(function t(){var a;return L.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$ajax.getJSON("/server/api/cache/getModuleConfig",{moduleName:e.moduleName});case 3:(a=t.sent).forEach(function(e){e.modify_value="",e.isChecked=!1}),e.configList=a,t.next=12;break;case 8:t.prev=8,t.t0=t.catch(0),console.error(t.t0),e.$tip.error(e.$t("common.error")+": "+(t.t0.message||t.t0.err_msg));case 12:case"end":return t.stop()}},t,e,[[0,8]])}))()},getServerList:function(){var e=this;return N()(L.a.mark(function t(){var a;return L.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$ajax.getJSON("/server/api/get_cache_server_list",{tree_node_id:e.moduleName});case 3:a=t.sent,e.serverList=a,t.next=11;break;case 7:t.prev=7,t.t0=t.catch(0),console.error(t.t0),e.$tip.error(e.$t("common.error")+": "+(t.t0.message||t.t0.err_msg));case 11:case"end":return t.stop()}},t,e,[[0,7]])}))()},saveConfig:function(e){var t=this;return N()(L.a.mark(function a(){var r,o;return L.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return r=e.id,o=e.modify_value,a.prev=1,a.next=4,t.$ajax.getJSON("/server/api/cache/updateServerConfigItem",{id:r,configValue:o});case 4:return a.sent,a.next=7,t.getModuleConfig();case 7:a.next=13;break;case 9:a.prev=9,a.t0=a.catch(1),console.error(a.t0),t.$tip.error(t.$t("common.error")+": "+(a.t0.message||a.t0.err_msg));case 13:case"end":return a.stop()}},a,t,[[1,9]])}))()},saveConfigBatch:function(){var e=this;return N()(L.a.mark(function t(){var a;return L.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.showConfigList.filter(function(e){return e.isChecked}).map(function(e){return{indexId:e.id,configValue:e.modify_value}}),t.prev=1,t.next=4,e.$ajax.postJSON("/server/api/cache/updateServerConfigItemBatch",{serverConfigList:a});case 4:return t.sent,t.next=7,e.getModuleConfig();case 7:t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),console.error(t.t0),e.$tip.error(e.$t("common.error")+": "+(t.t0.message||t.t0.err_msg));case 13:case"end":return t.stop()}},t,e,[[1,9]])}))()},deleteConfig:function(e){var t=this,a=e.id;this.$confirm(this.$t("cache.config.deleteConfig"),this.$t("common.alert")).then(N()(L.a.mark(function e(){return L.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$ajax.getJSON("/server/api/cache/deleteServerConfigItem",{id:a});case 3:return e.sent,e.next=6,t.getModuleConfig();case 6:e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0),t.$tip.error(t.$t("common.error")+": "+(e.t0.message||e.t0.err_msg));case 12:case"end":return e.stop()}},e,t,[[0,8]])})))},deleteServerConfigItemBatch:function(e){var t=this,a=(e.id,this.showConfigList.filter(function(e){return e.isChecked}).map(function(e){return{indexId:e.id}}));this.$confirm(this.$t("cache.config.deleteConfig"),this.$t("common.alert")).then(N()(L.a.mark(function e(){return L.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$ajax.postJSON("/server/api/cache/deleteServerConfigItemBatch",{serverConfigList:a});case 3:return e.sent,e.next=6,t.getModuleConfig();case 6:e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0),t.$tip.error(t.$t("common.error")+": "+(e.t0.message||e.t0.err_msg));case 12:case"end":return e.stop()}},e,t,[[0,8]])})))},handleNoPublishedTime:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.$t("pub.dlg.unpublished");return"0000:00:00 00:00:00"===e?t:e},checkServerConfigList:function(e){this.serverConfigListVisible=!0,this.checkServer={serverName:e.server_name,nodeName:e.node_name}},editServerConfig:function(e){this.serverConfigVisible=!0,this.checkServer={serverName:e.server_name,nodeName:e.node_name}},addServerConfig:function(e){this.addServerConfigVisible=!0,this.checkServer={serverName:e.server_name,nodeName:e.node_name,moduleName:e.moduleName}}},created:function(){this.getModuleConfig(),this.getServerList()}},St={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{},[e.serverList?a("let-table",{ref:"serverListLoading",attrs:{data:e.serverList,title:e.$t("serverList.title.serverList"),"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{title:e.$t("serverList.table.th.service"),prop:"server_name"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.ip"),prop:"node_name",width:"140px"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.ip"),width:"140px"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row.cache_server_type;return[0===r?a("span",[e._v(e._s(e.$t("cache.mainEngine")))]):1===r?a("span",[e._v(e._s(e.$t("cache.standByEngine")))]):2===r?a("span",[e._v(e._s(e.$t("cache.mirror")))]):e._e()]}}],null,!1,3937031003)}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.configStatus"),width:"90px"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("span",{class:"active"===e.row.setting_state?"status-active":"status-off"})]}}],null,!1,3224184510)}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.currStatus"),width:"65px"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("span",{class:"active"===e.row.present_state?"status-active":"activating"===e.row.present_state?"status-activating":"status-off"})]}}],null,!1,4116932289)}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.time")},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticStyle:{"word-break":"break-word"}},[e._v(e._s(e.handleNoPublishedTime(t.row.patch_time)))])]}}],null,!1,3144837894)}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("operate.operates"),width:"260px"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("let-table-operation",{on:{click:function(t){return e.editServerConfig(r)}}},[e._v(e._s(e.$t("cache.config.edit")))]),e._v(" "),a("let-table-operation",{on:{click:function(t){return e.checkServerConfigList(r)}}},[e._v(e._s(e.$t("cache.config.view")))]),e._v(" "),a("let-table-operation",{on:{click:function(t){return e.addServerConfig(r)}}},[e._v(e._s(e.$t("cache.config.add")))])]}}],null,!1,3985947012)})],1):e._e(),e._v(" "),a("let-table",{attrs:{data:e.showConfigList,title:e.$t("cache.config.tableTitle"),"empty-msg":e.$t("common.nodata"),stripe:!0}},[a("let-table-column",{scopedSlots:e._u([{key:"head",fn:function(t){return[a("let-checkbox",{attrs:{value:e.isCheckedAll,change:e.checkedAllChange},model:{value:e.isCheckedAll,callback:function(t){e.isCheckedAll=t},expression:"isCheckedAll"}})]}},{key:"default",fn:function(t){return[a("let-checkbox",{attrs:{value:t.row.id},model:{value:t.row.isChecked,callback:function(a){e.$set(t.row,"isChecked",a)},expression:"scope.row.isChecked"}})]}}])}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("cache.config.remark"),prop:"remark"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("cache.config.path"),prop:"path"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("cache.config.item"),prop:"item"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("cache.config.config_value"),prop:"config_value"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("cache.config.modify_value"),prop:"period"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("let-input",{attrs:{size:"small"},model:{value:r.modify_value,callback:function(t){e.$set(r,"modify_value",t)},expression:"row.modify_value"}})]}}])}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("operate.operates")},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("let-table-operation",{on:{click:function(t){return e.saveConfig(r)}}},[e._v(e._s(e.$t("operate.save")))]),e._v(" "),a("let-table-operation",{staticClass:"danger",on:{click:function(t){return e.deleteConfig(r)}}},[e._v(e._s(e.$t("operate.delete")))])]}}])}),e._v(" "),e.total?a("let-pagination",{attrs:{slot:"pagination",total:e.total,page:e.pagination.page,"show-sums":"",sum:e.configList.length,jump:"",align:"right"},on:{change:e.changePage},slot:"pagination"}):e._e(),e._v(" "),a("template",{slot:"operations"},[a("let-button",{attrs:{theme:"success",disabled:!e.hasCheckedItem},on:{click:e.saveConfigBatch}},[e._v(e._s(e.$t("cache.config.batchUpdate")))]),e._v(" "),a("let-button",{attrs:{theme:"danger",disabled:!e.hasCheckedItem},on:{click:e.deleteServerConfigItemBatch}},[e._v(e._s(e.$t("cache.config.batchDelete")))]),e._v(" "),a("let-button",{attrs:{theme:"primary"},on:{click:function(t){return e.addServerConfig({moduleName:e.moduleName})}}},[e._v(e._s(e.$t("cache.config.addModuleConfig")))])],1)],2),e._v(" "),a("let-modal",{staticClass:"server_config_list_modal",attrs:{footShow:!1,closeOnClickBackdrop:!0,width:"80%",height:"80%",title:e.$t("cache.config.tableTitle")},model:{value:e.serverConfigListVisible,callback:function(t){e.serverConfigListVisible=t},expression:"serverConfigListVisible"}},[e.serverConfigListVisible?a("server-config-list",e._b({attrs:{moduleName:e.moduleName}},"server-config-list",e.checkServer,!1)):e._e()],1),e._v(" "),a("let-modal",{staticClass:"server_config_list_modal",attrs:{footShow:!1,closeOnClickBackdrop:!0,width:"80%",height:"80%",title:e.$t("cache.config.tableTitle")},model:{value:e.serverConfigVisible,callback:function(t){e.serverConfigVisible=t},expression:"serverConfigVisible"}},[e.serverConfigVisible?a("server-config",e._b({},"server-config",e.checkServer,!1)):e._e()],1),e._v(" "),a("let-modal",{attrs:{footShow:!1,closeOnClickBackdrop:!0},model:{value:e.addServerConfigVisible,callback:function(t){e.addServerConfigVisible=t},expression:"addServerConfigVisible"}},[e.addServerConfigVisible?a("add-server-config",e._b({on:{"call-back":e.getModuleConfig}},"add-server-config",e.checkServer,!1)):e._e()],1)],1)},staticRenderFns:[]};var Lt=a("VU/8")(Ct,St,!1,function(e){a("ZSRx")},null,null).exports,Dt={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"operation-manage"},[a("let-tabs",{attrs:{activekey:e.$route.path},on:{click:e.onTabClick}},[a("let-tab-pane",{attrs:{tab:e.$t("dcache.operationManage.expand"),tabkey:"/operationManage/expand"}}),e._v(" "),a("let-tab-pane",{attrs:{tab:e.$t("dcache.operationManage.shrinkage"),tabkey:"/operationManage/shrinkage"}}),e._v(" "),a("let-tab-pane",{attrs:{tab:e.$t("dcache.operationManage.migration"),tabkey:"/operationManage/migration"}}),e._v(" "),a("let-tab-pane",{attrs:{tab:e.$t("dcache.operationManage.mainBackup"),tabkey:"/operationManage/mainBackup"}})],1),e._v(" "),a("router-view",{staticClass:"operation-manage-children"})],1)},staticRenderFns:[]};var Nt=a("VU/8")({methods:{onTabClick:function(e){this.$router.replace(e)}}},Dt,!1,function(e){a("AuvU")},null,null).exports,At={data:function(){return{list:[],total:0,page:1}},computed:{showList:function(){var e=this.page;return this.list.slice(10*(e-1),10*e)},type:function(){return{expand:"1",shrinkage:"2",migration:"0"}[this.$route.params.type]||"1"}},methods:{getRouterChange:function(){var e=this;return N()(L.a.mark(function t(){var a,r,o;return L.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,s={type:e.type},void 0,l=s.type,W({method:"get",url:"/cache/getRouterChange",params:{type:void 0===l?"1":l}});case 3:a=t.sent,r=a.totalNum,o=a.transferRecord,e.list=o.map(function(e){return e.statusText="dcache.operationManage.statusText."+e.status,e.progressText=e.progress+"%",e}),e.total=Math.ceil(r/10),t.next=14;break;case 10:t.prev=10,t.t0=t.catch(0),console.error(t.t0),e.$tip.error(t.t0.message);case 14:case"end":return t.stop()}var s,l},t,e,[[0,10]])}))()},changePage:function(e){this.page=e},ensureStop:function(e){var t=this;return N()(L.a.mark(function a(){var r,o,s,l,i;return L.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,t.$confirm(t.$t("dcache.operationManage.ensureStop"));case 3:return console.log("ensure stop",e),r=e.appName,o=e.moduleName,s=e.type,l=e.srcGroupName,i=e.dstGroupName,a.next=7,G({appName:r,moduleName:o,type:s,srcGroupName:l,dstGroupName:i});case 7:t.getRouterChange(),a.next=14;break;case 10:a.prev=10,a.t0=a.catch(0),console.error(a.t0),t.$tip.error(a.t0.message);case 14:case"end":return a.stop()}},a,t,[[0,10]])}))()},ensureDelete:function(e){var t=this;return N()(L.a.mark(function a(){var r,o,s,l,i;return L.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,t.$confirm(t.$t("dcache.operationManage.ensureDelete"));case 3:return console.log("ensure delete",e),r=e.appName,o=e.moduleName,s=e.type,l=e.srcGroupName,i=e.dstGroupName,a.next=7,H({appName:r,moduleName:o,type:s,srcGroupName:l,dstGroupName:i});case 7:t.getRouterChange(),a.next=14;break;case 10:a.prev=10,a.t0=a.catch(0),console.error(a.t0),t.$tip.error(a.t0.message);case 14:case"end":return a.stop()}},a,t,[[0,10]])}))()}},beforeRouteUpdate:function(e,t,a){a(),this.getRouterChange()},created:function(){this.getRouterChange()}},Ft={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("let-table",{ref:"pageTable",attrs:{data:e.showList,"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{title:e.$t("dcache.operationManage.appName"),prop:"appName"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("dcache.operationManage.moduleName"),prop:"moduleName"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("dcache.operationManage.srcGroupName"),prop:"srcGroupName"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("dcache.operationManage.dstGroupName"),prop:"dstGroupName"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("dcache.operationManage.status"),prop:"sgtatus"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n        "+e._s(e.$t(a.statusText))+"\n      ")]}}])}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("dcache.operationManage.beginTime"),prop:"beginTime"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("dcache.operationManage.progress"),prop:"progress"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n        "+e._s(a.progressText)+"\n      ")]}}])}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("operate.operates"),prop:"appName",width:"100px"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[3===r.status?a("let-table-operation",{on:{click:function(t){return e.ensureStop(r)}}},[e._v(e._s(e.$t("operate.stop")))]):e._e(),e._v(" "),3!==r.status?a("let-table-operation",{on:{click:function(t){return e.ensureDelete(r)}}},[e._v(e._s(e.$t("operate.delete")))]):e._e()]}}])}),e._v(" "),a("let-pagination",{attrs:{slot:"pagination",align:"right",total:e.total,page:e.page},on:{change:e.changePage},slot:"pagination"})],1)],1)},staticRenderFns:[]},Tt=a("VU/8")(At,Ft,!1,null,null,null).exports,qt={data:function(){return{list:[],total:0,page:1}},computed:{showList:function(){var e=this.page;return this.list.slice(10*(e-1),10*e)}},methods:{getSwitchInfo:function(){var e=this;return N()(L.a.mark(function t(){var a,r,o;return L.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,void 0,void 0,void 0,void 0,void 0,l=(s={}).appName,i=void 0===l?"":l,n=s.moduleName,c=void 0===n?"":n,d=s.groupName,W({method:"get",url:"/cache/getSwitchInfo",params:{appName:i,moduleName:c,groupName:void 0===d?"":d}});case 3:a=t.sent,r=a.totalNum,o=a.switchRecord,e.list=o.map(function(e){return e}),e.total=Math.ceil(r/10),t.next=14;break;case 10:t.prev=10,t.t0=t.catch(0),console.error(t.t0),e.$tip.error(t.t0.message);case 14:case"end":return t.stop()}var s,l,i,n,c,d},t,e,[[0,10]])}))()},changePage:function(e){this.page=e}},created:function(){this.getSwitchInfo()}},Pt={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("let-table",{ref:"pageTable",attrs:{data:e.showList,"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{title:e.$t("dcache.operationManage.appName"),prop:"appName"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("dcache.operationManage.moduleName"),prop:"moduleName"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("dcache.operationManage.srcGroupName"),prop:"srcGroupName"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("dcache.operationManage.dstGroupName"),prop:"dstGroupName"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("dcache.operationManage.status"),prop:"sgtatus"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n        "+e._s(e.$t(a.statusText))+"\n      ")]}}])}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("dcache.operationManage.beginTime"),prop:"beginTime"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("dcache.operationManage.progress"),prop:"progress"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n        "+e._s(a.progressText)+"\n      ")]}}])}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("operate.operates"),prop:"appName",width:"100px"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[3===r.status?a("let-table-operation",{on:{click:function(t){return e.ensureStop(r)}}},[e._v(e._s(e.$t("operate.stop")))]):e._e(),e._v(" "),3!==r.status?a("let-table-operation",{on:{click:function(t){return e.ensureDelete(r)}}},[e._v(e._s(e.$t("operate.delete")))]):e._e()]}}])}),e._v(" "),a("let-pagination",{attrs:{slot:"pagination",align:"right",total:e.total,page:e.page},on:{change:e.changePage},slot:"pagination"})],1)],1)},staticRenderFns:[]},Rt=a("VU/8")(qt,Pt,!1,null,null,null).exports;r.default.use(h.a);var Ot=new h.a({routes:[{path:"/server",name:"Server",component:$,children:[{path:":treeid/manage",component:T},{path:":treeid/manage/:serverType",component:T},{path:":treeid/publish/:serverType",component:le},{path:":treeid/config/:serverType",component:ie.a},{path:":treeid/server-monitor/:serverType",component:ne.a},{path:":treeid/property-monitor/:serverType",component:ce.a},{path:":treeid/interface-debuger/:serverType",component:ue.a},{path:":treeid/user-manage/:serverType",component:de.a},{path:":treeid/cache",component:te},{path:":treeid/moduleCache",component:Lt}]},{path:"/operation",name:"Operation",component:pe,redirect:"/operation/apply",children:[{path:"apply",name:"apply",component:he,redirect:"/operation/apply/createApply",children:[{path:"createApply",component:_e},{path:"createService/:applyId",component:Me},{path:"installAndPublish/:applyId",component:ke}]},{path:"module",component:Ce,redirect:"/operation/module/createModule",children:[{path:"createModule",component:Ne},{path:"moduleConfig/:moduleId",component:Pe},{path:"serverConfig/:moduleId",component:Ve},{path:"installAndPublish/:moduleId",component:Ue}]},{path:"region",name:"region",component:Ge}]},{path:"/releasePackage",name:"releasePackage",component:Ze,redirect:"/releasePackage/proxyList",children:[{path:"proxyList",component:rt},{path:"routerList",component:lt},{path:"cacheList",component:ct}]},{path:"/config",component:gt},{path:"/operationManage",name:"operationManage",component:Nt,redirect:"/operationManage/expand",children:[{path:"mainBackup",component:Rt},{path:":type",component:Tt}]},{path:"*",redirect:"/server"}],scrollBehavior:function(e,t,a){return{x:0,y:0}}});r.default.config.productionTip=!1,c.b.call(this).then(function(){new r.default({i18n:c.a,el:"#app",router:Ot,components:{App:f},template:"<App/>"})})},DhpO:function(e,t){},"E+Yk":function(e,t,a){"use strict";var r=a("woOf"),o=a.n(r),s={name:"ServerUserManage",data:function(){return{serverData:o()({},this.$parent.getServerData()),developer:"",operator:"",hasAuth:!1}},mounted:function(){this.checkHasAuth(),this.getAuthList()},methods:{checkHasAuth:function(){var e=this;this.$ajax.getJSON("/server/api/has_auth",{application:this.serverData.application,server_name:this.serverData.server_name,role:"developer"}).then(function(t){e.hasAuth=t.has_auth||!1}).catch(function(t){e.$tip.error(e.$t("common.error")+": "+(t.message||t.err_msg))})},getAuthList:function(){var e=this;this.$ajax.getJSON("/server/api/get_auth_list",{application:this.serverData.application,server_name:this.serverData.server_name}).then(function(t){e.operator=(t.operator||[]).join(";"),e.developer=(t.developer||[]).join(";")}).catch(function(t){e.$tip.error(e.$t("common.error")+": "+(t.message||t.err_msg))})},save:function(){var e=this,t=this.$Loading.show();this.$ajax.postJSON("/server/api/update_auth",{application:this.serverData.application,server_name:this.serverData.server_name,operator:this.operator,developer:this.developer}).then(function(a){t.hide(),e.$tip.success(""+e.$t("common.error"))}).catch(function(a){t.hide(),e.$tip.error(e.$t("common.error")+": "+(a.message||a.err_msg))})}}},l={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("let-form",{attrs:{inline:"",itemWidth:"600px"},nativeOn:{submit:function(t){return t.preventDefault(),e.save(t)}}},[a("let-form-item",{attrs:{label:e.$t("user.op")}},[a("let-input",{attrs:{type:"textarea",disabled:!e.hasAuth},model:{value:e.operator,callback:function(t){e.operator=t},expression:"operator"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("user.dev")}},[a("let-input",{attrs:{type:"textarea",disabled:!e.hasAuth},model:{value:e.developer,callback:function(t){e.developer=t},expression:"developer"}})],1),e._v(" "),a("let-form-item",[e.hasAuth?a("let-button",{attrs:{type:"submit",theme:"primary"}},[e._v(e._s(e.$t("common.submit")))]):e._e()],1)],1)],1)},staticRenderFns:[]};var i=a("VU/8")(s,l,!1,function(e){a("FqYd")},null,null);t.a=i.exports},"ED/T":function(e,t,a){"use strict";e.exports=function(e,t){return function(){for(var a=new Array(arguments.length),r=0;r<a.length;r++)a[r]=arguments[r];return e.apply(t,a)}}},FqYd:function(e,t){},H6Qo:function(e,t,a){"use strict";var r=a("S1cf");function o(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,a){if(!t)return e;var s;if(a)s=a(t);else if(r.isURLSearchParams(t))s=t.toString();else{var l=[];r.forEach(t,function(e,t){null!==e&&void 0!==e&&(r.isArray(e)?t+="[]":e=[e],r.forEach(e,function(e){r.isDate(e)?e=e.toISOString():r.isObject(e)&&(e=JSON.stringify(e)),l.push(o(t)+"="+o(e))}))}),s=l.join("&")}return s&&(e+=(-1===e.indexOf("?")?"?":"&")+s),e}},JIJe:function(e,t){},KDy6:function(e,t){},KRuG:function(e,t,a){"use strict";var r=a("S1cf"),o=a("aS8y"),s=a("H6Qo"),l=a("ZeD7"),i=a("/w7L"),n=a("3bIi"),c="undefined"!=typeof window&&window.btoa&&window.btoa.bind(window)||a("mmkS");e.exports=function(e){return new Promise(function(t,d){var u=e.data,m=e.headers;r.isFormData(u)&&delete m["Content-Type"];var p=new XMLHttpRequest,f="onreadystatechange",h=!1;if("undefined"==typeof window||!window.XDomainRequest||"withCredentials"in p||i(e.url)||(p=new window.XDomainRequest,f="onload",h=!0,p.onprogress=function(){},p.ontimeout=function(){}),e.auth){var v=e.auth.username||"",g=e.auth.password||"";m.Authorization="Basic "+c(v+":"+g)}if(p.open(e.method.toUpperCase(),s(e.url,e.params,e.paramsSerializer),!0),p.timeout=e.timeout,p[f]=function(){if(p&&(4===p.readyState||h)&&(0!==p.status||p.responseURL&&0===p.responseURL.indexOf("file:"))){var a="getAllResponseHeaders"in p?l(p.getAllResponseHeaders()):null,r={data:e.responseType&&"text"!==e.responseType?p.response:p.responseText,status:1223===p.status?204:p.status,statusText:1223===p.status?"No Content":p.statusText,headers:a,config:e,request:p};o(t,d,r),p=null}},p.onerror=function(){d(n("Network Error",e,null,p)),p=null},p.ontimeout=function(){d(n("timeout of "+e.timeout+"ms exceeded",e,"ECONNABORTED",p)),p=null},r.isStandardBrowserEnv()){var _=a("dn2M"),b=(e.withCredentials||i(e.url))&&e.xsrfCookieName?_.read(e.xsrfCookieName):void 0;b&&(m[e.xsrfHeaderName]=b)}if("setRequestHeader"in p&&r.forEach(m,function(e,t){void 0===u&&"content-type"===t.toLowerCase()?delete m[t]:p.setRequestHeader(t,e)}),e.withCredentials&&(p.withCredentials=!0),e.responseType)try{p.responseType=e.responseType}catch(t){if("json"!==e.responseType)throw t}"function"==typeof e.onDownloadProgress&&p.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&p.upload&&p.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then(function(e){p&&(p.abort(),d(e),p=null)}),void 0===u&&(u=null),p.send(u)})}},"KsY+":function(e,t,a){"use strict";var r=a("//Fk"),o=a.n(r),s=a("Dd8w"),l=a.n(s),i=a("woOf"),n=a.n(i),c={name:"ServerManage",data:function(){return{serverData:{level:5,application:"",server_name:"",set_name:"",set_area:"",set_group:""},serverList:[],serverNotifyList:[],pageNum:1,pageSize:20,total:1,serverTypes:["tars_cpp","tars_java","tars_php","tars_nodejs","not_tars","tars_go"],configModal:{show:!1,model:null},servantModal:{show:!1,model:null,currentServer:null},servantDetailModal:{show:!1,isNew:!0,model:null},logLevels:["NONE","DEBUG","INFO","WARN","ERROR"],moreCmdModal:{show:!1,model:null,currentServer:null},failCount:0}},computed:{showOthers:function(){return 5===this.serverData.level},isEndpointValid:function(){return!(!this.servantDetailModal.model||!this.servantDetailModal.model.endpoint)&&this.checkServantEndpoint(this.servantDetailModal.model.endpoint)}},methods:{getServerList:function(){var e=this,t=this.$refs.serverListLoading.$loading.show();this.$ajax.getJSON("/server/api/server_list",{tree_node_id:this.$route.params.treeid}).then(function(a){t.hide(),e.serverList=a}).catch(function(a){t.hide(),e.$confirm(a.err_msg||a.message||e.$t("serverList.msg.fail"),e.$t("common.alert")).then(function(){e.getServerList()})})},getServerNotifyList:function(e){var t=this;if(this.showOthers){var a=this.$refs.serverNotifyListLoading.$loading.show();this.$ajax.getJSON("/server/api/server_notify_list",{tree_node_id:this.$route.params.treeid,page_size:this.pageSize,curr_page:e}).then(function(r){a.hide(),t.pageNum=e,t.total=Math.ceil(r.count/t.pageSize),t.serverNotifyList=r.rows}).catch(function(e){a.hide(),t.$tip.error(t.$t("serverList.restart.failed")+": "+(e.err_msg||e.message))})}},gotoPage:function(e){this.getServerNotifyList(e)},getTemplateList:function(){var e=this;this.$ajax.getJSON("/server/api/template_name_list").then(function(t){e.configModal.model?e.configModal.model.templates=t:e.configModal.model={templates:t}}).catch(function(t){e.$tip.error(e.$t("serverList.restart.failed")+": "+(t.err_msg||t.message))})},getServerConfig:function(e){var t=this,a=this.$loading.show({target:this.$refs.configFormLoading});this.$ajax.getJSON("/server/api/server",{id:e}).then(function(e){a.hide(),t.configModal.model?t.configModal.model=n()({},t.configModal.model,e):(e.templates=[],t.configModal.model=e)}).catch(function(e){a.hide(),t.closeConfigModal(),t.$tip.error(t.$t("serverList.restart.failed")+": "+(e.err_msg||e.message))})},configServer:function(e){this.configModal.show=!0,this.getTemplateList(),this.getServerConfig(e)},saveConfig:function(){var e=this;if(this.$refs.configForm.validate()){var t=this.$Loading.show();this.$ajax.postJSON("/server/api/update_server",l()({isBak:this.configModal.model.bak_flag},this.configModal.model)).then(function(a){t.hide(),e.serverList=e.serverList.map(function(e){return e.id===a.id?a:e}),e.closeConfigModal(),e.$tip.success(e.$t("serverList.restart.success"))}).catch(function(a){t.hide(),e.$tip.error(e.$t("serverList.restart.failed")+": "+(a.message||a.err_msg))})}},closeConfigModal:function(){this.$refs.configForm&&this.$refs.configForm.resetValid(),this.configModal.show=!1,this.configModal.model=null},checkTaskStatus:function(e,t){var a=this;return new o.a(function(r,o){a.$ajax.getJSON("/server/api/task",{task_no:e}).then(function(t){1===t.status||0===t.status?setTimeout(function(){r(a.checkTaskStatus(e))},3e3):2===t.status?r("taskid: "+t.task_no):o(new Error("taskid: "+t.task_no))}).catch(function(s){t?o(new Error(s.err_msg||s.message||a.$t("common.networkErr"))):setTimeout(function(){r(a.checkTaskStatus(e,!0))},3e3)})})},addTask:function(e,t,a){var r=this,o=this.$Loading.show();this.$ajax.postJSON("/server/api/add_task",{serial:!0,items:[{server_id:e,command:t}]}).then(function(e){return r.checkTaskStatus(e).then(function(e){o.hide(),r.getServerList(),r.$tip.success({title:a.success,message:e})}).catch(function(e){throw e})}).catch(function(e){o.hide(),r.getServerList(),r.$tip.error({title:a.error,message:e.err_msg||e.message||r.$t("common.networkErr")})})},restartServer:function(e){this.addTask(e,"restart",{success:this.$t("serverList.restart.success"),error:this.$t("serverList.restart.failed")})},stopServer:function(e){var t=this;this.$confirm(this.$t("serverList.stopService.msg.stopService"),this.$t("common.alert")).then(function(){t.addTask(e,"stop",{success:t.$t("serverList.restart.success"),error:t.$t("serverList.restart.failed")})})},undeployServer:function(e){var t=this;this.$confirm(this.$t("serverList.dlg.msg.undeploy"),this.$t("common.alert")).then(function(){t.addTask(e,"undeploy_tars",{success:t.$t("serverList.restart.success"),error:t.$t("serverList.restart.failed")}),t.closeMoreCmdModal()})},manageServant:function(e){var t=this;this.servantModal.show=!0;var a=this.$loading.show({target:this.$refs.servantModalLoading});this.$ajax.getJSON("/server/api/adapter_conf_list",{id:e.id}).then(function(r){a.hide(),t.servantModal.model=r,t.servantModal.currentServer=e}).catch(function(e){a.hide(),t.$tip.error(t.$t("serverList.restart.failed")+": "+(e.err_msg||e.message))})},closeServantModal:function(){this.servantModal.show=!1,this.servantModal.model=null,this.servantModal.currentServer=null},configServant:function(e){if(this.servantDetailModal.model={application:this.servantModal.currentServer.application,server_name:this.servantModal.currentServer.server_name,obj_name:"",node_name:"",endpoint:"",servant:"",thread_num:"",max_connections:"200000",queuecap:"10000",queuetimeout:"60000",allow_ip:"",protocol:"not_tars",handlegroup:""},this.servantDetailModal.isNew=!0,e){var t=this.servantModal.model.find(function(t){return t.id===e});t.obj_name=t.servant.split(".")[2],this.servantDetailModal.model=n()({},this.servantDetailModal.model,t),this.servantDetailModal.isNew=!1}this.servantDetailModal.show=!0},closeServantDetailModal:function(){this.$refs.servantDetailForm&&this.$refs.servantDetailForm.resetValid(),this.servantDetailModal.show=!1,this.servantDetailModal.model=null},checkServantEndpoint:function(e){var t=e.split(/\s-/),a=/^h\s(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/i,r=/^t\s([1-9]|[1-9]\d+)$/i,o=/^p\s\d{4,5}$/i,s=!0;if(/^tcp|udp$/i.test(t[0])){for(var l=0,i=1;i<t.length;i++)if(a&&a.test(t[i])&&(l++,this.servantDetailModal.model.node_name=t[i].split(/\s/)[1],a=null),r&&r.test(t[i])&&(l++,r=null),o&&o.test(t[i])){var n=t[i].substring(2);n<0||n>65535||l++,o=null}s=3===l}else s=!1;return s},saveServantDetail:function(){var e=this;if(this.$refs.servantDetailForm.validate()){var t=this.$Loading.show();if(this.servantDetailModal.isNew){var a=this.servantDetailModal.model;a.servant=[a.application,a.server_name,a.obj_name].join("."),this.$ajax.postJSON("/server/api/add_adapter_conf",a).then(function(a){t.hide(),e.servantModal.model.unshift(a),e.$tip.success(e.$t("common.success")),e.closeServantDetailModal()}).catch(function(a){t.hide(),e.$tip.error(e.$t("common.error")+": "+(a.err_msg||a.message))})}else this.servantDetailModal.model.servant=this.servantDetailModal.model.application+"."+this.servantDetailModal.model.server_name+"."+this.servantDetailModal.model.obj_name,this.$ajax.postJSON("/server/api/update_adapter_conf",this.servantDetailModal.model).then(function(a){t.hide(),e.servantModal.model=e.servantModal.model.map(function(e){return e.id===a.id?a:e}),e.$tip.success(e.$t("common.success")),e.closeServantDetailModal()}).catch(function(a){t.hide(),e.$tip.error(e.$t("common.error")+": "+(a.err_msg||a.message))})}},deleteServant:function(e){var t=this;this.$confirm(this.$t("serverList.servant.a"),this.$t("common.alert")).then(function(){var a=t.$Loading.show();t.$ajax.getJSON("/server/api/delete_adapter_conf",{id:e}).then(function(r){a.hide(),t.servantModal.model=t.servantModal.model.map(function(t){if(t.id!==e)return t}).filter(function(e){return e}),t.$tip.success(t.$t("common.success"))}).catch(function(e){a.hide(),t.$tip.error(t.$t("common.error")+": "+(e.err_msg||e.message))})})},showMoreCmd:function(e){var t=this;this.moreCmdModal.model={selected:"setloglevel",setloglevel:"NONE",loadconfig:"",command:"",configs:null},this.moreCmdModal.unwatch=this.$watch("moreCmdModal.model.selected",function(){t.$refs.moreCmdForm&&t.$refs.moreCmdForm.resetValid()}),this.moreCmdModal.show=!0,this.moreCmdModal.currentServer=e,this.$ajax.getJSON("/server/api/config_file_list",{level:5,application:e.application,server_name:e.server_name}).then(function(e){t.moreCmdModal.model&&(t.moreCmdModal.model.configs=e)}).catch(function(e){t.$tip.error(t.$t("common.error")+": "+(e.err_msg||e.message))})},sendCommand:function(e,t,a){var r=this,o=this.$Loading.show();this.$ajax.getJSON("/server/api/send_command",{server_ids:e,command:t}).then(function(e){o.hide();var t=e[0].err_msg.replace(/\n/g,"<br>");if(0!==e[0].ret_code)throw new Error(t);var s={title:r.$t("common.success"),message:t};a&&(s.duration=0),r.$tip.success(s)}).catch(function(e){o.hide(),r.$tip.error({title:r.$t("common.error"),message:e.err_msg||e.message})})},invokeMoreCmd:function(){var e=this.moreCmdModal.model,t=this.moreCmdModal.currentServer;"undeploy_tars"===e.selected?this.undeployServer(t.id):"setloglevel"===e.selected?this.sendCommand(t.id,"tars.setloglevel "+e.setloglevel):"loadconfig"===e.selected&&this.$refs.moreCmdForm.validate()?this.sendCommand(t.id,"tars.loadconfig "+e.loadconfig):"command"===e.selected&&this.$refs.moreCmdForm.validate()?this.sendCommand(t.id,e.command):"connection"===e.selected&&this.sendCommand(t.id,"tars.connection",!0)},closeMoreCmdModal:function(){this.$refs.moreCmdForm&&this.$refs.moreCmdForm.resetValid(),this.moreCmdModal.unwatch&&this.moreCmdModal.unwatch(),this.moreCmdModal.show=!1,this.moreCmdModal.model=null},handleNoPublishedTime:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.$t("pub.dlg.unpublished");return"0000:00:00 00:00:00"===e?t:e}},created:function(){this.serverData=this.$parent.getServerData()},mounted:function(){this.getServerList(),this.getServerNotifyList(1)}},d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page_server_manage"},[e.serverList?a("let-table",{ref:"serverListLoading",attrs:{data:e.serverList,title:e.$t("serverList.title.serverList"),"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{title:e.$t("serverList.table.th.service"),prop:"server_name"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.ip"),prop:"node_name",width:"140px"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.enableSet")},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.enable_set?a("p",{staticStyle:{"max-width":"200px"}},[e._v("\n          "+e._s(e.$t("common.set.setName"))+"："+e._s(t.row.set_name)),a("br"),e._v("\n          "+e._s(e.$t("common.set.setArea"))+"："+e._s(t.row.set_area)),a("br"),e._v("\n          "+e._s(e.$t("common.set.setGroup"))+"："+e._s(t.row.set_group)+"\n        ")]):a("span",[e._v(e._s(e.$t("common.disable")))])]}}],null,!1,1670625483)}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.configStatus"),width:"90px"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("span",{class:"active"===e.row.setting_state?"status-active":"status-off"})]}}],null,!1,3224184510)}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.currStatus"),width:"65px"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("span",{class:"active"===e.row.present_state?"status-active":"activating"===e.row.present_state?"status-activating":"status-off"})]}}],null,!1,4116932289)}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.processID"),prop:"process_id",width:"80px"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.version"),prop:"patch_version",width:"68px"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.time")},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticStyle:{"word-break":"break-word"}},[e._v(e._s(e.handleNoPublishedTime(t.row.patch_time)))])]}}],null,!1,3144837894)}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("operate.operates"),width:"260px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-table-operation",{on:{click:function(a){return e.configServer(t.row.id)}}},[e._v(e._s(e.$t("operate.update")))]),e._v(" "),a("let-table-operation",{on:{click:function(a){return e.restartServer(t.row.id)}}},[e._v(e._s(e.$t("operate.restart")))]),e._v(" "),a("let-table-operation",{staticClass:"danger",on:{click:function(a){return e.stopServer(t.row.id)}}},[e._v(e._s(e.$t("operate.stop")))]),e._v(" "),a("let-table-operation",{on:{click:function(a){return e.manageServant(t.row)}}},[e._v(e._s(e.$t("operate.servant")))]),e._v(" "),a("let-table-operation",{on:{click:function(a){return e.showMoreCmd(t.row)}}},[e._v(e._s(e.$t("operate.more")))])]}}],null,!1,3478261854)})],1):e._e(),e._v(" "),e.serverNotifyList&&e.showOthers?a("let-table",{ref:"serverNotifyListLoading",attrs:{data:e.serverNotifyList,title:e.$t("serverList.title.serverStatus"),"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{title:e.$t("common.time"),prop:"notifytime"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.serviceID"),prop:"server_id"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.threadID"),prop:"thread_id"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.result"),prop:"result"}})],1):e._e(),e._v(" "),a("let-pagination",{staticStyle:{"margin-bottom":"32px"},attrs:{page:e.pageNum,total:e.total},on:{change:e.gotoPage}}),e._v(" "),a("let-modal",{attrs:{title:e.$t("serverList.dlg.title.editService"),width:"800px",footShow:!(!e.configModal.model||!e.configModal.model.server_name)},on:{"on-confirm":e.saveConfig,close:e.closeConfigModal,"on-cancel":e.closeConfigModal},model:{value:e.configModal.show,callback:function(t){e.$set(e.configModal,"show",t)},expression:"configModal.show"}},[e.configModal.model&&e.configModal.model.server_name?a("let-form",{ref:"configForm",staticClass:"two-columns",attrs:{itemWidth:"360px",columns:2}},[a("let-form-item",{attrs:{label:e.$t("common.service")}},[e._v(e._s(e.configModal.model.server_name))]),e._v(" "),a("let-form-item",{attrs:{label:e.$t("common.ip")}},[e._v(e._s(e.configModal.model.node_name))]),e._v(" "),a("let-form-item",{attrs:{label:e.$t("serverList.dlg.isBackup"),required:""}},[a("let-radio-group",{attrs:{size:"small",data:[{value:!0,text:e.$t("common.yes")},{value:!1,text:e.$t("common.no")}]},model:{value:e.configModal.model.bak_flag,callback:function(t){e.$set(e.configModal.model,"bak_flag",t)},expression:"configModal.model.bak_flag"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("common.template"),required:""}},[e.configModal.model.templates&&e.configModal.model.templates.length?a("let-select",{attrs:{size:"small",required:""},model:{value:e.configModal.model.template_name,callback:function(t){e.$set(e.configModal.model,"template_name",t)},expression:"configModal.model.template_name"}},e._l(e.configModal.model.templates,function(t){return a("let-option",{key:t,attrs:{value:t}},[e._v(e._s(t))])}),1):a("span",[e._v(e._s(e.configModal.model.template_name))])],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("serverList.dlg.serviceType"),required:""}},[a("let-select",{attrs:{size:"small",required:""},model:{value:e.configModal.model.server_type,callback:function(t){e.$set(e.configModal.model,"server_type",t)},expression:"configModal.model.server_type"}},e._l(e.serverTypes,function(t){return a("let-option",{key:t,attrs:{value:t}},[e._v(e._s(t))])}),1)],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("serverList.table.th.enableSet"),required:""}},[a("let-radio-group",{attrs:{size:"small",data:[{value:!0,text:e.$t("common.enable")},{value:!1,text:e.$t("common.disable")}]},model:{value:e.configModal.model.enable_set,callback:function(t){e.$set(e.configModal.model,"enable_set",t)},expression:"configModal.model.enable_set"}})],1),e._v(" "),e.configModal.model.enable_set?a("let-form-item",{attrs:{label:e.$t("common.set.setName"),required:""}},[a("let-input",{attrs:{size:"small",placeholder:e.$t("serverList.dlg.errMsg.setName"),required:"",pattern:"^[a-z]+$","pattern-tip":e.$t("serverList.dlg.errMsg.setName")},model:{value:e.configModal.model.set_name,callback:function(t){e.$set(e.configModal.model,"set_name",t)},expression:"configModal.model.set_name"}})],1):e._e(),e._v(" "),e.configModal.model.enable_set?a("let-form-item",{attrs:{label:e.$t("common.set.setArea"),required:""}},[a("let-input",{attrs:{size:"small",placeholder:e.$t("serverList.dlg.errMsg.setArea"),required:"",pattern:"^[a-z]+$","pattern-tip":e.$t("serverList.dlg.errMsg.setArea")},model:{value:e.configModal.model.set_area,callback:function(t){e.$set(e.configModal.model,"set_area",t)},expression:"configModal.model.set_area"}})],1):e._e(),e._v(" "),e.configModal.model.enable_set?a("let-form-item",{attrs:{label:e.$t("common.set.setGroup"),required:""}},[a("let-input",{attrs:{size:"small",placeholder:e.$t("serverList.dlg.errMsg.setGroup"),required:"",pattern:"^[0-9\\*]+$","pattern-tip":e.$t("serverList.dlg.errMsg.setGroup")},model:{value:e.configModal.model.set_group,callback:function(t){e.$set(e.configModal.model,"set_group",t)},expression:"configModal.model.set_group"}})],1):e._e(),e._v(" "),a("let-form-item",{attrs:{label:e.$t("serverList.dlg.asyncThread"),required:""}},[a("let-input",{attrs:{size:"small",placeholder:e.$t("serverList.dlg.placeholder.thread"),required:"",pattern:"tars_nodejs"===e.configModal.model.server_type?"^[1-9][0-9]*$":"^([3-9]|[1-9][0-9]+)$","pattern-tip":"$t('serverList.dlg.placeholder.thread')"},model:{value:e.configModal.model.async_thread_num,callback:function(t){e.$set(e.configModal.model,"async_thread_num",t)},expression:"configModal.model.async_thread_num"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("serverList.dlg.defaultPath")}},[a("let-input",{attrs:{size:"small"},model:{value:e.configModal.model.base_path,callback:function(t){e.$set(e.configModal.model,"base_path",t)},expression:"configModal.model.base_path"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("serverList.dlg.exePath")}},[a("let-input",{attrs:{size:"small"},model:{value:e.configModal.model.exe_path,callback:function(t){e.$set(e.configModal.model,"exe_path",t)},expression:"configModal.model.exe_path"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("serverList.dlg.startScript")}},[a("let-input",{attrs:{size:"small"},model:{value:e.configModal.model.start_script_path,callback:function(t){e.$set(e.configModal.model,"start_script_path",t)},expression:"configModal.model.start_script_path"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("serverList.dlg.stopScript")}},[a("let-input",{attrs:{size:"small"},model:{value:e.configModal.model.stop_script_path,callback:function(t){e.$set(e.configModal.model,"stop_script_path",t)},expression:"configModal.model.stop_script_path"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("serverList.dlg.monitorScript"),itemWidth:"724px"}},[a("let-input",{attrs:{size:"small"},model:{value:e.configModal.model.monitor_script_path,callback:function(t){e.$set(e.configModal.model,"monitor_script_path",t)},expression:"configModal.model.monitor_script_path"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("serverList.dlg.privateTemplate"),labelWidth:"150px",itemWidth:"724px"}},[a("let-input",{attrs:{size:"large",type:"textarea",rows:4},model:{value:e.configModal.model.profile,callback:function(t){e.$set(e.configModal.model,"profile",t)},expression:"configModal.model.profile"}})],1)],1):a("div",{ref:"configFormLoading",staticClass:"loading-placeholder"})],1),e._v(" "),a("let-modal",{attrs:{title:e.$t("serverList.table.servant.title"),width:"1200px",footShow:!1},on:{close:e.closeServantModal},model:{value:e.servantModal.show,callback:function(t){e.$set(e.servantModal,"show",t)},expression:"servantModal.show"}},[a("let-button",{staticClass:"tbm16",attrs:{size:"small",theme:"primary"},on:{click:function(t){return e.configServant()}}},[e._v(e._s(e.$t("operate.add"))+" Servant")]),e._v(" "),e.servantModal.model?a("let-table",{attrs:{data:e.servantModal.model,"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{title:e.$t("operate.servant"),prop:"servant"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.table.servant.adress"),prop:"endpoint"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.table.servant.thread"),prop:"thread_num"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.table.servant.maxConnecttions"),prop:"max_connections"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.table.servant.maxQueue"),prop:"queuecap"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.table.servant.timeout"),prop:"queuetimeout"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("operate.operates"),width:"90px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-table-operation",{on:{click:function(a){return e.configServant(t.row.id)}}},[e._v(e._s(e.$t("operate.update")))]),e._v(" "),a("let-table-operation",{staticClass:"danger",on:{click:function(a){return e.deleteServant(t.row.id)}}},[e._v(e._s(e.$t("operate.delete")))])]}}],null,!1,489266128)})],1):a("div",{ref:"servantModalLoading",staticClass:"loading-placeholder"})],1),e._v(" "),a("let-modal",{attrs:{title:e.servantDetailModal.isNew?e.$t("operate.title.add")+" Servant":e.$t("operate.title.update")+" Servant",width:"800px",footShow:!!e.servantDetailModal.model},on:{"on-confirm":e.saveServantDetail,close:e.closeServantDetailModal,"on-cancel":e.closeServantDetailModal},model:{value:e.servantDetailModal.show,callback:function(t){e.$set(e.servantDetailModal,"show",t)},expression:"servantDetailModal.show"}},[e.servantDetailModal.model?a("let-form",{ref:"servantDetailForm",staticClass:"two-columns",attrs:{itemWidth:"360px",columns:2}},[a("let-form-item",{attrs:{label:e.$t("serverList.servant.appService"),itemWidth:"724px"}},[a("span",[e._v(e._s(e.servantDetailModal.model.application)+"·"+e._s(e.servantDetailModal.model.server_name))])]),e._v(" "),a("let-form-item",{attrs:{label:e.$t("serverList.servant.objName"),required:""}},[a("let-input",{attrs:{size:"small",placeholder:e.$t("serverList.servant.c"),required:"",pattern:"^[A-Za-z]+$","pattern-tip":e.$t("serverList.servant.obj")},model:{value:e.servantDetailModal.model.obj_name,callback:function(t){e.$set(e.servantDetailModal.model,"obj_name",t)},expression:"servantDetailModal.model.obj_name"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("serverList.servant.numOfThread"),required:""}},[a("let-input",{attrs:{size:"small",placeholder:e.$t("serverList.servant.thread"),required:"",pattern:"^[1-9][0-9]*$","pattern-tip":e.$t("serverList.servant.thread")},model:{value:e.servantDetailModal.model.thread_num,callback:function(t){e.$set(e.servantDetailModal.model,"thread_num",t)},expression:"servantDetailModal.model.thread_num"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("serverList.table.servant.adress"),required:"",itemWidth:"724px"}},[a("let-input",{ref:"endpoint",attrs:{size:"small",placeholder:"tcp -h 127.0.0.1 -t 60000 -p 12000",required:"",extraTip:e.isEndpointValid?"":e.$t("serverList.servant.error")},model:{value:e.servantDetailModal.model.endpoint,callback:function(t){e.$set(e.servantDetailModal.model,"endpoint",t)},expression:"servantDetailModal.model.endpoint"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("serverList.servant.maxConnecttions"),labelWidth:"150px"}},[a("let-input",{attrs:{size:"small"},model:{value:e.servantDetailModal.model.max_connections,callback:function(t){e.$set(e.servantDetailModal.model,"max_connections",t)},expression:"servantDetailModal.model.max_connections"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("serverList.servant.lengthOfQueue"),labelWidth:"150px"}},[a("let-input",{attrs:{size:"small"},model:{value:e.servantDetailModal.model.queuecap,callback:function(t){e.$set(e.servantDetailModal.model,"queuecap",t)},expression:"servantDetailModal.model.queuecap"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("serverList.servant.queueTimeout"),labelWidth:"150px"}},[a("let-input",{attrs:{size:"small"},model:{value:e.servantDetailModal.model.queuetimeout,callback:function(t){e.$set(e.servantDetailModal.model,"queuetimeout",t)},expression:"servantDetailModal.model.queuetimeout"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("serverList.servant.allowIP")}},[a("let-input",{attrs:{size:"small"},model:{value:e.servantDetailModal.model.allow_ip,callback:function(t){e.$set(e.servantDetailModal.model,"allow_ip",t)},expression:"servantDetailModal.model.allow_ip"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("serverList.servant.protocol"),required:""}},[a("let-radio-group",{attrs:{size:"small",data:[{value:"tars",text:"TARS"},{value:"not_tars",text:e.$t("serverList.servant.notTARS")}]},model:{value:e.servantDetailModal.model.protocol,callback:function(t){e.$set(e.servantDetailModal.model,"protocol",t)},expression:"servantDetailModal.model.protocol"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("serverList.servant.treatmentGroup"),labelWidth:"150px"}},[a("let-input",{attrs:{size:"small"},model:{value:e.servantDetailModal.model.handlegroup,callback:function(t){e.$set(e.servantDetailModal.model,"handlegroup",t)},expression:"servantDetailModal.model.handlegroup"}})],1)],1):e._e()],1),e._v(" "),a("let-modal",{staticClass:"more-cmd",attrs:{title:e.$t("operate.title.more"),width:"700px"},on:{"on-confirm":e.invokeMoreCmd,close:e.closeMoreCmdModal,"on-cancel":e.closeMoreCmdModal},model:{value:e.moreCmdModal.show,callback:function(t){e.$set(e.moreCmdModal,"show",t)},expression:"moreCmdModal.show"}},[e.moreCmdModal.model?a("let-form",{ref:"moreCmdForm"},[a("let-form-item",{attrs:{itemWidth:"100%"}},[a("let-radio",{attrs:{label:"setloglevel"},model:{value:e.moreCmdModal.model.selected,callback:function(t){e.$set(e.moreCmdModal.model,"selected",t)},expression:"moreCmdModal.model.selected"}},[e._v(e._s(e.$t("serverList.servant.logLevel")))]),e._v(" "),a("let-select",{attrs:{size:"small",disabled:"setloglevel"!==e.moreCmdModal.model.selected},model:{value:e.moreCmdModal.model.setloglevel,callback:function(t){e.$set(e.moreCmdModal.model,"setloglevel",t)},expression:"moreCmdModal.model.setloglevel"}},e._l(e.logLevels,function(t){return a("let-option",{key:t,attrs:{value:t}},[e._v(e._s(t))])}),1)],1),e._v(" "),a("let-form-item",{attrs:{itemWidth:"100%"}},[a("let-radio",{attrs:{label:"loadconfig"},model:{value:e.moreCmdModal.model.selected,callback:function(t){e.$set(e.moreCmdModal.model,"selected",t)},expression:"moreCmdModal.model.selected"}},[e._v(e._s(e.$t("serverList.servant.pushFile")))]),e._v(" "),a("let-select",{attrs:{size:"small",placeholder:e.moreCmdModal.model.configs&&e.moreCmdModal.model.configs.length?e.$t("pub.dlg.defaultValue"):e.$t("pub.dlg.noConfFile"),disabled:!(e.moreCmdModal.model.configs&&e.moreCmdModal.model.configs.length)||"loadconfig"!==e.moreCmdModal.model.selected,required:"loadconfig"===e.moreCmdModal.model.selected},model:{value:e.moreCmdModal.model.loadconfig,callback:function(t){e.$set(e.moreCmdModal.model,"loadconfig",t)},expression:"moreCmdModal.model.loadconfig"}},e._l(e.moreCmdModal.model.configs,function(t){return a("let-option",{key:t.filename,attrs:{value:t.filename}},[e._v(e._s(t.filename))])}),1)],1),e._v(" "),a("let-form-item",{attrs:{itemWidth:"100%"}},[a("let-radio",{attrs:{label:"command"},model:{value:e.moreCmdModal.model.selected,callback:function(t){e.$set(e.moreCmdModal.model,"selected",t)},expression:"moreCmdModal.model.selected"}},[e._v(e._s(e.$t("serverList.servant.sendCommand")))]),e._v(" "),a("let-input",{attrs:{size:"small",disabled:"command"!==e.moreCmdModal.model.selected,required:"command"===e.moreCmdModal.model.selected},model:{value:e.moreCmdModal.model.command,callback:function(t){e.$set(e.moreCmdModal.model,"command",t)},expression:"moreCmdModal.model.command"}})],1),e._v(" "),a("let-form-item",{attrs:{itemWidth:"100%"}},[a("let-radio",{attrs:{label:"connection"},model:{value:e.moreCmdModal.model.selected,callback:function(t){e.$set(e.moreCmdModal.model,"selected",t)},expression:"moreCmdModal.model.selected"}},[e._v(e._s(e.$t("serverList.servant.serviceLink")))])],1),e._v(" "),a("let-form-item",{attrs:{itemWidth:"100%"}},[a("let-radio",{staticClass:"danger",attrs:{label:"undeploy_tars"},model:{value:e.moreCmdModal.model.selected,callback:function(t){e.$set(e.moreCmdModal.model,"selected",t)},expression:"moreCmdModal.model.selected"}},[e._v(e._s(e.$t("operate.undeploy"))+" "+e._s(e.$t("common.service")))])],1)],1):e._e()],1)],1)},staticRenderFns:[]};var u=a("VU/8")(c,d,!1,function(e){a("rDdf")},null,null);t.a=u.exports},KtFB:function(e,t){},M8l6:function(e,t,a){"use strict";var r=a("S1cf");e.exports=function(e,t){r.forEach(e,function(a,r){r!==t&&r.toUpperCase()===t.toUpperCase()&&(e[t]=a,delete e[r])})}},MJuj:function(e,t){},NezY:function(e,t){},NxlF:function(e,t){},O444:function(e,t){},OvAf:function(e,t,a){"use strict";var r=a("BXyq"),o=a("S1cf"),s=a("rj2i"),l=a("uz6X");function i(e){this.defaults=e,this.interceptors={request:new s,response:new s}}i.prototype.request=function(e){"string"==typeof e&&(e=o.merge({url:arguments[0]},arguments[1])),(e=o.merge(r,{method:"get"},this.defaults,e)).method=e.method.toLowerCase();var t=[l,void 0],a=Promise.resolve(e);for(this.interceptors.request.forEach(function(e){t.unshift(e.fulfilled,e.rejected)}),this.interceptors.response.forEach(function(e){t.push(e.fulfilled,e.rejected)});t.length;)a=a.then(t.shift(),t.shift());return a},o.forEach(["delete","get","head","options"],function(e){i.prototype[e]=function(t,a){return this.request(o.merge(a||{},{method:e,url:t}))}}),o.forEach(["post","put","patch"],function(e){i.prototype[e]=function(t,a,r){return this.request(o.merge(r||{},{method:e,url:t,data:a}))}}),e.exports=i},Qi1R:function(e,t){},S1cf:function(e,t,a){"use strict";var r=a("ED/T"),o=a("q/Zl"),s=Object.prototype.toString;function l(e){return"[object Array]"===s.call(e)}function i(e){return null!==e&&"object"==typeof e}function n(e){return"[object Function]"===s.call(e)}function c(e,t){if(null!==e&&void 0!==e)if("object"!=typeof e&&(e=[e]),l(e))for(var a=0,r=e.length;a<r;a++)t.call(null,e[a],a,e);else for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.call(null,e[o],o,e)}e.exports={isArray:l,isArrayBuffer:function(e){return"[object ArrayBuffer]"===s.call(e)},isBuffer:o,isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:i,isUndefined:function(e){return void 0===e},isDate:function(e){return"[object Date]"===s.call(e)},isFile:function(e){return"[object File]"===s.call(e)},isBlob:function(e){return"[object Blob]"===s.call(e)},isFunction:n,isStream:function(e){return i(e)&&n(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:c,merge:function e(){var t={};function a(a,r){"object"==typeof t[r]&&"object"==typeof a?t[r]=e(t[r],a):t[r]=a}for(var r=0,o=arguments.length;r<o;r++)c(arguments[r],a);return t},extend:function(e,t,a){return c(t,function(t,o){e[o]=a&&"function"==typeof t?r(t,a):t}),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}}},SJ4V:function(e,t,a){"use strict";var r=a("Tx4S"),o=a("q2c9"),s=a("CeRa"),l={name:"ServerPropertyMonitor",components:{HoursFilter:o.a,CompareChart:s.a},data:function(){var e=this.$route.params.treeid;return{query:{thedate:Object(r.b)(new Date,"YYYYMMDD"),predate:Object(r.b)(Date.now()-r.a,"YYYYMMDD"),startshowtime:"0000",endshowtime:"2360",master_name:"",slave_name:e.split(".").map(function(e){return e.replace(/^\d+/,"")}).join("."),interface_name:"",master_ip:"",slave_ip:"",group_by:""},formatter:"YYYYMMDD",allItems:[],hour:-1,page:1}},computed:{filteredItems:function(){var e=this.hour;return e>=0?this.allItems.filter(function(t){return+t.show_time.slice(0,2)===e}):this.allItems},itemsCount:function(){return this.filteredItems.length},pageCount:function(){return Math.ceil(this.filteredItems.length/20)},pagedItems:function(){return this.filteredItems.slice(20*(this.page-1),20*this.page)},charts:function(){return[{title:this.$t("monitor.table.total"),timeColumn:"show_time",dataColumns:[{name:"the_total_count",label:this.$t("monitor.table.curr")},{name:"pre_total_count",label:this.$t("monitor.table.contrast")}],data:this.allItems},{title:this.$t("monitor.table.a"),timeColumn:"show_time",dataColumns:[{name:"the_avg_time",label:this.$t("monitor.table.curr")},{name:"pre_avg_time",label:this.$t("monitor.table.contrast")}],data:this.allItems},{title:this.$t("monitor.table.b"),timeColumn:"show_time",dataColumns:[{name:"the_fail_rate",label:this.$t("monitor.table.curr")},{name:"pre_fail_rate",label:this.$t("monitor.table.contrast")}],data:this.allItems},{title:this.$t("monitor.table.c"),timeColumn:"show_time",dataColumns:[{name:"the_timeout_rate",label:this.$t("monitor.table.curr")},{name:"pre_timeout_rate",label:this.$t("monitor.table.contrast")}],data:this.allItems}]},chartOptions:function(){return{title:{show:!0,text:this.$t("monitor.table.curr")+" "+this.$t("monitor.table.total")},grid:{bottom:40,top:50},legend:{top:5},settings:{labelMap:{the_value:this.$t("monitor.property.property"),pre_value:this.$t("monitor.property.propertyC")},scale:[!0,!1]},data:{columns:["show_time","the_value","pre_value"],rows:this.allItems}}}},mounted:function(){this.fetchData()},methods:{fetchData:function(){var e=this,t=this.$refs.charts.$loading.show(),a=this.$refs.table.$loading.show();return this.$ajax.getJSON("/server/api/tarsstat_monitor_data",this.query).then(function(r){t.hide(),a.hide(),e.allItems=r}).catch(function(r){t.hide(),a.hide(),e.$tip.error(e.$t("common.error")+": "+(r.message||r.err_msg))})},groupBy:function(e){this.query.group_by=e,this.fetchData()},search:function(){delete this.query.group_by,this.fetchData()},changePage:function(e){this.page=e}}},i={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page_server_server_monitor"},[a("let-form",{attrs:{inline:"",itemWidth:"200px"},nativeOn:{submit:function(t){return t.preventDefault(),e.search(t)}}},[a("let-form-item",{attrs:{label:e.$t("monitor.search.a")}},[a("let-date-picker",{attrs:{size:"small",formatter:e.formatter},model:{value:e.query.thedate,callback:function(t){e.$set(e.query,"thedate",t)},expression:"query.thedate"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("monitor.search.b")}},[a("let-date-picker",{attrs:{size:"small",formatter:e.formatter},model:{value:e.query.predate,callback:function(t){e.$set(e.query,"predate",t)},expression:"query.predate"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("monitor.search.start")}},[a("let-input",{attrs:{size:"small"},model:{value:e.query.startshowtime,callback:function(t){e.$set(e.query,"startshowtime",t)},expression:"query.startshowtime"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("monitor.search.end")}},[a("let-input",{attrs:{size:"small"},model:{value:e.query.endshowtime,callback:function(t){e.$set(e.query,"endshowtime",t)},expression:"query.endshowtime"}})],1),e._v(" "),a("tars-form-item",{attrs:{label:e.$t("monitor.search.interfaceName")},on:{onLabelClick:function(t){return e.groupBy("interface_name")}}},[a("let-input",{attrs:{size:"small"},model:{value:e.query.interface_name,callback:function(t){e.$set(e.query,"interface_name",t)},expression:"query.interface_name"}})],1),e._v(" "),a("tars-form-item",{attrs:{label:e.$t("monitor.search.master")},on:{onLabelClick:function(t){return e.groupBy("master_name")}}},[a("let-input",{attrs:{size:"small"},model:{value:e.query.master_name,callback:function(t){e.$set(e.query,"master_name",t)},expression:"query.master_name"}})],1),e._v(" "),a("tars-form-item",{attrs:{label:e.$t("monitor.search.slave")},on:{onLabelClick:function(t){return e.groupBy("slave_name")}}},[a("let-input",{attrs:{size:"small"},model:{value:e.query.slave_name,callback:function(t){e.$set(e.query,"slave_name",t)},expression:"query.slave_name"}})],1),e._v(" "),a("tars-form-item",{attrs:{label:e.$t("monitor.search.masterIP")},on:{onLabelClick:function(t){return e.groupBy("master_ip")}}},[a("let-input",{attrs:{size:"small"},model:{value:e.query.master_ip,callback:function(t){e.$set(e.query,"master_ip",t)},expression:"query.master_ip"}})],1),e._v(" "),a("tars-form-item",{attrs:{label:e.$t("monitor.search.slaveIP")},on:{onLabelClick:function(t){return e.groupBy("slave_ip")}}},[a("let-input",{attrs:{size:"small"},model:{value:e.query.slave_ip,callback:function(t){e.$set(e.query,"slave_ip",t)},expression:"query.slave_ip"}})],1),e._v(" "),a("let-form-item",[a("let-button",{attrs:{size:"small",type:"submit",theme:"primary"}},[e._v(e._s(e.$t("operate.search")))])],1)],1),e._v(" "),a("let-row",{ref:"charts",staticClass:"charts"},e._l(e.charts,function(t){return a("let-col",{key:t.title,attrs:{span:12}},[a("compare-chart",e._b({},"compare-chart",t,!1))],1)}),1),e._v(" "),a("hours-filter",{model:{value:e.hour,callback:function(t){e.hour=t},expression:"hour"}}),e._v(" "),a("let-table",{ref:"table",attrs:{data:e.pagedItems,"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{title:e.$t("common.time"),prop:"show_time",width:"80px"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("monitor.search.master"),prop:"master_name",width:""}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("monitor.search.slave"),prop:"slave_name",width:""}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("monitor.search.interfaceName"),prop:"interface_name",width:""}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("monitor.search.masterIP"),prop:"master_ip",width:""}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("monitor.search.slaveIP"),prop:"slave_ip",width:""}}),e._v(" "),a("let-table-column",{attrs:{prop:"the_total_count",align:"right"},scopedSlots:e._u([{key:"head",fn:function(t){return a("span",{},[e._v(e._s(e.$t("monitor.table.curr"))),a("br"),e._v(e._s(e.$t("monitor.table.total")))])}}])}),e._v(" "),a("let-table-column",{attrs:{prop:"pre_total_count",align:"right"},scopedSlots:e._u([{key:"head",fn:function(t){return a("span",{},[e._v(e._s(e.$t("monitor.table.contrast"))),a("br"),e._v(e._s(e.$t("monitor.table.total")))])}}])}),e._v(" "),a("let-table-column",{attrs:{prop:"total_count_wave",align:"right"},scopedSlots:e._u([{key:"head",fn:function(t){return a("span",{},[e._v(e._s(e.$t("monitor.table.fluctuating")))])}}])}),e._v(" "),a("let-table-column",{attrs:{align:"right"},scopedSlots:e._u([{key:"head",fn:function(t){return a("span",{},[e._v(e._s(e.$t("monitor.table.curr"))),a("br"),e._v(e._s(e.$t("monitor.table.a")))])}},{key:"default",fn:function(t){return[e._v(e._s(t.row.the_avg_time)+"ms")]}}])}),e._v(" "),a("let-table-column",{attrs:{align:"right"},scopedSlots:e._u([{key:"head",fn:function(t){return a("span",{},[e._v(e._s(e.$t("monitor.table.contrast"))),a("br"),e._v(e._s(e.$t("monitor.table.a")))])}},{key:"default",fn:function(t){return[e._v(e._s(t.row.pre_avg_time)+"ms")]}}])}),e._v(" "),a("let-table-column",{attrs:{prop:"the_fail_rate",align:"right"},scopedSlots:e._u([{key:"head",fn:function(t){return a("span",{},[e._v(e._s(e.$t("monitor.table.curr"))),a("br"),e._v(e._s(e.$t("monitor.table.b")))])}}])}),e._v(" "),a("let-table-column",{attrs:{prop:"pre_fail_rate",align:"right"},scopedSlots:e._u([{key:"head",fn:function(t){return a("span",{},[e._v(e._s(e.$t("monitor.table.contrast"))),a("br"),e._v(e._s(e.$t("monitor.table.b")))])}}])}),e._v(" "),a("let-table-column",{attrs:{prop:"the_timeout_rate",align:"right"},scopedSlots:e._u([{key:"head",fn:function(t){return a("span",{},[e._v(e._s(e.$t("monitor.table.curr"))),a("br"),e._v(e._s(e.$t("monitor.table.c")))])}}])}),e._v(" "),a("let-table-column",{attrs:{prop:"pre_timeout_rate",align:"right"},scopedSlots:e._u([{key:"head",fn:function(t){return a("span",{},[e._v(e._s(e.$t("monitor.table.contrast"))),a("br"),e._v(e._s(e.$t("monitor.table.c")))])}}])}),e._v(" "),e.pageCount?a("let-pagination",{attrs:{slot:"pagination",total:e.pageCount,page:e.page,sum:e.itemsCount,"show-sums":"",jump:""},on:{change:e.changePage},slot:"pagination"}):e._e()],1)],1)},staticRenderFns:[]};var n=a("VU/8")(l,i,!1,function(e){a("9VOc")},null,null);t.a=n.exports},Tx4S:function(e,t,a){"use strict";a.d(t,"a",function(){return i}),t.b=c;var r=a("fZjL"),o=a.n(r),s=6e4,l=60*s,i=24*l;function n(e){return null==e?new Date:e instanceof Date?e:new Date(e)}function c(e,t){if(e=n(e),t=t||"YYYY-MM-DD HH:mm:ss",isNaN(e.getTime()))return t;var a={"M+":e.getMonth()+1,"D+":e.getDate(),"H+":e.getHours(),"h+":e.getHours()%12==0?12:e.getHours()%12,"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()};return/(Y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length))),/(dd+)/.test(t)&&(t=t.replace(RegExp.$1,"日一二三四五六七".split("")[e.getDay()])),o()(a).forEach(function(e){if(new RegExp("("+e+")").test(t)){var r=RegExp.$1,o=""+a[e];t=t.replace(r,1===r.length?o:("00"+o).substr(o.length))}}),t}},"V3+0":function(e,t,a){"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},VnDC:function(e,t){},X8jb:function(e,t,a){"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},XSxf:function(e,t){},YdsM:function(e,t,a){"use strict";e.exports=function(e,t,a,r,o){return e.config=t,a&&(e.code=a),e.request=r,e.response=o,e}},ZSRx:function(e,t){},ZeD7:function(e,t,a){"use strict";var r=a("S1cf"),o=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,a,s,l={};return e?(r.forEach(e.split("\n"),function(e){if(s=e.indexOf(":"),t=r.trim(e.substr(0,s)).toLowerCase(),a=r.trim(e.substr(s+1)),t){if(l[t]&&o.indexOf(t)>=0)return;l[t]="set-cookie"===t?(l[t]?l[t]:[]).concat([a]):l[t]?l[t]+", "+a:a}}),l):l}},a2Uu:function(e,t,a){"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},a94L:function(e,t){},aS8y:function(e,t,a){"use strict";var r=a("3bIi");e.exports=function(e,t,a){var o=a.config.validateStatus;a.status&&o&&!o(a.status)?t(r("Request failed with status code "+a.status,a.config,null,a.request,a)):e(a)}},"dLd/":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGwAAAA4CAMAAAAvp+0eAAAAjVBMVEUAAABWXGZWXGdXW2ZWXGZbZGdWW2Z2dnhXXWdWXWdWXGdXXGdZX2hXW2dWXGZbX2phY2tXW2dXW2dZXWhWW2ZXW2ZXXGZoaG1XW2ZXW2dYXGdXW2dXXGZWW2dWXGdXXGZWXGZXXGdXXGdYXGdYXWhXXWdWW2ZWXGZXXWdbX2tXW2dXXGdYXGhYXmhWW2ZN3ep6AAAALnRSTlMA86bskRT6BUt8jHYvoPcbD7BtKebVxgrAuGJG2827m/CDZlc5Ud9/QCCHelwkFVYtqQAAA/pJREFUWMPFl91iqjAQhEUlKCKIYEVQi+C/dd7/8U4bQzYSKNFenLlhMeAH685m7aFN2x4pY741iI9ery4LivLNZPm87O2SmPmDD1fcaQQ7gWveAiOtI2UxCFGJ7Rxj2Apc004YYpteawBFm6UpLAfXogkWOJWiKwOG1ZIdA0hKb3Y/uz/h0BAWVclYNsBs5XTE4AciHgL+QcTOFcDZDJZCaN8B6/WB4hHNGHCghQIIzWCfEJp3wVKZxxJI1JUEltMbVvJFPVXnyhcvKli/CzYCVjKLhboy53msNKi+T9OMKrsTJt9nCzzZ8gBMTGAZpGbGsLi6mFZOJrATwc7dsI9HxGA9XVkawlYEm5jC7HrO58DYBJYTrN8N2/Dg8ghIk+Ox6ICRpRNerUdT2F3mU1EHjCy9++AH2xAWkVGNYWTpg8sPmSHMk4Yzh5GlgwM/3AwLxDN/M93ScS/gx9AclrwByyrIkUMNTb1kiN+Anar09R/pNOwgayB6HbaqCmPOg1EXLJRltXodllclv+fB6VfYF3B9RBcmQ3NYJNu9w2296to8S8Uxffs1WEqfclvHHWOBVZ0vNwDysf0K7JO2aJcqpBm2t9TU2Wt8yw8PjjFsQcNH+WglrbC5D6xnikPFODH43JvBZjRWCVtfazB395D781jH4NmjCR4KIxNYRgOjsPX2lyE1FCzSZb5l/HHLDhhZ+lPWGjBohcVZr0l2yq0674bx68ScJGx9f4YN3eHQvU59KlRd+w3A7h2wytIej4Wty8YCOfMyatMyAcIOmLC0z4u3srX7DJtRDmhF052RaXQYWVrsGtLWSTMs5X1GF91a6jDN0mKilra2mmE2+7XPT6lEVJhu6S8eS1tHT7Cl8uyTdtiwcyKesUezGgkVxNZhN8r3W7AMTRo2wzyA2X+AnRphHxpMNpivP8BWjTDLUWGO+n39P8ByNMqrwSjpufM2LEKz0maY8312ruLLJTCHkaWnqraiLxOsRwoBl6plYQwjS8d6/9q0wFIiRMD6NdhCn3AcBoA5dRg1kYvohUBsCCNLa911wyuEYKzWAAtxLz2SGSyr9QvaQIsW2I02Eh8IXoGdqM5JE6oQHeaRCdfAyLARk6VZzTkjqhCCqU0kk5W5U7ts3rHF5DTrkAKatjjMr5eBKzO6flr4ffOM6nDlun0LLAMWdPeBPmdU1hqMLD2uwxJ1VLLkVkpN5CLLduApo7LvtcLov7Te5L411WDURAqagFjo/ihk36yydZSjXfpShxXqL2khf15Nqfh3ULTwWodUsrSlz4BUIQ0wm9EOVMQVan1b1gw05pJpC/hpoY+A/HNRWV9pWVuej+lfknNObz8Xn3v/Qf8AOMI3ricO6pwAAAAASUVORK5CYII="},dZBD:function(e,t,a){e.exports=a("nUiQ")},dn2M:function(e,t,a){"use strict";var r=a("S1cf");e.exports=r.isStandardBrowserEnv()?{write:function(e,t,a,o,s,l){var i=[];i.push(e+"="+encodeURIComponent(t)),r.isNumber(a)&&i.push("expires="+new Date(a).toGMTString()),r.isString(o)&&i.push("path="+o),r.isString(s)&&i.push("domain="+s),!0===l&&i.push("secure"),document.cookie=i.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},eo2X:function(e,t){},fT6T:function(e,t){},hVKt:function(e,t){},hrXV:function(e,t){},kM9U:function(e,t){},kiiE:function(e,t){},m6R6:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACwAAAAsBAMAAADsqkcyAAAAIVBMVEUAAACZsuGasuCbtuRFf/WZseD////q8P3z9vt6o/e2x+iGuTfsAAAABHRSTlMA6aYc+fzKlQAAAGFJREFUKM9jgIBQBEIA+gszK4YiASEDqLBhKAoQhgqrrkhDAl1BUGHRNmThjECYfWkuSCAtFI8w0A50YSDAIUyC2SPOJdMrsZpdlk6MMMIQOoYJZvLBl9gwkybuhDx4choAeHa83egTBYcAAAAASUVORK5CYII="},m8r6:function(e,t,a){"use strict";var r={data:function(){return{thisYear:(new Date).getFullYear()}}},o={render:function(){var e=this.$createElement;return(this._self._c||e)("div",{staticClass:"app_index__footer"})},staticRenderFns:[]};var s=a("VU/8")(r,o,!1,function(e){a("nipV")},null,null);t.a=s.exports},"mI+K":function(e,t,a){"use strict";function r(e){this.message=e}r.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},r.prototype.__CANCEL__=!0,e.exports=r},mmkS:function(e,t,a){"use strict";var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function o(){this.message="String contains an invalid character"}o.prototype=new Error,o.prototype.code=5,o.prototype.name="InvalidCharacterError",e.exports=function(e){for(var t,a,s=String(e),l="",i=0,n=r;s.charAt(0|i)||(n="=",i%1);l+=n.charAt(63&t>>8-i%1*8)){if((a=s.charCodeAt(i+=.75))>255)throw new o;t=t<<8|a}return l}},mxK3:function(e,t,a){"use strict";var r={render:function(){var e=this.$createElement;return(this._self._c||e)("section",{staticClass:"section"},[this._t("default")],2)},staticRenderFns:[]};var o=a("VU/8")(null,r,!1,function(e){a("4TWv")},"data-v-2643216f",null);t.a=o.exports},nUiQ:function(e,t,a){"use strict";var r=a("S1cf"),o=a("ED/T"),s=a("OvAf"),l=a("BXyq");function i(e){var t=new s(e),a=o(s.prototype.request,t);return r.extend(a,s.prototype,t),r.extend(a,t),a}var n=i(l);n.Axios=s,n.create=function(e){return i(r.merge(l,e))},n.Cancel=a("mI+K"),n.CancelToken=a("tsWd"),n.isCancel=a("V3+0"),n.all=function(e){return Promise.all(e)},n.spread=a("X8jb"),e.exports=n,e.exports.default=n},nipV:function(e,t){},ohPC:function(e,t){},"q/Zl":function(e,t){function a(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
e.exports=function(e){return null!=e&&(a(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&a(e.slice(0,0))}(e)||!!e._isBuffer)}},q2c9:function(e,t,a){"use strict";var r=Array.apply(null,{length:24}).map(function(e,t){return t}).map(function(e){return{val:e,txt:("0"+e).slice(-2)}}),o=[{val:-1,txt:"all"}].concat(r),s={name:"HoursFilter",props:{title:{type:String,default:""},value:Number},filters:{format:function(e){return("0"+e).slice(-2)}},data:function(){return{hours:o}},methods:{onChange:function(e){this.$emit("input",e)}}},l={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"hours-filter"},[a("h4",[e._v(e._s(e.title))]),e._v(" "),a("ul",e._l(e.hours,function(t){return a("li",{key:t.val,class:{active:t.val===e.value},on:{click:function(a){return e.onChange(t.val)}}},[e._v(e._s(t.txt)+"\n    ")])}),0)])},staticRenderFns:[]};var i=a("VU/8")(s,l,!1,function(e){a("C+K7")},null,null);t.a=i.exports},qneH:function(e,t){},rDdf:function(e,t){},rj2i:function(e,t,a){"use strict";var r=a("S1cf");function o(){this.handlers=[]}o.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},o.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},o.prototype.forEach=function(e){r.forEach(this.handlers,function(t){null!==t&&e(t)})},e.exports=o},s2Rr:function(e,t){},"sPk+":function(e,t){},sVYP:function(e,t,a){"use strict";var r=a("rplX"),o=(a.n(r),a("7+uW")),s=a("86n0");s.a.ServerUrl.set("/pages"),s.a.ResultHandler.set(function(e){return!(!e||200!==e.ret_code||null==e.data)}),["getJSON","postJSON"].forEach(function(e){var t=s.a[e];s.a["_"+e]=t,s.a[e]=function(){for(var e=arguments.length,a=Array(e),r=0;r<e;r++)a[r]=arguments[r];return t.call.apply(t,[null].concat(a)).then(function(e){return e.data})}}),Object.defineProperty(o.default.prototype,"$ajax",{get:function(){return s.a}}),t.a=s.a},sZcP:function(e,t){},"tqp+":function(e,t,a){"use strict";var r=a("Tx4S"),o=a("q2c9"),s=a("CeRa"),l={name:"ServerPropertyMonitor",components:{HoursFilter:o.a,CompareChart:s.a},data:function(){var e=this.$route.params.treeid;return{query:{thedate:Object(r.b)(new Date,"YYYYMMDD"),predate:Object(r.b)(Date.now()-r.a,"YYYYMMDD"),startshowtime:"0000",endshowtime:"2360",master_name:e.split(".").map(function(e){return e.replace(/^\d+/,"")}).join("."),master_ip:"",property_name:"",policy:"",group_by:""},formatter:"YYYYMMDD",allItems:[],hour:-1,page:1}},computed:{filteredItems:function(){var e=this.hour;return e>=0?this.allItems.filter(function(t){return+t.show_time.slice(0,2)===e}):this.allItems},itemsCount:function(){return this.filteredItems.length},pageCount:function(){return Math.ceil(this.filteredItems.length/20)},pagedItems:function(){return this.filteredItems.slice(20*(this.page-1),20*this.page)},chartOptions:function(){return{title:this.$t("monitor.table.total"),timeColumn:"show_time",dataColumns:[{name:"the_value",label:this.$t("monitor.property.property")},{name:"pre_value",label:this.$t("monitor.property.propertyC")}],data:this.allItems}}},mounted:function(){this.fetchData()},methods:{fetchData:function(){var e=this,t=this.$refs.chart.$loading.show(),a=this.$refs.table.$loading.show();return this.$ajax.getJSON("/server/api/tarsproperty_monitor_data",this.query).then(function(r){t.hide(),a.hide(),e.allItems=r}).catch(function(r){t.hide(),a.hide(),e.$tip.error(e.$t("common.error")+": "+(r.message||r.err_msg))})},groupBy:function(e){this.query.group_by=e,this.fetchData()},search:function(){delete this.query.group_by,this.fetchData()},changePage:function(e){this.page=e}}},i={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page_server_property_monitor"},[a("let-form",{attrs:{inline:"",itemWidth:"200px"},nativeOn:{submit:function(t){return t.preventDefault(),e.search(t)}}},[a("let-form-group",[a("let-form-item",{attrs:{label:e.$t("monitor.search.a")}},[a("let-date-picker",{attrs:{size:"small",formatter:e.formatter},model:{value:e.query.thedate,callback:function(t){e.$set(e.query,"thedate",t)},expression:"query.thedate"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("monitor.search.b")}},[a("let-date-picker",{attrs:{size:"small",formatter:e.formatter},model:{value:e.query.predate,callback:function(t){e.$set(e.query,"predate",t)},expression:"query.predate"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("monitor.search.start")}},[a("let-input",{attrs:{size:"small"},model:{value:e.query.startshowtime,callback:function(t){e.$set(e.query,"startshowtime",t)},expression:"query.startshowtime"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("monitor.search.end")}},[a("let-input",{attrs:{size:"small"},model:{value:e.query.endshowtime,callback:function(t){e.$set(e.query,"endshowtime",t)},expression:"query.endshowtime"}})],1)],1),e._v(" "),a("let-form-group",[a("tars-form-item",{attrs:{label:e.$t("monitor.search.master")},on:{onLabelClick:function(t){return e.groupBy("master_name")}}},[a("let-input",{attrs:{size:"small"},model:{value:e.query.master_name,callback:function(t){e.$set(e.query,"master_name",t)},expression:"query.master_name"}})],1),e._v(" "),a("tars-form-item",{attrs:{label:e.$t("monitor.search.masterIP")},on:{onLabelClick:function(t){return e.groupBy("master_ip")}}},[a("let-input",{attrs:{size:"small"},model:{value:e.query.master_ip,callback:function(t){e.$set(e.query,"master_ip",t)},expression:"query.master_ip"}})],1),e._v(" "),a("tars-form-item",{attrs:{label:e.$t("monitor.select.property")},on:{onLabelClick:function(t){return e.groupBy("property_name")}}},[a("let-input",{attrs:{size:"small"},model:{value:e.query.property_name,callback:function(t){e.$set(e.query,"property_name",t)},expression:"query.property_name"}})],1),e._v(" "),a("tars-form-item",{attrs:{label:e.$t("monitor.select.strategy")},on:{onLabelClick:function(t){return e.groupBy("policy")}}},[a("let-input",{attrs:{size:"small"},model:{value:e.query.policy,callback:function(t){e.$set(e.query,"policy",t)},expression:"query.policy"}})],1),e._v(" "),a("let-form-item",[a("let-button",{attrs:{size:"small",type:"submit",theme:"primary"}},[e._v(e._s(e.$t("operate.search")))])],1)],1)],1),e._v(" "),a("compare-chart",e._b({ref:"chart",staticClass:"chart"},"compare-chart",e.chartOptions,!1)),e._v(" "),a("hours-filter",{model:{value:e.hour,callback:function(t){e.hour=t},expression:"hour"}}),e._v(" "),a("let-table",{ref:"table",attrs:{data:e.pagedItems,"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{title:e.$t("common.time"),prop:"show_time",width:"80px"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("monitor.search.master"),prop:"master_name",width:""}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("monitor.search.masterIP"),prop:"master_ip",width:"150px"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("monitor.select.property"),prop:"property_name",width:"150px"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("monitor.select.strategy"),prop:"policy",width:"150px"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("monitor.property.property"),prop:"the_value",align:"right",width:"200px"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("monitor.property.propertyC"),prop:"pre_value",align:"right",width:"230px"}}),e._v(" "),e.pageCount?a("let-pagination",{attrs:{slot:"pagination",total:e.pageCount,page:e.page,sum:e.itemsCount,"show-sums":"",jump:""},on:{change:e.changePage},slot:"pagination"}):e._e()],1)],1)},staticRenderFns:[]};var n=a("VU/8")(l,i,!1,function(e){a("BMUR")},null,null);t.a=n.exports},tsWd:function(e,t,a){"use strict";var r=a("mI+K");function o(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise(function(e){t=e});var a=this;e(function(e){a.reason||(a.reason=new r(e),t(a.reason))})}o.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},o.source=function(){var e;return{token:new o(function(t){e=t}),cancel:e}},e.exports=o},uKo1:function(e,t){},uz6X:function(e,t,a){"use strict";var r=a("S1cf"),o=a("woEt"),s=a("V3+0"),l=a("BXyq"),i=a("7/2Y"),n=a("a2Uu");function c(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return c(e),e.baseURL&&!i(e.url)&&(e.url=n(e.baseURL,e.url)),e.headers=e.headers||{},e.data=o(e.data,e.headers,e.transformRequest),e.headers=r.merge(e.headers.common||{},e.headers[e.method]||{},e.headers||{}),r.forEach(["delete","get","head","post","put","patch","common"],function(t){delete e.headers[t]}),(e.adapter||l.adapter)(e).then(function(t){return c(e),t.data=o(t.data,t.headers,e.transformResponse),t},function(t){return s(t)||(c(e),t&&t.response&&(t.response.data=o(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)})}},"v/hR":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACwAAAAoCAMAAACyy+glAAAA81BMVEUAAACNpf+ky/+ZsuFFgPaasuJoiv9GgPZHgfZGgPWasuJGgPVKgvdMgf9FgPaZsuBGgPWZseFFgPZFgPaas+FHgPdGgfZHgPabs+JIgflGgf+gu+lQh/9FgPWasuBFgPZFgPZFgPWasuFFgPZGgPWas+FGgPaZsuFGgfaas+FGgfZGgPiatOGcteVIgvqduOVFgPWasuGasuGasuFGgPWasuFFgPaZsuJHgfZGgPeZseFGgfeasuKasuNHgfectuKbs+RIgfids+GZseGZsuCZseBFgPaaseFGgPaZseFFgPZGgPZGgPagtOeZs+ZFf/WZseByc+/7AAAAT3RSTlMABAH493gHUTS5k4IcEvvx6d7Wyn99dE5DKRYQDO7p5eDSsqagiGxrZ2ZURjswLxzxycCfmpmJcG9hX1xWST4rJSMh7NDOwLuuqpOPOhkKbHRT8QAAAbxJREFUOMut1Gl3wUAUxvEniQRB0VZROy0tSvd9Qfd17vf/NBUycZmp40V/L3P+52RyMzP4P0Yku9fOO6uk8VhFeHZWaLMlMbG+zR4+uPY3VBmhabsWkeX2F9uwrsUReayz0fx6D6dtKA8uTVOWDeZcTJ1izi5Jd2xmKT/eg8/JFAEUkjJ+NiFFhC8m26i4x9gmSQeQ2jKuGbIVVxgrPKrxpZA+vToxbkUGHttv6wjciMDGZTuWmi3/xx9IssvWrOpgou+WiY7fybqb/RJFqBiMqpszzTOybjFxH1LjHSgj358s4lBt13oslJ9qA/mSUG1BsU+bGFY0bQMaA8SrmjVsmdBJ1NQ5NCLQKm7MLbTTjDWzCeg5L/zlV8tPc5S/Pby0NRu87QCFJfEpa0tfQC7pGn+156xN9YBbi+ior28zrK0OgRZ5yjld22TtepydTVv9ITesrW3DOKFAffE7w2vsbCRg1olJH4CLsA0c9Xb5NXHJBx6zn/zm+PuPe+K7hx0IOdkWcSN2swXthwnpgscDzFTZBaSryw6/uLVnxyapNT+6lBCVMBh+s7mLu7OXNwB9fWJiJbnX9PE1fL8fY9HHKD9QSQAAAABJRU5ErkJggg=="},vOkX:function(e,t,a){"use strict";var r=a("woOf"),o=a.n(r),s={name:"ServerConfig",components:{wrapper:a("mxK3").a},data:function(){return{serverData:{level:5,application:"",server_name:"",set_name:"",set_area:"",set_group:""},checkedConfigId:"",configList:[],refFileList:null,nodeConfigList:null,nodeCheckList:[],configModal:{show:!1,isNew:!0,model:null},detailModal:{show:!1,title:"",model:null},refFileModal:{show:!1,model:{fileList:[]}},nodeRefFileListModal:{show:!1,model:null},pushResultModal:{show:!1,model:null}}},computed:{showOthers:function(){return 5===this.serverData.level},nodeCheckAll:{get:function(){return!(!this.nodeConfigList||!this.nodeConfigList.length)&&this.nodeCheckList.length===this.nodeConfigList.length},set:function(e){this.nodeCheckList=e?this.nodeConfigList.map(function(e){return e.id}):[]}}},watch:{checkedConfigId:function(){var e=this;this.$nextTick(function(){e.getRefFileList(),e.getNodeConfigList()})}},methods:{getConfigList:function(e){var t=this,a=this.$refs.configListLoading.$loading.show();this.$ajax.getJSON("/server/api/config_file_list",e).then(function(e){a.hide(),t.configList=e,t.refFileList=[],t.nodeConfigList=[],e[0]&&e[0].id&&(t.checkedConfigId=e[0].id)}).catch(function(e){a.hide(),t.$confirm(e.err_msg||e.message||t.$t("common.error"),t.$t("common.retry"),t.$t("common.alert")).then(function(){t.getConfigList()})})},addConfig:function(){this.configModal.model={filename:"",config:""},this.configModal.isNew=!0,this.configModal.show=!0},changeConfig:function(e,t){this.configModal.model=o()({reason:""},e),this.configModal.target=t,this.configModal.isNew=!1,this.configModal.show=!0},updateConfigFile:function(){var e=this;if(this.$refs.configForm.validate()){var t=this.$Loading.show(),a=this.configModal.model;if(this.configModal.isNew){var r=o()({application:this.serverData.application,level:this.serverData.level,server_name:this.serverData.server_name,set_name:this.serverData.set_name,set_area:this.serverData.set_area,set_group:this.serverData.set_group},a);this.$ajax.postJSON("/server/api/add_config_file",r).then(function(a){t.hide(),e.configList.unshift(a),1===e.configList.length&&(e.checkedConfigId=a.id),e.$tip.success(e.$t("common.success")),e.closeConfigModal()}).catch(function(){t.hide(),e.$tip.error(e.$t("common.error"))})}else this.$ajax.postJSON("/server/api/update_config_file",{config:a.config,id:a.id,reason:a.reason}).then(function(a){t.hide(),e[e.configModal.target]=e[e.configModal.target].map(function(e){return e.id===a.id?a:e}),e.checkedConfigId===a.id&&(e.getRefFileList(),e.getNodeConfigList()),e.$tip.success(e.$t("common.success")),e.closeConfigModal()}).catch(function(){t.hide(),e.$tip.error(e.$t("common.error"))})}},closeConfigModal:function(){this.$refs.configForm&&this.$refs.configForm.resetValid(),this.configModal.show=!1},deleteConfig:function(e){var t=this;this.$confirm(this.$t("cfg.msg.confirmCfg"),this.$t("common.alert")).then(function(){var a=t.$Loading.show();t.$ajax.getJSON("/server/api/delete_config_file",{id:e}).then(function(e){a.hide(),t.getConfigList(t.serverData),t.getNodeConfigList(),t.$tip.success(t.$t("common.success"))}).catch(function(e){a.hide(),t.$tip.error(t.$t("common.error")+": "+(e.err_msg||e.message))})})},getUnusedFileList:function(e){var t=this;this.showOthers&&this.$ajax.getJSON("/server/api/unused_config_file_list",{config_id:e,application:this.serverData.application}).then(function(e){t.refFileModal.model.fileList=e}).catch(function(e){t.refFileModal.model.fileList=[],t.$tip.error({title:t.$t("common.error"),message:e.err_msg||e.message||t.$t("common.networkErr")})})},getRefFileList:function(){var e=this;if(this.showOthers){var t=this.$refs.refFileListLoading.$loading.show();this.$ajax.getJSON("/server/api/config_ref_list",{config_id:this.checkedConfigId}).then(function(a){t.hide(),a.map(function(e){var t=e.id;return(e=o()(e,e.reference)).refrence_id=e.id,e.id=t,e}),e.refFileList=a}).catch(function(a){t.hide(),e.refFileList=[],e.$tip.error({title:e.$t("common.error"),message:a.err_msg||a.message||e.$t("common.networkErr")})})}},openRefFileModal:function(){this.refFileModal.show=!0,this.refFileModal.isNodeRef=!1,this.getUnusedFileList(this.checkedConfigId)},openNodeRefFileModal:function(){this.refFileModal.show=!0,this.refFileModal.isNodeRef=!0,this.getUnusedFileList(this.refFileModal.id)},addRefFile:function(){var e=this;if(this.$refs.refForm.validate()){var t=this.$Loading.show();this.$ajax.getJSON("/server/api/add_config_ref",{config_id:this.refFileModal.isNodeRef?this.refFileModal.id:this.checkedConfigId,reference_id:this.refFileModal.model.filename}).then(function(a){t.hide(),e.refFileModal.show=!1,e.refFileModal.isNodeRef?e.getNodeRefFileList(e.refFileModal.id):e.getRefFileList()})}},closeRefFileModal:function(){this.refFileModal.show=!1},deleteRef:function(e,t,a){var r=this;this.$confirm(this.$t("cfg.msg.confirm"),this.$t("common.alert")).then(function(){var o=r.$Loading.show();r.$ajax.getJSON("/server/api/delete_config_ref",{id:e}).then(function(e){o.hide(),"nodeRef"==t?r.getNodeRefFileList(a):r.getRefFileList(),r.$tip.success(r.$t("common.success"))})})},getNodeConfigList:function(){var e=this;if(this.showOthers){var t=this.$refs.nodeConfigListLoading.$loading.show(),a=o()({config_id:this.checkedConfigId},this.serverData);this.$ajax.getJSON("/server/api/node_config_file_list",a).then(function(a){t.hide(),e.nodeConfigList=a}).catch(function(a){t.hide(),e.nodeConfigList=[],e.$tip.error({title:e.$t("common.error"),message:a.err_msg||a.message||e.$t("common.networkErr")})})}},pushNodeConfig:function(){var e=this;if(this.nodeCheckList.length){var t=this.$Loading.show();this.$ajax.getJSON("/server/api/push_config_file",{ids:this.nodeCheckList.join(";")}).then(function(a){t.hide(),e.pushResultModal.model=a,e.pushResultModal.show=!0}).catch(function(a){t.hide(),e.$tip.error(e.$t("common.error")+": "+(a.err_msg||a.message))})}else this.$tip.warning(this.$t("cfg.msg.selectNode"))},closePushResultModal:function(){this.pushResultModal.model=null,this.pushResultModal.show=!1},showDetail:function(e){this.detailModal.title=this.$t("cfg.title.viewConf"),this.detailModal.model={detail:e.config},this.detailModal.show=!0},showMergedDetail:function(e){var t=this;this.detailModal.title=this.$t("cfg.title.viewMerged"),this.detailModal.show=!0;var a=this.$loading.show({target:this.$refs.detailModalLoading});this.$ajax.getJSON("/server/api/merged_node_config",{id:e}).then(function(e){a.hide(),t.detailModal.model={detail:e}}).catch(function(e){a.hide(),t.$tip.error(t.$t("common.error")+": "+(e.err_msg||e.message))})},showHistory:function(e){var t=this;this.detailModal.title=this.$t("cfg.title.viewHistory"),this.detailModal.show=!0;var a=this.$loading.show({target:this.$refs.detailModalLoading});this.$ajax.getJSON("/server/api/config_file_history_list",{config_id:e}).then(function(e){a.hide(),t.detailModal.model={table:e.rows,detail:""}}).catch(function(e){a.hide(),t.$tip.error(t.$t("common.error")+": "+(e.err_msg||e.message))})},showTableDeatil:function(e){this.detailModal.model.detail=e.content},closeDetailModal:function(){this.detailModal.show=!1,this.detailModal.model=null},getNodeRefFileList:function(e){var t=this;this.$ajax.getJSON("/server/api/config_ref_list",{config_id:e}).then(function(e){e.map(function(e){var t=e.id;return(e=o()(e,e.reference)).refrence_id=e.id,e.id=t,e}),t.nodeRefFileListModal.model={refFileList:e}}).catch(function(e){t.nodeRefFileListModal.model={refFileList:[]},t.$tip.error({title:t.$t("common.error"),message:e.err_msg||e.message||t.$t("common.networkErr")})})},handleRefFiles:function(e){this.nodeRefFileListModal.show=!0,this.nodeRefFileListModal.model=null,this.refFileModal.id=e,this.getNodeRefFileList(e)}},created:function(){this.serverData=this.$parent.getServerData()},mounted:function(){this.getConfigList(this.serverData)}},l={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page_server_config"},[e.configList?a("wrapper",{ref:"configListLoading"},[a("let-button",{staticClass:"add-btn",attrs:{size:"small",theme:"primary"},on:{click:e.addConfig}},[e._v(e._s(e.$t("cfg.btn.add")))]),e._v(" "),a("let-table",{attrs:{data:e.configList,title:e.$t("cfg.title.a"),"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{width:"40px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-radio",{attrs:{label:t.row.id},model:{value:e.checkedConfigId,callback:function(t){e.checkedConfigId=t},expression:"checkedConfigId"}},[e._v(" ")])]}}],null,!1,4136274637)}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.service"),prop:"server_name"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("cfg.btn.fileName"),prop:"filename"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("cfg.btn.lastUpdate"),prop:"posttime"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("operate.operates"),width:"260px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-table-operation",{on:{click:function(a){return e.changeConfig(t.row,"configList")}}},[e._v(e._s(e.$t("operate.update")))]),e._v(" "),a("let-table-operation",{on:{click:function(a){return e.deleteConfig(t.row.id)}}},[e._v(e._s(e.$t("operate.delete")))]),e._v(" "),a("let-table-operation",{on:{click:function(a){return e.showDetail(t.row)}}},[e._v(e._s(e.$t("cfg.title.viewConf")))]),e._v(" "),a("let-table-operation",{on:{click:function(a){return e.showHistory(t.row.id)}}},[e._v(e._s(e.$t("pub.btn.history")))])]}}],null,!1,1106028486)})],1)],1):e._e(),e._v(" "),e.refFileList&&e.showOthers?a("wrapper",{ref:"refFileListLoading"},[a("let-button",{staticClass:"add-btn",attrs:{size:"small",theme:"primary"},on:{click:e.openRefFileModal}},[e._v(e._s(e.$t("cfg.btn.addRef")))]),e._v(" "),a("let-table",{attrs:{data:e.refFileList,title:e.$t("cfg.title.b"),"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{title:e.$t("serverList.table.th.service"),prop:"server_name"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("cfg.btn.fileName"),prop:"filename"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.ip"),prop:"node_name"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("cfg.btn.lastUpdate"),prop:"posttime"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("operate.operates"),width:"260px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-table-operation",{on:{click:function(a){return e.deleteRef(t.row.id)}}},[e._v(e._s(e.$t("operate.delete")))]),e._v(" "),a("let-table-operation",{on:{click:function(a){return e.showDetail(t.row)}}},[e._v(e._s(e.$t("operate.view")))]),e._v(" "),a("let-table-operation",{on:{click:function(a){return e.showHistory(t.row.id)}}},[e._v(e._s(e.$t("pub.btn.history")))])]}}],null,!1,3781508116)})],1)],1):e._e(),e._v(" "),e.nodeConfigList&&e.showOthers?a("wrapper",{ref:"nodeConfigListLoading"},[a("let-button",{staticClass:"add-btn",attrs:{size:"small",theme:"primary"},on:{click:e.pushNodeConfig}},[e._v(e._s(e.$t("cfg.btn.pushFile")))]),e._v(" "),e.nodeConfigList.length?a("let-checkbox",{staticClass:"check-all",model:{value:e.nodeCheckAll,callback:function(t){e.nodeCheckAll=t},expression:"nodeCheckAll"}}):e._e(),e._v(" "),a("let-table",{attrs:{data:e.nodeConfigList,title:e.$t("cfg.title.c"),"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{width:"40px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-checkbox",{attrs:{label:t.row.id},model:{value:e.nodeCheckList,callback:function(t){e.nodeCheckList=t},expression:"nodeCheckList"}})]}}],null,!1,3731714217)}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.service"),prop:"server_name"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.ip"),prop:"node_name"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("cfg.btn.fileName"),prop:"filename"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("cfg.btn.lastUpdate"),prop:"posttime"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("operate.operates"),width:"400px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-table-operation",{on:{click:function(a){return e.changeConfig(t.row,"nodeConfigList")}}},[e._v(e._s(e.$t("cfg.table.modCfg")))]),e._v(" "),a("let-table-operation",{on:{click:function(a){return e.showMergedDetail(t.row.id)}}},[e._v(e._s(e.$t("cfg.table.viewMerge")))]),e._v(" "),a("let-table-operation",{on:{click:function(a){return e.showDetail(t.row)}}},[e._v(e._s(e.$t("cfg.table.viewIpContent")))]),e._v(" "),a("let-table-operation",{on:{click:function(a){return e.showHistory(t.row.id)}}},[e._v(e._s(e.$t("pub.btn.history")))]),e._v(" "),a("let-table-operation",{on:{click:function(a){return e.handleRefFiles(t.row.id)}}},[e._v(e._s(e.$t("cfg.table.mangeRefFile")))])]}}],null,!1,3455703896)})],1)],1):e._e(),e._v(" "),a("let-modal",{attrs:{title:e.configModal.isNew?e.$t("operate.title.add")+" "+e.$t("common.config"):e.$t("operate.title.update")+" "+e.$t("common.config"),width:"700px"},on:{"on-confirm":e.updateConfigFile,close:e.closeConfigModal,"on-cancel":e.closeConfigModal},model:{value:e.configModal.show,callback:function(t){e.$set(e.configModal,"show",t)},expression:"configModal.show"}},[e.configModal.model?a("let-form",{ref:"configForm",attrs:{itemWidth:"100%"}},[a("let-form-item",{attrs:{label:e.$t("cfg.btn.fileName"),required:""}},[a("let-input",{attrs:{size:"small",disabled:!e.configModal.isNew,required:""},model:{value:e.configModal.model.filename,callback:function(t){e.$set(e.configModal.model,"filename",t)},expression:"configModal.model.filename"}})],1),e._v(" "),e.configModal.isNew?e._e():a("let-form-item",{attrs:{label:e.$t("cfg.btn.reason"),required:""}},[a("let-input",{attrs:{size:"small",required:""},model:{value:e.configModal.model.reason,callback:function(t){e.$set(e.configModal.model,"reason",t)},expression:"configModal.model.reason"}})],1),e._v(" "),a("let-form-item",{attrs:{label:e.$t("cfg.btn.content"),required:""}},[a("let-input",{attrs:{size:"large",type:"textarea",rows:4,required:""},model:{value:e.configModal.model.config,callback:function(t){e.$set(e.configModal.model,"config",t)},expression:"configModal.model.config"}})],1)],1):e._e()],1),e._v(" "),a("let-modal",{attrs:{title:e.detailModal.title,width:"700px",footShow:!1},on:{close:e.closeDetailModal},model:{value:e.detailModal.show,callback:function(t){e.$set(e.detailModal,"show",t)},expression:"detailModal.show"}},[e.detailModal.model&&e.detailModal.model.table?a("let-table",{staticClass:"history-table",attrs:{data:e.detailModal.model.table,"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{title:e.$t("common.time"),prop:"posttime"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("cfg.btn.reason"),prop:"reason"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("cfg.btn.content"),width:"90px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-table-operation",{on:{click:function(a){return e.showTableDeatil(t.row)}}},[e._v(e._s(e.$t("operate.view")))])]}}],null,!1,3538701521)})],1):e._e(),e._v(" "),e.detailModal.model&&!e.detailModal.model.table||e.detailModal.model&&e.detailModal.model.table&&e.detailModal.model.detail?a("pre",[e._v(e._s(e.detailModal.model.detail||e.$t("cfg.msg.empty")))]):e._e(),e._v(" "),a("div",{ref:"detailModalLoading",staticClass:"detail-loading"})],1),e._v(" "),e.refFileModal.model?a("let-modal",{attrs:{title:this.$t("operate.title.add"),width:"700px"},on:{"on-confirm":e.addRefFile,close:e.closeRefFileModal},model:{value:e.refFileModal.show,callback:function(t){e.$set(e.refFileModal,"show",t)},expression:"refFileModal.show"}},[a("let-form",{ref:"refForm",attrs:{itemWidth:"100%"}},[a("let-form-item",{attrs:{label:e.$t("cfg.msg.refFile"),required:""}},[a("let-select",{attrs:{size:"small",placeholder:e.$t("pub.dlg.defaultValue"),required:""},model:{value:e.refFileModal.model.filename,callback:function(t){e.$set(e.refFileModal.model,"filename",t)},expression:"refFileModal.model.filename"}},e._l(e.refFileModal.model.fileList,function(t){return a("let-option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.filename))])}),1)],1)],1)],1):e._e(),e._v(" "),a("let-modal",{attrs:{title:e.$t("cfg.table.mangeRefFile"),width:"700px",footShow:!1},on:{close:e.closeDetailModal},model:{value:e.nodeRefFileListModal.show,callback:function(t){e.$set(e.nodeRefFileListModal,"show",t)},expression:"nodeRefFileListModal.show"}},[e.nodeRefFileListModal.model?a("wrapper",[a("let-button",{staticClass:"add-btn",attrs:{size:"small",theme:"primary"},on:{click:e.openNodeRefFileModal}},[e._v(e._s(e.$t("cfg.btn.addRef")))]),e._v(" "),a("let-table",{attrs:{data:e.nodeRefFileListModal.model.refFileList,title:e.$t("cfg.title.b"),"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{title:e.$t("serverList.table.th.service"),prop:"server_name"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("cfg.btn.fileName"),prop:"filename"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.ip"),prop:"node_name"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("cfg.btn.lastUpdate"),prop:"posttime"}}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("operate.operates"),width:"260px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("let-table-operation",{on:{click:function(a){return e.deleteRef(t.row.id,"nodeRef",t.row.config_id)}}},[e._v(e._s(e.$t("operate.delete")))]),e._v(" "),a("let-table-operation",{on:{click:function(a){return e.showDetail(t.row)}}},[e._v(e._s(e.$t("operate.view")))]),e._v(" "),a("let-table-operation",{on:{click:function(a){return e.showHistory(t.row.config_id)}}},[e._v(e._s(e.$t("pub.btn.history")))])]}}],null,!1,786478024)})],1)],1):e._e()],1),e._v(" "),a("let-modal",{attrs:{width:"700px",footShow:!1},on:{close:e.closePushResultModal},model:{value:e.pushResultModal.show,callback:function(t){e.$set(e.pushResultModal,"show",t)},expression:"pushResultModal.show"}},[e.pushResultModal.model?a("let-table",{attrs:{data:e.pushResultModal.model,title:e.$t("serverList.table.th.result"),"empty-msg":e.$t("common.nodata")}},[a("let-table-column",{attrs:{title:e.$t("serverList.table.th.service")},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{class:0!==t.row.ret_code?"danger":"success"},[e._v(e._s(t.row.server_name))])]}}],null,!1,1546843640)}),e._v(" "),a("let-table-column",{attrs:{title:e.$t("serverList.table.th.result")},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticClass:"result",class:0!==t.row.ret_code?"danger":"success"},[e._v(e._s(t.row.err_msg))])]}}],null,!1,3216099087)})],1):e._e()],1)],1)},staticRenderFns:[]};var i=a("VU/8")(s,l,!1,function(e){a("21mA")},null,null);t.a=i.exports},woEt:function(e,t,a){"use strict";var r=a("S1cf");e.exports=function(e,t,a){return r.forEach(a,function(a){e=a(e,t)}),e}}},["DQfC"]);